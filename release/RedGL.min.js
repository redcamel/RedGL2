var RedDefinePropertyInfo,RedGLDetect,RedGLUtil,RedGL,RedBaseController,RedBaseTexture,RedBaseObject3D,RedBaseContainer,RedBaseLight,RedFrameBuffer,RedBuffer,RedGeometry,RedInterleaveInfo,RedBaseMaterial,RedTextureOptionChecker,RedBitmapTexture,RedVideoTexture,RedDDSTexture,RedBitmapCubeTexture,RedColorMaterial,RedColorPhongMaterial,RedColorPhongTextureMaterial,RedEnvironmentMaterial,RedBitmapMaterial,RedParticleColorMaterial,RedParticleBitmapMaterial,RedPointColorMaterial,RedPointBitmapMaterial,RedSheetMaterial,RedStandardMaterial,RedVideoMaterial,RedAmbientLight,RedDirectionalLight,RedPointLight,JsonModelLoader,RedMTLLoader,RedOBJLoader,RedAxis,RedGrid,RedMesh,RedLine,RedSkyBox,RedSprite3D,RedPointUnit,RedParticleUnit,RedParticleEmitter,RedBox,RedPlane,RedSphere,RedProgram,RedSystemShaderCode,RedShader,RedRenderer,RedRenderDebuger,RedSystemUniformUpdater,RedView,RedWorld,RedScene,RedCamera,RedBasicController,RedObitController,RedGridMaterial,RedSkyBoxMaterial,RedDirectionalShadowMaterial,RedPostEffectMaterial,RedDirectionalShadow,RedShadowManager,RedText,RedPostEffectManager,RedBasePostEffect,RedPostEffect_Bloom,RedPostEffect_BloomThreshold,RedPostEffect_Blur,RedPostEffect_BlurX,RedPostEffect_BlurY,RedPostEffect_GaussianBlur,RedPostEffect_ZoomBlur,RedPostEffect_BrightnessContrast,RedPostEffect_Threshold,RedPostEffect_Invert,RedPostEffect_Gray,RedPostEffect_HueSaturation,RedPostEffect_HalfTone,RedPostEffect_Pixelize,RedPostEffect_Convolution,RedPostEffect_DoF,RedPostEffect_DoF_DepthMaterial,RedPostEffect_Film,RedPostEffect_Vignetting,RedPostEffect_FXAA;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var i in r)("object"==typeof exports?exports:e)[i]=r[i]}}(this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*n},t.equals=function(e,t){return Math.abs(e-t)<=i*Math.max(1,Math.abs(e),Math.abs(t))};var i=t.EPSILON=1e-6,n=(t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){"use strict";function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=r[0],h=r[1],R=r[2],m=r[3],p=r[4],_=r[5],P=r[6],g=r[7],E=r[8];return e[0]=l*i+h*o+R*f,e[1]=l*n+h*s+R*c,e[2]=l*a+h*d+R*u,e[3]=m*i+p*o+_*f,e[4]=m*n+p*s+_*c,e[5]=m*a+p*d+_*u,e[6]=P*i+g*o+E*f,e[7]=P*n+g*s+E*c,e[8]=P*a+g*d+E*u,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new a.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,i,n,o,s,d,f){var c=new a.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=i,c[4]=n,c[5]=o,c[6]=s,c[7]=d,c[8]=f,c},t.set=function(e,t,r,i,n,a,o,s,d,f){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=c*o-s*f,l=-c*a+s*d,h=f*a-o*d,R=r*u+i*l+n*h;return R?(R=1/R,e[0]=u*R,e[1]=(-c*i+n*f)*R,e[2]=(s*i-n*o)*R,e[3]=l*R,e[4]=(c*r-n*d)*R,e[5]=(-s*r+n*a)*R,e[6]=h*R,e[7]=(-f*r+i*d)*R,e[8]=(o*r-i*a)*R,e):null},t.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8];return e[0]=o*c-s*f,e[1]=n*f-i*c,e[2]=i*s-n*o,e[3]=s*d-a*c,e[4]=r*c-n*d,e[5]=n*a-r*s,e[6]=a*f-o*d,e[7]=i*d-r*f,e[8]=r*o-i*a,e},t.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8];return t*(f*a-o*d)+r*(-f*n+o*s)+i*(d*n-a*s)},t.multiply=i,t.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=r[0],h=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=s,e[5]=d,e[6]=l*i+h*o+f,e[7]=l*n+h*s+c,e[8]=l*a+h*d+u,e},t.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=Math.sin(r),h=Math.cos(r);return e[0]=h*i+l*o,e[1]=h*n+l*s,e[2]=h*a+l*d,e[3]=h*o-l*i,e[4]=h*s-l*n,e[5]=h*d-l*a,e[6]=f,e[7]=c,e[8]=u,e},t.scale=function(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,d=n+n,f=r*o,c=i*o,u=i*s,l=n*o,h=n*s,R=n*d,m=a*o,p=a*s,_=a*d;return e[0]=1-u-R,e[3]=c-_,e[6]=l+p,e[1]=c+_,e[4]=1-f-R,e[7]=h-m,e[2]=l-p,e[5]=h+m,e[8]=1-f-u,e},t.normalFromMat4=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15],P=r*s-i*o,g=r*d-n*o,E=r*f-a*o,y=i*d-n*s,M=i*f-a*s,T=n*f-a*d,b=c*m-u*R,v=c*p-l*R,L=c*_-h*R,x=u*p-l*m,w=u*_-h*m,U=l*_-h*p,D=P*U-g*w+E*x+y*L-M*v+T*b;return D?(D=1/D,e[0]=(s*U-d*w+f*x)*D,e[1]=(d*L-o*U-f*v)*D,e[2]=(o*w-s*L+f*b)*D,e[3]=(n*w-i*U-a*x)*D,e[4]=(r*U-n*L+a*v)*D,e[5]=(i*L-r*w-a*b)*D,e[6]=(m*T-p*M+_*y)*D,e[7]=(p*E-R*T-_*g)*D,e[8]=(R*M-m*E+_*P)*D,e):null},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=n,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],l=t[0],h=t[1],R=t[2],m=t[3],p=t[4],_=t[5],P=t[6],g=t[7],E=t[8];return Math.abs(r-l)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-h)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-R)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(R))&&Math.abs(o-m)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-p)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(d-_)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(f-P)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(c-g)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-E)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=i,t.sub=n},function(e,t,r){"use strict";function i(){var e=new R.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function n(e){var t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)}function a(e,t,r){var i=new R.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=r,i}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function s(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function d(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function f(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)}function c(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function u(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function l(e,t){var r=t[0],i=t[1],n=t[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function h(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=i,t.clone=function(e){var t=new R.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=n,t.fromValues=a,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=o,t.multiply=s,t.divide=d,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e},t.distance=f,t.squaredDistance=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=l,t.dot=h,t.cross=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],d=r[2];return e[0]=n*d-a*s,e[1]=a*o-i*d,e[2]=i*s-n*o,e},t.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e},t.hermite=function(e,t,r,i,n,a){var o=a*a,s=o*(2*a-3)+1,d=o*(a-2)+a,f=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+r[0]*d+i[0]*f+n[0]*c,e[1]=t[1]*s+r[1]*d+i[1]*f+n[1]*c,e[2]=t[2]*s+r[2]*d+i[2]*f+n[2]*c,e},t.bezier=function(e,t,r,i,n,a){var o=1-a,s=o*o,d=a*a,f=s*o,c=3*a*s,u=3*d*o,l=d*a;return e[0]=t[0]*f+r[0]*c+i[0]*u+n[0]*l,e[1]=t[1]*f+r[1]*c+i[1]*u+n[1]*l,e[2]=t[2]*f+r[2]*c+i[2]*u+n[2]*l,e},t.random=function(e,t){t=t||1;var r=2*R.RANDOM()*Math.PI,i=2*R.RANDOM()-1,n=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=i*t,e},t.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[3]*i+r[7]*n+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o,e[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o,e[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var i=t[0],n=t[1],a=t[2];return e[0]=i*r[0]+n*r[3]+a*r[6],e[1]=i*r[1]+n*r[4]+a*r[7],e[2]=i*r[2]+n*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*i+s*a-d*n,u=f*n+d*i-o*a,l=f*a+o*n-s*i,h=-o*i-s*n-d*a;return e[0]=c*f+h*-o+u*-d-l*-s,e[1]=u*f+h*-s+l*-o-c*-d,e[2]=l*f+h*-d+c*-s-u*-o,e},t.rotateX=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,i){var n=[],a=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=a(e[0],e[1],e[2]),i=a(t[0],t[1],t[2]);l(r,r),l(i,i);var n=h(r,i);return n>1?0:n<-1?Math.PI:Math.acos(n)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-s)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))};var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=o,t.mul=s,t.div=d,t.dist=f,t.sqrDist=c,t.len=n,t.sqrLen=u,t.forEach=function(){var e=i();return function(t,r,i,n,a,o){var s,d=void 0;for(r||(r=3),i||(i=0),s=n?Math.min(n*r+i,t.length):t.length,d=i;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2];return t}}()},function(e,t,r){"use strict";function i(){var e=new h.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function s(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function d(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)}function f(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a}function c(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)}function u(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function l(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=a*o),e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=i,t.clone=function(e){var t=new h.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,i){var n=new h.ARRAY_TYPE(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=n,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=s,t.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},t.distance=d,t.squaredDistance=f,t.length=c,t.squaredLength=u,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=l,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=o+i*(r[2]-o),e[3]=s+i*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=h.RANDOM(),e[1]=h.RANDOM(),e[2]=h.RANDOM(),e[3]=h.RANDOM(),l(e,e),s(e,e,t),e},t.transformMat4=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=r[0],s=r[1],d=r[2],f=r[3],c=f*i+s*a-d*n,u=f*n+d*i-o*a,l=f*a+o*n-s*i,h=-o*i-s*n-d*a;return e[0]=c*f+h*-o+u*-d-l*-s,e[1]=u*f+h*-s+l*-o-c*-d,e[2]=l*f+h*-d+c*-s-u*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=t[0],s=t[1],d=t[2],f=t[3];return Math.abs(r-o)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=h.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-d)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-f)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.sub=n,t.mul=a,t.div=o,t.dist=d,t.sqrDist=f,t.len=c,t.sqrLen=u,t.forEach=function(){var e=i();return function(t,r,i,n,a,o){var s,d=void 0;for(r||(r=4),i||(i=0),s=n?Math.min(n*r+i,t.length):t.length,d=i;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],e[3]=t[d+3],a(e,e,o),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2],t[d+3]=e[3];return t}}()},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var n=i(r(0)),a=i(r(5)),o=i(r(6)),s=i(r(1)),d=i(r(7)),f=i(r(8)),c=i(r(9)),u=i(r(2)),l=i(r(3));t.glMatrix=n,t.mat2=a,t.mat2d=o,t.mat3=s,t.mat4=d,t.quat=f,t.vec2=c,t.vec3=u,t.vec4=l},function(e,t,r){"use strict";function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=i*s+a*d,e[1]=n*s+o*d,e[2]=i*f+a*c,e[3]=n*f+o*c,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,r,i){var n=new a.ARRAY_TYPE(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n},t.set=function(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e},t.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*a-n*i;return o?(o=1/o,e[0]=a*o,e[1]=-i*o,e[2]=-n*o,e[3]=r*o,e):null},t.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=i,t.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=i*d+a*s,e[1]=n*d+o*s,e[2]=i*-s+a*d,e[3]=n*-s+o*d,e},t.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],d=r[1];return e[0]=i*s,e[1]=n*s,e[2]=a*d,e[3]=o*d,e},t.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=n,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],o=e[3],s=t[0],d=t[1],f=t[2],c=t[3];return Math.abs(r-s)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-d)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(n-f)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-c)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},t.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=i,t.sub=n},function(e,t,r){"use strict";function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1],u=r[2],l=r[3],h=r[4],R=r[5];return e[0]=i*f+a*c,e[1]=n*f+o*c,e[2]=i*u+a*l,e[3]=n*u+o*l,e[4]=i*h+a*R+s,e[5]=n*h+o*R+d,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.clone=function(e){var t=new a.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,r,i,n,o){var s=new a.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=i,s[4]=n,s[5]=o,s},t.set=function(e,t,r,i,n,a,o){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e},t.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=r*a-i*n;return d?(d=1/d,e[0]=a*d,e[1]=-i*d,e[2]=-n*d,e[3]=r*d,e[4]=(n*s-a*o)*d,e[5]=(i*o-r*s)*d,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=i,t.rotate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=Math.sin(r),c=Math.cos(r);return e[0]=i*c+a*f,e[1]=n*c+o*f,e[2]=i*-f+a*c,e[3]=n*-f+o*c,e[4]=s,e[5]=d,e},t.scale=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=i*f,e[1]=n*f,e[2]=a*c,e[3]=o*c,e[4]=s,e[5]=d,e},t.translate=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=r[0],c=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=o,e[4]=i*f+a*c+s,e[5]=n*f+o*c+d,e},t.fromRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},t.subtract=n,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},t.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],d=e[5],f=t[0],c=t[1],u=t[2],l=t[3],h=t[4],R=t[5];return Math.abs(r-f)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-c)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-u)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-l)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-h)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(d-R)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=i,t.sub=n},function(e,t,r){"use strict";function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],d=t[5],f=t[6],c=t[7],u=t[8],l=t[9],h=t[10],R=t[11],m=t[12],p=t[13],_=t[14],P=t[15],g=r[0],E=r[1],y=r[2],M=r[3];return e[0]=g*i+E*s+y*u+M*m,e[1]=g*n+E*d+y*l+M*p,e[2]=g*a+E*f+y*h+M*_,e[3]=g*o+E*c+y*R+M*P,g=r[4],E=r[5],y=r[6],M=r[7],e[4]=g*i+E*s+y*u+M*m,e[5]=g*n+E*d+y*l+M*p,e[6]=g*a+E*f+y*h+M*_,e[7]=g*o+E*c+y*R+M*P,g=r[8],E=r[9],y=r[10],M=r[11],e[8]=g*i+E*s+y*u+M*m,e[9]=g*n+E*d+y*l+M*p,e[10]=g*a+E*f+y*h+M*_,e[11]=g*o+E*c+y*R+M*P,g=r[12],E=r[13],y=r[14],M=r[15],e[12]=g*i+E*s+y*u+M*m,e[13]=g*n+E*d+y*l+M*p,e[14]=g*a+E*f+y*h+M*_,e[15]=g*o+E*c+y*R+M*P,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new a.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new a.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,i,n,o,s,d,f,c,u,l,h,R,m,p){var _=new a.ARRAY_TYPE(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=i,_[4]=n,_[5]=o,_[6]=s,_[7]=d,_[8]=f,_[9]=c,_[10]=u,_[11]=l,_[12]=h,_[13]=R,_[14]=m,_[15]=p,_},t.set=function(e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=o,e[6]=s,e[7]=d,e[8]=f,e[9]=c,e[10]=u,e[11]=l,e[12]=h,e[13]=R,e[14]=m,e[15]=p,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=a,e[11]=t[14],e[12]=n,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15],P=r*s-i*o,g=r*d-n*o,E=r*f-a*o,y=i*d-n*s,M=i*f-a*s,T=n*f-a*d,b=c*m-u*R,v=c*p-l*R,L=c*_-h*R,x=u*p-l*m,w=u*_-h*m,U=l*_-h*p,D=P*U-g*w+E*x+y*L-M*v+T*b;return D?(D=1/D,e[0]=(s*U-d*w+f*x)*D,e[1]=(n*w-i*U-a*x)*D,e[2]=(m*T-p*M+_*y)*D,e[3]=(l*M-u*T-h*y)*D,e[4]=(d*L-o*U-f*v)*D,e[5]=(r*U-n*L+a*v)*D,e[6]=(p*E-R*T-_*g)*D,e[7]=(c*T-l*E+h*g)*D,e[8]=(o*w-s*L+f*b)*D,e[9]=(i*L-r*w-a*b)*D,e[10]=(R*M-m*E+_*P)*D,e[11]=(u*E-c*M-h*P)*D,e[12]=(s*v-o*x-d*b)*D,e[13]=(r*x-i*v+n*b)*D,e[14]=(m*g-R*y-p*P)*D,e[15]=(c*y-u*g+l*P)*D,e):null},t.adjoint=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],d=t[6],f=t[7],c=t[8],u=t[9],l=t[10],h=t[11],R=t[12],m=t[13],p=t[14],_=t[15];return e[0]=s*(l*_-h*p)-u*(d*_-f*p)+m*(d*h-f*l),e[1]=-(i*(l*_-h*p)-u*(n*_-a*p)+m*(n*h-a*l)),e[2]=i*(d*_-f*p)-s*(n*_-a*p)+m*(n*f-a*d),e[3]=-(i*(d*h-f*l)-s*(n*h-a*l)+u*(n*f-a*d)),e[4]=-(o*(l*_-h*p)-c*(d*_-f*p)+R*(d*h-f*l)),e[5]=r*(l*_-h*p)-c*(n*_-a*p)+R*(n*h-a*l),e[6]=-(r*(d*_-f*p)-o*(n*_-a*p)+R*(n*f-a*d)),e[7]=r*(d*h-f*l)-o*(n*h-a*l)+c*(n*f-a*d),e[8]=o*(u*_-h*m)-c*(s*_-f*m)+R*(s*h-f*u),e[9]=-(r*(u*_-h*m)-c*(i*_-a*m)+R*(i*h-a*u)),e[10]=r*(s*_-f*m)-o*(i*_-a*m)+R*(i*f-a*s),e[11]=-(r*(s*h-f*u)-o*(i*h-a*u)+c*(i*f-a*s)),e[12]=-(o*(u*p-l*m)-c*(s*p-d*m)+R*(s*l-d*u)),e[13]=r*(u*p-l*m)-c*(i*p-n*m)+R*(i*l-n*u),e[14]=-(r*(s*p-d*m)-o*(i*p-n*m)+R*(i*d-n*s)),e[15]=r*(s*l-d*u)-o*(i*l-n*u)+c*(i*d-n*s),e},t.determinant=function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],d=e[7],f=e[8],c=e[9],u=e[10],l=e[11],h=e[12],R=e[13],m=e[14],p=e[15];return(t*o-r*a)*(u*p-l*m)-(t*s-i*a)*(c*p-l*R)+(t*d-n*a)*(c*m-u*R)+(r*s-i*o)*(f*p-l*h)-(r*d-n*o)*(f*m-u*h)+(i*d-n*s)*(f*R-c*h)},t.multiply=i,t.translate=function(e,t,r){var i=r[0],n=r[1],a=r[2],o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=void 0,p=void 0,_=void 0;return t===e?(e[12]=t[0]*i+t[4]*n+t[8]*a+t[12],e[13]=t[1]*i+t[5]*n+t[9]*a+t[13],e[14]=t[2]*i+t[6]*n+t[10]*a+t[14],e[15]=t[3]*i+t[7]*n+t[11]*a+t[15]):(o=t[0],s=t[1],d=t[2],f=t[3],c=t[4],u=t[5],l=t[6],h=t[7],R=t[8],m=t[9],p=t[10],_=t[11],e[0]=o,e[1]=s,e[2]=d,e[3]=f,e[4]=c,e[5]=u,e[6]=l,e[7]=h,e[8]=R,e[9]=m,e[10]=p,e[11]=_,e[12]=o*i+c*n+R*a+t[12],e[13]=s*i+u*n+m*a+t[13],e[14]=d*i+l*n+p*a+t[14],e[15]=f*i+h*n+_*a+t[15]),e},t.scale=function(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,i){var n=i[0],o=i[1],s=i[2],d=Math.sqrt(n*n+o*o+s*s),f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=void 0,p=void 0,_=void 0,P=void 0,g=void 0,E=void 0,y=void 0,M=void 0,T=void 0,b=void 0,v=void 0,L=void 0,x=void 0,w=void 0,U=void 0,D=void 0,I=void 0,B=void 0;return Math.abs(d)<a.EPSILON?null:(n*=d=1/d,o*=d,s*=d,f=Math.sin(r),u=1-(c=Math.cos(r)),l=t[0],h=t[1],R=t[2],m=t[3],p=t[4],_=t[5],P=t[6],g=t[7],E=t[8],y=t[9],M=t[10],T=t[11],b=n*n*u+c,v=o*n*u+s*f,L=s*n*u-o*f,x=n*o*u-s*f,w=o*o*u+c,U=s*o*u+n*f,D=n*s*u+o*f,I=o*s*u-n*f,B=s*s*u+c,e[0]=l*b+p*v+E*L,e[1]=h*b+_*v+y*L,e[2]=R*b+P*v+M*L,e[3]=m*b+g*v+T*L,e[4]=l*x+p*w+E*U,e[5]=h*x+_*w+y*U,e[6]=R*x+P*w+M*U,e[7]=m*x+g*w+T*U,e[8]=l*D+p*I+E*B,e[9]=h*D+_*I+y*B,e[10]=R*D+P*I+M*B,e[11]=m*D+g*I+T*B,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[4],o=t[5],s=t[6],d=t[7],f=t[8],c=t[9],u=t[10],l=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*n+f*i,e[5]=o*n+c*i,e[6]=s*n+u*i,e[7]=d*n+l*i,e[8]=f*n-a*i,e[9]=c*n-o*i,e[10]=u*n-s*i,e[11]=l*n-d*i,e},t.rotateY=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[8],c=t[9],u=t[10],l=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n-f*i,e[1]=o*n-c*i,e[2]=s*n-u*i,e[3]=d*n-l*i,e[8]=a*i+f*n,e[9]=o*i+c*n,e[10]=s*i+u*n,e[11]=d*i+l*n,e},t.rotateZ=function(e,t,r){var i=Math.sin(r),n=Math.cos(r),a=t[0],o=t[1],s=t[2],d=t[3],f=t[4],c=t[5],u=t[6],l=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*n+f*i,e[1]=o*n+c*i,e[2]=s*n+u*i,e[3]=d*n+l*i,e[4]=f*n-a*i,e[5]=c*n-o*i,e[6]=u*n-s*i,e[7]=l*n-d*i,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var i=r[0],n=r[1],o=r[2],s=Math.sqrt(i*i+n*n+o*o),d=void 0,f=void 0,c=void 0;return Math.abs(s)<a.EPSILON?null:(i*=s=1/s,n*=s,o*=s,d=Math.sin(t),c=1-(f=Math.cos(t)),e[0]=i*i*c+f,e[1]=n*i*c+o*d,e[2]=o*i*c-n*d,e[3]=0,e[4]=i*n*c-o*d,e[5]=n*n*c+f,e[6]=o*n*c+i*d,e[7]=0,e[8]=i*o*c+n*d,e[9]=n*o*c-i*d,e[10]=o*o*c+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=i+i,d=n+n,f=a+a,c=i*s,u=i*d,l=i*f,h=n*d,R=n*f,m=a*f,p=o*s,_=o*d,P=o*f;return e[0]=1-(h+m),e[1]=u+P,e[2]=l-_,e[3]=0,e[4]=u-P,e[5]=1-(c+m),e[6]=R+p,e[7]=0,e[8]=l+_,e[9]=R-p,e[10]=1-(c+h),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[4],o=t[5],s=t[6],d=t[8],f=t[9],c=t[10];return e[0]=Math.sqrt(r*r+i*i+n*n),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(d*d+f*f+c*c),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],i=0;return r>0?(i=2*Math.sqrt(r+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e},t.fromRotationTranslationScale=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3],d=n+n,f=a+a,c=o+o,u=n*d,l=n*f,h=n*c,R=a*f,m=a*c,p=o*c,_=s*d,P=s*f,g=s*c,E=i[0],y=i[1],M=i[2];return e[0]=(1-(R+p))*E,e[1]=(l+g)*E,e[2]=(h-P)*E,e[3]=0,e[4]=(l-g)*y,e[5]=(1-(u+p))*y,e[6]=(m+_)*y,e[7]=0,e[8]=(h+P)*M,e[9]=(m-_)*M,e[10]=(1-(u+R))*M,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,i,n){var a=t[0],o=t[1],s=t[2],d=t[3],f=a+a,c=o+o,u=s+s,l=a*f,h=a*c,R=a*u,m=o*c,p=o*u,_=s*u,P=d*f,g=d*c,E=d*u,y=i[0],M=i[1],T=i[2],b=n[0],v=n[1],L=n[2];return e[0]=(1-(m+_))*y,e[1]=(h+E)*y,e[2]=(R-g)*y,e[3]=0,e[4]=(h-E)*M,e[5]=(1-(l+_))*M,e[6]=(p+P)*M,e[7]=0,e[8]=(R+g)*T,e[9]=(p-P)*T,e[10]=(1-(l+m))*T,e[11]=0,e[12]=r[0]+b-(e[0]*b+e[4]*v+e[8]*L),e[13]=r[1]+v-(e[1]*b+e[5]*v+e[9]*L),e[14]=r[2]+L-(e[2]*b+e[6]*v+e[10]*L),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r+r,s=i+i,d=n+n,f=r*o,c=i*o,u=i*s,l=n*o,h=n*s,R=n*d,m=a*o,p=a*s,_=a*d;return e[0]=1-u-R,e[1]=c+_,e[2]=l-p,e[3]=0,e[4]=c-_,e[5]=1-f-R,e[6]=h+m,e[7]=0,e[8]=l+p,e[9]=h-m,e[10]=1-f-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,i,n,a,o){var s=1/(r-t),d=1/(n-i),f=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*d,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(n+i)*d,e[10]=(o+a)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*f,e[15]=0,e},t.perspective=function(e,t,r,i,n){var a=1/Math.tan(t/2),o=1/(i-n);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+i)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*i*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),d=2/(o+s),f=2/(n+a);return e[0]=d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-(o-s)*d*.5,e[9]=(n-a)*f*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e},t.ortho=function(e,t,r,i,n,a,o){var s=1/(t-r),d=1/(i-n),f=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+r)*s,e[13]=(n+i)*d,e[14]=(o+a)*f,e[15]=1,e},t.lookAt=function(e,t,r,i){var n=void 0,o=void 0,s=void 0,d=void 0,f=void 0,c=void 0,u=void 0,l=void 0,h=void 0,R=void 0,m=t[0],p=t[1],_=t[2],P=i[0],g=i[1],E=i[2],y=r[0],M=r[1],T=r[2];return Math.abs(m-y)<a.EPSILON&&Math.abs(p-M)<a.EPSILON&&Math.abs(_-T)<a.EPSILON?mat4.identity(e):(u=m-y,l=p-M,h=_-T,n=g*(h*=R=1/Math.sqrt(u*u+l*l+h*h))-E*(l*=R),o=E*(u*=R)-P*h,s=P*l-g*u,(R=Math.sqrt(n*n+o*o+s*s))?(n*=R=1/R,o*=R,s*=R):(n=0,o=0,s=0),d=l*s-h*o,f=h*n-u*s,c=u*o-l*n,(R=Math.sqrt(d*d+f*f+c*c))?(d*=R=1/R,f*=R,c*=R):(d=0,f=0,c=0),e[0]=n,e[1]=d,e[2]=u,e[3]=0,e[4]=o,e[5]=f,e[6]=l,e[7]=0,e[8]=s,e[9]=c,e[10]=h,e[11]=0,e[12]=-(n*m+o*p+s*_),e[13]=-(d*m+f*p+c*_),e[14]=-(u*m+l*p+h*_),e[15]=1,e)},t.targetTo=function(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=i[0],d=i[1],f=i[2],c=n-r[0],u=a-r[1],l=o-r[2],h=c*c+u*u+l*l;h>0&&(c*=h=1/Math.sqrt(h),u*=h,l*=h);var R=d*l-f*u,m=f*c-s*l,p=s*u-d*c;return e[0]=R,e[1]=m,e[2]=p,e[3]=0,e[4]=u*p-l*m,e[5]=l*R-c*p,e[6]=c*m-u*R,e[7]=0,e[8]=c,e[9]=u,e[10]=l,e[11]=0,e[12]=n,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=n,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],d=e[5],f=e[6],c=e[7],u=e[8],l=e[9],h=e[10],R=e[11],m=e[12],p=e[13],_=e[14],P=e[15],g=t[0],E=t[1],y=t[2],M=t[3],T=t[4],b=t[5],v=t[6],L=t[7],x=t[8],w=t[9],U=t[10],D=t[11],I=t[12],B=t[13],A=t[14],S=t[15];return Math.abs(r-g)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-E)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(n-y)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(o-M)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-T)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(d-b)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))&&Math.abs(f-v)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(c-L)<=a.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(u-x)<=a.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(l-w)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(h-U)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(R-D)<=a.EPSILON*Math.max(1,Math.abs(R),Math.abs(D))&&Math.abs(m-I)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(p-B)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(_-A)<=a.EPSILON*Math.max(1,Math.abs(_),Math.abs(A))&&Math.abs(P-S)<=a.EPSILON*Math.max(1,Math.abs(P),Math.abs(S))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.mul=i,t.sub=n},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(){var e=new f.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function o(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],d=r[1],f=r[2],c=r[3];return e[0]=i*c+o*s+n*f-a*d,e[1]=n*c+o*d+a*s-i*f,e[2]=a*c+o*f+i*d-n*s,e[3]=o*c-i*s-n*d-a*f,e}function s(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3],d=r[0],f=r[1],c=r[2],u=r[3],l=void 0,h=void 0,R=void 0,m=void 0,p=void 0;return(h=n*d+a*f+o*c+s*u)<0&&(h=-h,d=-d,f=-f,c=-c,u=-u),1-h>1e-6?(l=Math.acos(h),R=Math.sin(l),m=Math.sin((1-i)*l)/R,p=Math.sin(i*l)/R):(m=1-i,p=i),e[0]=m*n+p*d,e[1]=m*a+p*f,e[2]=m*o+p*c,e[3]=m*s+p*u,e}function d(e,t){var r=t[0]+t[4]+t[8],i=void 0;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var a=(n+1)%3,o=(n+2)%3;i=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*o+o]+1),e[n]=.5*i,i=.5/i,e[3]=(t[3*a+o]-t[3*o+a])*i,e[a]=(t[3*a+n]+t[3*n+a])*i,e[o]=(t[3*o+n]+t[3*n+o])*i}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=n,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=a,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),i=Math.sin(r/2);return 0!=i?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r},t.multiply=o,t.rotateX=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=i*d+o*s,e[1]=n*d+a*s,e[2]=a*d-n*s,e[3]=o*d-i*s,e},t.rotateY=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=i*d-a*s,e[1]=n*d+o*s,e[2]=a*d+i*s,e[3]=o*d-n*s,e},t.rotateZ=function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3],s=Math.sin(r),d=Math.cos(r);return e[0]=i*d+n*s,e[1]=n*d-i*s,e[2]=a*d+o*s,e[3]=o*d-a*s,e},t.calculateW=function(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e},t.slerp=s,t.invert=function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=r*r+i*i+n*n+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-i*s,e[2]=-n*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=d,t.fromEuler=function(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),d=Math.cos(r),f=Math.sin(i),c=Math.cos(i);return e[0]=a*d*c-o*s*f,e[1]=o*s*c+a*d*f,e[2]=o*d*f-a*s*c,e[3]=o*d*c+a*s*f,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var f=i(r(0)),c=i(r(1)),u=i(r(2)),l=i(r(3)),h=(t.clone=l.clone,t.fromValues=l.fromValues,t.copy=l.copy,t.set=l.set,t.add=l.add,t.mul=o,t.scale=l.scale,t.dot=l.dot,t.lerp=l.lerp,t.length=l.length),R=(t.len=h,t.squaredLength=l.squaredLength),m=(t.sqrLen=R,t.normalize=l.normalize);t.exactEquals=l.exactEquals,t.equals=l.equals,t.rotationTo=function(){var e=u.create(),t=u.fromValues(1,0,0),r=u.fromValues(0,1,0);return function(i,n,o){var s=u.dot(n,o);return s<-.999999?(u.cross(e,t,n),u.len(e)<1e-6&&u.cross(e,r,n),u.normalize(e,e),a(i,e,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(u.cross(e,n,o),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+s,m(i,i))}}(),t.sqlerp=function(){var e=n(),t=n();return function(r,i,n,a,o,d){return s(e,i,o,d),s(t,n,a,d),s(r,e,t,2*d*(1-d)),r}}(),t.setAxes=function(){var e=c.create();return function(t,r,i,n){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],m(t,d(t,e))}}()},function(e,t,r){"use strict";function i(){var e=new u.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function n(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function a(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function o(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function s(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function d(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function f(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function c(e){var t=e[0],r=e[1];return t*t+r*r}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=i,t.clone=function(e){var t=new u.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var r=new u.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,r){return e[0]=t,e[1]=r,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},t.subtract=n,t.multiply=a,t.divide=o,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},t.scaleAndAdd=function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e},t.distance=s,t.squaredDistance=d,t.length=f,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e},t.lerp=function(e,t,r,i){var n=t[0],a=t[1];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e},t.random=function(e,t){t=t||1;var r=2*u.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},t.transformMat2=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e},t.transformMat2d=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e},t.transformMat3=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e},t.transformMat4=function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var r=e[0],i=e[1],n=t[0],a=t[1];return Math.abs(r-n)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-a)<=u.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))};var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(0));t.len=f,t.sub=n,t.mul=a,t.div=o,t.dist=s,t.sqrDist=d,t.sqrLen=c,t.forEach=function(){var e=i();return function(t,r,i,n,a,o){var s,d=void 0;for(r||(r=2),i||(i=0),s=n?Math.min(n*r+i,t.length):t.length,d=i;d<s;d+=r)e[0]=t[d],e[1]=t[d+1],a(e,e,o),t[d]=e[0],t[d+1]=e[1];return t}}()}])}),function(){var e;e=function(e,t,r,i,n){var a,o;switch(e.hasOwnProperty(r)&&RedGLUtil.throwFunc(t+" - "+r+" : 이미 정의된 속성"),i){case"hex":a={get:function(){return this["_"+r]},set:function(e){"string"==typeof e||RedGLUtil.throwFunc(t+" - "+r+" 문자열만 허용함","입력값 : "+e),RedGLUtil.regHex(e)||RedGLUtil.throwFunc(t+" - "+r+" : hex 형식만 허용함."+e),this["_"+r]=e,n&&n.callback&&n.callback.call(this,e)}};break;case"boolean":n=void 0==n||n,a={get:function(){return this["_"+r]},set:function(e){"boolean"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : boolean만 허용함."+e),this["_"+r]=e,n&&n.callback&&n.callback.call(this,e)}};break;case"number":if(n){var s=n.min,d=n.max;n.hasOwnProperty("min")&&n.hasOwnProperty("max")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e<s&&(e=s),e>d&&(e=d),this["_"+r]=e,n&&n.callback&&n.callback.call(this,e)}}:n.hasOwnProperty("min")?a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e<s&&(e=s),this["_"+r]=e,n&&n.callback&&n.callback.call(this,e)}}:n.hasOwnProperty("max")&&(a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),e>d&&(e=d),this["_"+r]=e,n&&n.callback&&n.callback.call(this,e)}})}else a={get:function(){return this["_"+r]},set:function(e){"number"!=typeof e&&RedGLUtil.throwFunc(t+" - "+r+" : 숫자만 허용함.","입력값 : "+e),this["_"+r]=e}};break;case"sampler2D":o="RedBaseTexture";break;case"samplerCube":o="RedBitmapCubeTexture";break;case"samplerVideo":o="RedVideoTexture";break;default:RedGLUtil.throwFunc(r+" - type : "+i+" / "+r+" : 정의할수없는 타입입니다.")}if(o){var f=window[o];a=n&&n.essential?{get:function(){return this["_"+r]},set:function(e){f==RedBitmapCubeTexture?e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e):!(e instanceof RedBitmapCubeTexture)&&e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e),this["_"+r]=e,n&&n.callback&&n.callback.call(this)}}:{get:function(){return this["_"+r]},set:function(e){e&&(f==RedBitmapCubeTexture?e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e):!(e instanceof RedBitmapCubeTexture)&&e instanceof f||RedGLUtil.throwFunc(t+" - "+r+" : "+o+" Instance만 허용.","입력값 : "+e)),this["_"+r]=e,n&&n.callback&&n.callback.call(this)}}}e["_"+r]=null,Object.defineProperty(e,r,a)},(RedDefinePropertyInfo={}).definePrototype=function(t,r,i,n){e(window[t].prototype,t,r,i,n)},Object.freeze(RedDefinePropertyInfo)}(),RedGLDetect=function(e){if(!(this instanceof RedGLDetect))return new RedGLDetect(e);var t,r,i,n,a;for(i in t={basic:["VENDOR","VERSION","SHADING_LANGUAGE_VERSION","RENDERER"],frameBuffer:["MAX_COLOR_ATTACHMENTS","MAX_RENDERBUFFER_SIZE","MAX_VIEWPORT_DIMS","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","DEPTH_BITS","STENCIL_BITS"],vertexShader:["MAX_VERTEX_ATTRIBS","MAX_VARYING_VECTORS","MAX_VERTEX_UNIFORM_VECTORS"],fragmentShader:["MAX_FRAGMENT_UNIFORM_VECTORS"],texture:["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_TEXTURE_IMAGE_UNITS"]})for(r=(a=t[i]).length,this[i]={};r--;)this[i][n=a[r]]=e.getParameter(e[n])},Object.freeze(RedGLDetect),function(){var e,t,r;RedGLUtil={throwFunc:function(){throw"RedGL Error : "+Array.prototype.slice.call(arguments).join(" ")},hexToRGB_ZeroToOne:function(e){var t,r;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return r=[],3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),r[0]=(t>>16&255)/255,r[1]=(t>>8&255)/255,r[2]=(255&t)/255,r;RedGLUtil.throwFunc("RedGLUtil.hexToRGB_ZeroToOne : 잘못된 hex값입니다.",e)},rgb2hex:function(e,t,r){return"#"+(16777216+(r|t<<8|e<<16)).toString(16).slice(1)},regHex:(r=/^#(?:[0-9a-fA-F]{3}){1,2}$/,function(e){return r.test(e)}),getStrFromComment:function(e){if("string"!=typeof e&&RedGLUtil.throwFunc("getStrFromComment : 해석할 값은 문자열만 가능",e),t=e.replace("@preserve","").toString().trim().match(/(\/\*)[\s\S]+(\*\/)/g))return t[0].replace(/\/\*|\*\//g,"").trim();RedGLUtil.throwFunc("getStrFromComment : 해석할 불가능한 값",e)},isPowerOf2:function(e){return 0==(e&e-1)},nextHighestPowerOfTwo:function(t){for(--t,e=1;e<32;e<<=1)t|=t>>e;return t+1},calculateNormals:function(e,t){var r,i,n=[];for(r=0;r<e.length;r+=3)n[r+0]=0,n[r+1]=0,n[r+2]=0;for(r=0;r<t.length;r+=3){var a,o,s,d,f=[],c=[],u=[];for(a=3*t[r],o=3*t[r+1],s=3*t[r+2],f[0]=e[s+0]-e[o+0],f[1]=e[s+1]-e[o+1],f[2]=e[s+2]-e[o+2],c[0]=e[a+0]-e[o+0],c[1]=e[a+1]-e[o+1],c[2]=e[a+2]-e[o+2],u[0]=f[1]*c[2]-f[2]*c[1],u[1]=f[2]*c[0]-f[0]*c[2],u[2]=f[0]*c[1]-f[1]*c[0],i=0;i<3;i++)n[(d=3*t[r+i])+0]=n[d+0]+u[0],n[d+1]=n[d+1]+u[1],n[d+2]=n[d+2]+u[2]}for(r=0;r<e.length;r+=3){var l=[];l[0]=n[r+0],l[1]=n[r+1],l[2]=n[r+2];var h=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]);0==h&&(h=1),l[0]=l[0]/h,l[1]=l[1]/h,l[2]=l[2]/h,n[r+0]=l[0],n[r+1]=l[1],n[r+2]=l[2]}return n},clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},quaternionToRotationMat4:function(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,s=i+i,d=n+n,f=r*o,c=r*s,u=r*d,l=i*s,h=i*d,R=n*d,m=a*o,p=a*s,_=a*d;return t[0]=1-(l+R),t[4]=c-_,t[8]=u+p,t[1]=c+_,t[5]=1-(f+R),t[9]=h-m,t[2]=u-p,t[6]=h+m,t[10]=1-(f+l),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4ToEuler:function(e,t,r){t=t||[0,0,0],r=r||"XYZ";var i=e[0],n=e[4],a=e[8],o=e[1],s=e[5],d=e[9],f=e[2],c=e[6],u=e[10];return"XYZ"===r?(t[1]=Math.asin(RedGLUtil.clamp(a,-1,1)),Math.abs(a)<.99999?(t[0]=Math.atan2(-d,u),t[2]=Math.atan2(-n,i)):(t[0]=Math.atan2(c,s),t[2]=0)):"YXZ"===r?(t[0]=Math.asin(-RedGLUtil.clamp(d,-1,1)),Math.abs(d)<.99999?(t[1]=Math.atan2(a,u),t[2]=Math.atan2(o,s)):(t[1]=Math.atan2(-f,i),t[2]=0)):"ZXY"===r?(t[0]=Math.asin(RedGLUtil.clamp(c,-1,1)),Math.abs(c)<.99999?(t[1]=Math.atan2(-f,u),t[2]=Math.atan2(-n,s)):(t[1]=0,t[2]=Math.atan2(o,i))):"ZYX"===r?(t[1]=Math.asin(-RedGLUtil.clamp(f,-1,1)),Math.abs(f)<.99999?(t[0]=Math.atan2(c,u),t[2]=Math.atan2(o,i)):(t[0]=0,t[2]=Math.atan2(-n,s))):"YZX"===r?(t[2]=Math.asin(RedGLUtil.clamp(o,-1,1)),Math.abs(o)<.99999?(t[0]=Math.atan2(-d,s),t[1]=Math.atan2(-f,i)):(t[0]=0,t[1]=Math.atan2(a,u))):"XZY"===r&&(t[2]=Math.asin(-RedGLUtil.clamp(n,-1,1)),Math.abs(n)<.99999?(t[0]=Math.atan2(c,s),t[1]=Math.atan2(a,i)):(t[0]=Math.atan2(-d,u),t[1]=0)),t}},Object.freeze(RedGLUtil)}(),function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p;n={alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!1,powerPreference:"default",failIfMajorPerformanceCaveat:!1},f=["OES_element_index_uint","OES_standard_derivatives","EXT_texture_filter_anisotropic","WEBGL_compressed_texture_s3tc"],r="webkit-3d,moz-webgl,3d,experimental-webgl,webgl,webgl2".split(","),i=[],e=function(e,t,c){if(d=JSON.parse(JSON.stringify(n)),t)for(s in t)d[s]=t[s];for(c?(i.length=0,i.push(c)):i=r.concat(),s=i.length;s--;)if(a=e.getContext(o=i[s],d))return a.glExtension={},f.forEach(function(e){a.glExtension[e]=a.getExtension(e)}),a.version=o,a;return null},t=function(e,t){var r,i,n,a;for(r=e.detect.texture.MAX_COMBINED_TEXTURE_IMAGE_UNITS,a=RedBaseTexture.EMPTY_BASE64,i=RedBitmapTexture(e,a),n=RedBitmapCubeTexture(e,[a,a,a,a,a,a]),e._datas.emptyTexture={"2d":i,"3d":n};r--;)1==r?(t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_CUBE_MAP,n.webglTexture)):(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,i.webglTexture))},(RedGL=function(r,i,n,a,o){var s,d;performance.now();return this instanceof RedGL?(r instanceof Element&&"CANVAS"==r.tagName||RedGLUtil.throwFunc("RedGL : Canvas Element만 허용"),d=this,this._datas={},this._width="100%",this._height="100%",this._renderScale=1,this._viewRect=[0,0,0,0],this._canvas=r,this.gl=s=e(r,n,a),s?(this.detect=RedGLDetect(s),this._UUID=RedGL.makeUUID(),RedSystemShaderCode.init&&RedSystemShaderCode.init(),void requestAnimationFrame(function(){if(window.addEventListener("resize",function(){d.setSize(d._width,d._height)}),d.setSize(d._width,d._height),t(d,s),o){var e=performance.now();RedBitmapMaterial(d,d._datas.emptyTexture["2d"]),e=performance.now()-e;var r=performance.now();RedColorMaterial(d),r=performance.now()-r;var n=performance.now();RedColorPhongMaterial(d),n=performance.now()-n;var a=performance.now();RedColorPhongTextureMaterial(d),a=performance.now()-a;var f=performance.now();RedEnvironmentMaterial(d,d._datas.emptyTexture["2d"],d._datas.emptyTexture["3d"]),f=performance.now()-f;var c=performance.now();RedSheetMaterial(d,d._datas.emptyTexture["2d"]),c=performance.now()-c;var u=performance.now();RedStandardMaterial(d,d._datas.emptyTexture["2d"]),u=performance.now()-u}i&&i.call(d,!!s)})):i?i.call(d,!!s):0):new RedGL(r,i,n,a,o)}).makeUUID=(c=0,function(){return c++}),RedGL.prototype={setSize:(h=0,R=0,function(e,t,r){void 0==e&&RedGLUtil.throwFunc("RedGL setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedGL setSize : height가 입력되지 않았습니다."),u=this._width=e,l=this._height=t,"number"!=typeof u&&(u.indexOf("%")>-1?u=(document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)*parseFloat(u)/100:RedGLUtil.throwFunc("RedGL setSize : width는 0이상의 숫자나 %만 허용.",u)),"number"!=typeof l&&(l.indexOf("%")>-1?l=window.innerHeight*parseFloat(l)/100:RedGLUtil.throwFunc("RedGL setSize : height는 0이상의 숫자나 %만 허용.",l)),m=window.devicePixelRatio||1,p=this._canvas,(h!=u||R!=l||r)&&(p.width=u*m*this._renderScale,p.height=l*m*this._renderScale,p.style.width=u,p.style.height=l,h=u,R=l),this._viewRect[2]=h,this._viewRect[3]=R})},RedDefinePropertyInfo.definePrototype("RedGL","renderScale","number",{min:.1,max:1,callback:function(){this.setSize(this._width,this._height,!0)}}),Object.freeze(RedGL)}(),(RedBaseController=function(){}).prototype={update:function(){RedGLUtil.throwFunc("RedBaseController : update - 재정의 해서 써라")}},Object.freeze(RedBaseController),function(){var e;(RedBaseTexture=function(){}).EMPTY_BASE64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzMxRDhBQzRFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzMxRDhBQzVFNUZFMTFFN0IxMDVGNEEzQjQ0RjAwRDIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MzFEOEFDMkU1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3MzFEOEFDM0U1RkUxMUU3QjEwNUY0QTNCNDRGMDBEMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuojYFUAAAAQSURBVHjaYvj//z8DQIABAAj8Av7bok0WAAAAAElFTkSuQmCC",(e=new Image).src=RedBaseTexture.EMPTY_BASE64,RedBaseTexture.prototype={setEmptyTexture:function(t,r){this instanceof RedBitmapCubeTexture?(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,r),[e,e,e,e,e,e].forEach(function(r,i){t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_CUBE_MAP,null)):(t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,r),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,2,2,0,t.LUMINANCE,t.UNSIGNED_BYTE,new Uint8Array([128,64,0,192])),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.bindTexture(t.TEXTURE_2D,null))}},RedBaseTexture.prototype._load=function(){RedGLUtil.throwFunc("RedBaseTexture - _load : 반드시 재정의해야함")},RedBaseTexture.prototype.src=function(){RedGLUtil.throwFunc("RedBaseTexture - src : 반드시 재정의해야함")},Object.defineProperty(RedBaseTexture.prototype,"callback",{get:function(){return this._callback},set:function(e){e&&"function"!=typeof e&&RedGLUtil.throwFunc("RedBaseTexture : callback은 함수만 허용.","입력값 :",e),this._callback=e}}),Object.freeze(RedBaseTexture)}(),function(){var e,t,r,i,n,a;(RedBaseObject3D=function(){}).build=function(e){this.name="object3D_"+(RedGL.makeUUID()+1),this.useTransparentSort=!1,this.useCullFace=!0,this.cullFace=e.BACK,this.useDepthMask=!0,this.useDepthTest=!0,this.depthTestFunc=e.LEQUAL,this.useBlendMode=!0,this.blendSrc=e.SRC_ALPHA,this.blendDst=e.ONE_MINUS_SRC_ALPHA,this.drawMode=e.TRIANGLES,this.pointSize=1,this.x=this.y=this.z=0,this.rotationX=this.rotationY=this.rotationZ=0,this.scaleX=this.scaleY=this.scaleZ=1,this.autoUpdateMatrix=!0,this._renderAutoUpdateMatrix=!0,this.matrix=mat4.create(),this.cachedMatrix=mat4.create(),this.localMatrix=mat4.create(),this.normalMatrix=mat4.create(),this.cachedNormalMatrix=mat4.create(),this.children=[],this.useLOD=!1,this._lodLevels={}},RedBaseObject3D.prototype={addLOD:function(e,t,r,i){r||i||RedGLUtil.throwFunc("RedBaseObject3D - addLOD : geometry, material 둘중하나는 반드시 입력되어야함"),"number"==typeof e||RedGLUtil.throwFunc("RedBaseObject3D - level : 숫자만허용함"),a={level:e,distance:t,geometry:r||this.geometry,material:i||this.material},this._lodLevels[e]=a},removeLOD:function(e){this._lodLevels[e]&&delete this._lodLevels[e]},localToWorld:(n=mat4.create(),function(e,t,r){return e=e||0,t=t||0,r=r||0,mat4.identity(n),mat4.translate(n,n,[e,t,r]),mat4.multiply(n,this.matrix,n),[n[12],n[13],n[14]]}),worldToLocal:function(){var e,t;return e=mat4.create(),t=mat4.create(),function(r,i,n){return r=r||0,i=i||0,n=n||0,mat4.translate(e,e,[r,i,n]),mat4.multiply(t,e,this.matrix),[t[0]*r+t[1]*i+t[2]*n+t[3],t[4]*r+t[5]*i+t[6]*n+t[7],t[8]*r+t[9]*i+t[10]*n+t[11]]}}(),getScreenPoint:(i=mat4.create(),r={x:0,y:0,z:0,w:0},function(n){return mat4.identity(i),e=n.camera,t=n._viewRect,e instanceof RedBaseController&&(e=e.camera),mat4.multiply(i,e.perspectiveMTX,e.matrix),mat4.multiply(i,i,this.matrix),r.x=i[12],r.y=i[13],r.z=i[14],r.w=i[15],r.x=.5*r.x/r.w+.5,r.y=.5*r.y/r.w+.5,[(t[0]+r.x*t[2])/window.devicePixelRatio,(t[1]+(1-r.y)*t[3])/window.devicePixelRatio]})},Object.defineProperty(RedBaseObject3D.prototype,"geometry",{get:function(){return this._geometry},set:function(e){!e||e instanceof RedGeometry||RedGLUtil.throwFunc("geometry : RedGeometry Instance만 허용.","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedBaseObject3D.prototype,"material",{get:function(){return this._material},set:function(e){!e||e instanceof RedBaseMaterial||RedGLUtil.throwFunc("material : RedBaseMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedBaseObject3D)}(),function(){var e;(RedBaseContainer=function(){}).prototype=new RedBaseObject3D,RedBaseContainer.prototype.sortGeometry=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortGeometry(e);this.children.sort(function(e,t){return(e=e._geometry.interleaveBuffer._UUID)<(t=t._geometry.interleaveBuffer._UUID)?-1:e>t?1:0})},RedBaseContainer.prototype.sortMaterial=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortMaterial(e);this.children.sort(function(e,t){return(e=e._material.program._UUID)<(t=t._material.program._UUID)?-1:e>t?1:0})},RedBaseContainer.prototype.sortGeometryAndMaterial=function(e){if(e)for(var t=this.children.length;t--;)this.children[t].sortGeometryAndMaterial(e);this.children.sort(function(e,t){if((e=e._geometry.interleaveBuffer._UUID)==(t=t._geometry.interleaveBuffer._UUID)){var r=e._material.program._UUID,i=t._material.program._UUID;return r<i?-1:r>i?1:0}return e<t?-1:e>t?1:0})},RedBaseContainer.prototype.addChild=function(e){e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChild","RedBaseObject3D Instance만 가능","입력값 : "+e),this.children.indexOf(e)>-1&&this.removeChild(e),this.children.push(e)},RedBaseContainer.prototype.addChildAt=function(e,t){"number"==typeof t||RedGLUtil.throwFunc("addChildAt","index는 숫자만 입력가능","입력값 : "+t),e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addChildAt","RedBaseObject3D Instance만 가능","입력값 : "+e),this.children.indexOf(e)>-1&&this.removeChild(e),this.children.length<t&&(t=this.children.length),t?this.children.splice(t,0,e):this.children.push(e)},RedBaseContainer.prototype.removeChild=function(t){-1==(e=this.children.indexOf(t))?RedGLUtil.throwFunc("removeChild","존재하지 않는 RedMesh를 삭제하려고 함"):this.children.splice(e,1)},RedBaseContainer.prototype.removeChildAt=function(e){"number"!=typeof e&&RedGLUtil.throwFunc("removeChildAt","index가 Number형이 아님 ","입력값 : "+e),this.children[e]?this.children.splice(e,1):RedGLUtil.throwFunc("removeChildAt","index 해당인덱스에 위치한 자식이 없음.","입력값 : "+e)},RedBaseContainer.prototype.removeChildAll=function(){this.children.length=0},RedBaseContainer.prototype.getChildAt=function(e){return"number"==typeof e||RedGLUtil.throwFunc("getChildAt","index가 Number형이 아님 "),this.children[e]},RedBaseContainer.prototype.getChildIndex=function(e){return this.children.indexOf(e)},RedBaseContainer.prototype.numChildren=function(){return this.children.length},Object.freeze(RedBaseContainer)}(),function(){var e;(RedBaseLight=function(){}).prototype={},RedDefinePropertyInfo.definePrototype("RedBaseLight","intensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBaseLight","alpha","number",{min:0,max:1,callback:function(e){this._lightColor[3]=this._alpha=e}}),RedDefinePropertyInfo.definePrototype("RedBaseLight","color","hex",{callback:function(){e=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._color),this._lightColor[0]=e[0],this._lightColor[1]=e[1],this._lightColor[2]=e[2],this._lightColor[3]=this._alpha}}),Object.freeze(RedBaseLight)}(),(RedFrameBuffer=function(e,t,r){if(!(this instanceof RedFrameBuffer))return new RedFrameBuffer(e,t,r);var i;e instanceof RedGL||RedGLUtil.throwFunc("RedFrameBuffer : RedGL Instance만 허용.",e),t&&("number"==typeof t||RedGLUtil.throwFunc("RedFrameBuffer : width - 숫자만 허용","입력값 : ",t)),r&&("number"==typeof r||RedGLUtil.throwFunc("RedFrameBuffer : height - 숫자만 허용","입력값 : ",r)),i=e.gl,t=t||1920,r=r||1080,t>e.detect.texture.MAX_TEXTURE_SIZE&&(t=e.detect.texture.MAX_TEXTURE_SIZE),r>e.detect.texture.MAX_TEXTURE_SIZE&&(r=e.detect.texture.MAX_TEXTURE_SIZE),this.redGL=e,this.width=t,this.height=r,this.webglFrameBuffer=i.createFramebuffer(),this.webglRenderBuffer=i.createRenderbuffer(),this.texture=RedBitmapTexture(e),this._UUID=RedGL.makeUUID(),i.bindFramebuffer(i.FRAMEBUFFER,this.webglFrameBuffer),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture.webglTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindRenderbuffer(i.RENDERBUFFER,this.webglRenderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,this.width,this.height),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture.webglTexture,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this.webglRenderBuffer),i.bindTexture(i.TEXTURE_2D,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null)}).prototype={bind:function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.webglFrameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture.webglTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,this.webglRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.width,this.height),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.webglTexture,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.webglRenderBuffer)},unbind:function(e){e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},RedDefinePropertyInfo.definePrototype("RedFrameBuffer","width","number",{min:2}),RedDefinePropertyInfo.definePrototype("RedFrameBuffer","height","number",{min:2}),Object.freeze(RedFrameBuffer),function(){var e,t,r;e=function(e,t,r){switch(t){case RedBuffer.ARRAY_BUFFER:if(r instanceof Float32Array)return e.FLOAT;if(r instanceof Float64Array)return e.FLOAT;RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;case RedBuffer.ELEMENT_ARRAY_BUFFER:if(r instanceof Int8Array)return e.BYTE;if(r instanceof Int16Array)return e.SHORT;if(r instanceof Int32Array)return e.INT;if(r instanceof Uint8Array)return e.UNSIGNED_BYTE;if(r instanceof Uint16Array)return e.UNSIGNED_SHORT;if(r instanceof Uint32Array)return e.UNSIGNED_INT;RedGLUtil.throwFunc("RedBuffer : 올바른 TypedArray(RedBuffer.ELEMENT_ARRAY_BUFFER)형식을 사용해야합니다.","입력값 : "+r);break;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ","입력값 : "+t)}},t=function(e,t){switch(t){case RedBuffer.ARRAY_BUFFER:return e.ARRAY_BUFFER;case RedBuffer.ELEMENT_ARRAY_BUFFER:return e.ELEMENT_ARRAY_BUFFER;default:RedGLUtil.throwFunc("RedBuffer : bufferType - 지원하지 않는 버퍼타입입니다. ")}},r=function(e,t,r,i){var n,a,o,s,d;switch(r instanceof Float32Array?d=Float32Array.BYTES_PER_ELEMENT:r instanceof Float64Array&&(d=Float64Array.BYTES_PER_ELEMENT),n=0,t){case RedBuffer.ARRAY_BUFFER:if(e.interleaveDefineInfoList=i,i){for(0==i.length&&RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 1개이상의 RedInterleaveInfo Instance로 구성되어야함.",i),a=0,o=i.length;a<o;a++)(s=i[a])instanceof RedInterleaveInfo||RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList의 정보는 RedInterleaveInfo Instance로만 구성되어야함.",i),s.offset=o<2?0:n,s.offset_BYTES_PER_ELEMENT=o<2?0:n*d,n+=s.size,s._UUID=RedGL.makeUUID(),i[s.attributeKey]=s;o<2?(e.stride=0,e.stride_BYTES_PER_ELEMENT=0,e.pointNum=r.length/3):(e.stride=n,e.stride_BYTES_PER_ELEMENT=n*d,e.pointNum=r.length/n),e.pointNum!=parseInt(e.pointNum)&&RedGLUtil.throwFunc("RedBuffer : ARRAY_BUFFER의 pointNum이 정수로 떨어지지 않음. 데이터구성과 interleaveDefineInfoList 구성 확인 필요")}else RedGLUtil.throwFunc("RedBuffer : interleaveDefineInfoList는 반드시 정의 되어야함.");break;case RedBuffer.ELEMENT_ARRAY_BUFFER:e.pointNum=r.length}},(RedBuffer=function(i,n,a,o,s,d){if(!(this instanceof RedBuffer))return new RedBuffer(i,n,a,o,s,d);i instanceof RedGL||RedGLUtil.throwFunc("RedBuffer : RedGL Instance만 허용.",i),"string"==typeof n||RedGLUtil.throwFunc("RedBuffer : key - 문자열만 허용.","입력값 : "+n),a||RedGLUtil.throwFunc("RedBuffer : bufferType : 미입력, 반드시 입력해야함."),a==RedBuffer.ARRAY_BUFFER||a==RedBuffer.ELEMENT_ARRAY_BUFFER||RedGLUtil.throwFunc("RedBuffer : bufferType - RedBuffer.ARRAY_BUFFER or RedBuffer.ELEMENT_ARRAY_BUFFER 만 허용함.","입력값 : "+a);var f=i.gl;if(i._datas.RedBuffer||(i._datas.RedBuffer={},i._datas.RedBuffer[RedBuffer.ARRAY_BUFFER]={},i._datas.RedBuffer[RedBuffer.ELEMENT_ARRAY_BUFFER]={}),i._datas.RedBuffer[a][n])return i._datas.RedBuffer[a][n];i._datas.RedBuffer[a][n]=this,a!=RedBuffer.ARRAY_BUFFER||s||RedGLUtil.throwFunc("RedBuffer : 신규생성시 interleaveDefineInfoList를 반드시 정의해야합니다.","입력값 : "+s),this.key=n,this.data=o,this.bufferType=a,this.glBufferType=t(f,this.bufferType),this.glArrayType=e(f,this.bufferType,this.data),this.drawMode=d||f.STATIC_DRAW,r(this,this.bufferType,this.data,s),this.webglBuffer=f.createBuffer(),this._UUID=RedGL.makeUUID(),this.upload=function(t){this.glArrayType==e(f,a,t)?(this.data=t,f.bindBuffer(this.glBufferType,this.webglBuffer),f.bufferData(this.glBufferType,this.data,this.drawMode),r(this,this.bufferType,this.data,this.interleaveDefineInfoList),this.bufferType==RedBuffer.ARRAY_BUFFER&&(this.triangleNum=this.data.length/(this.stride?this.stride:3)),this.bufferType==RedBuffer.ELEMENT_ARRAY_BUFFER&&(this.triangleNum=this.pointNum/3)):RedGLUtil.throwFunc("RedBuffer : upload - data형식이 기존 형식과 다름",t)},this.upload(this.data)}).ARRAY_BUFFER="arrayBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER="elementArrayBuffer",Object.freeze(RedBuffer)}(),RedGeometry=function(e,t){if(!(this instanceof RedGeometry))return new RedGeometry(e,t);e instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer Instance만 허용.",e),e.bufferType==RedBuffer.ARRAY_BUFFER||RedGLUtil.throwFunc("RedGeometry : interleaveBuffer - RedBuffer.ARRAY_BUFFER 타입만 허용.",e),t&&(e||RedGLUtil.throwFunc("RedGeometry : indexBuffer는 반드시 interleaveBuffer와 쌍으로 입력되어야함.",t),t instanceof RedBuffer||RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer Instance만 허용.",t),t.bufferType==RedBuffer.ELEMENT_ARRAY_BUFFER||RedGLUtil.throwFunc("RedGeometry : indexBuffer - RedBuffer.ELEMENT_ARRAY_BUFFER 타입만 허용.",t)),this.interleaveBuffer=e,this.indexBuffer=t,this._UUID=RedGL.makeUUID()},Object.freeze(RedGeometry),RedInterleaveInfo=function(e,t,r){if(!(this instanceof RedInterleaveInfo))return new RedInterleaveInfo(e,t,r);"string"==typeof e||RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey - 문자열만 허용",e),"a"==e.charAt(0)||RedGLUtil.throwFunc("RedInterleaveInfo : attributeKey 첫글자는 a로 시작해야합니다.",e),e.charAt(1)==e.charAt(1).toUpperCase()||RedInterleaveInfo.throwFunc("RedInterleaveInfo : attributeKey 두번째 글자는 대문자 시작해야합니다.",e),"number"==typeof t||RedGLUtil.throwFunc("RedInterleaveInfo : size - 숫자만 허용",t),this.attributeKey=e,this.size=t,this.normalize=void 0!=r,this.offset=null},Object.freeze(RedInterleaveInfo),function(){var e,t,r,i,n,a,o;(RedBaseMaterial=function(){}).prototype={makeProgramList:(o=["fog","sprite3D","skin","directionalShadow"],o.sort(),n=function(e,t,r,a,o,s){e.basic[t]||(e.basic[t]=RedProgram.makeProgram(r,t,a,o)),s.forEach(function(d,f){var c=s.join("_");e[c]={},e[c][t]||(e[c][t]=new i(r,t,a,o,s));var u=JSON.parse(JSON.stringify(s));u.splice(f,1),n(e,t,r,a,o,u)})},i=function(e,t,r,i,n){this._prepareProgramYn=!0,this.key=t+"_"+n.join("_"),this._makePrepareProgram=function(){return RedProgram.makeProgram(e,t,r,i,n)}},a=function(e,t,r,n,o,s,d){var f,c;for((d=d.concat()).sort(),f=d.length;f--;)c=d[f],c=""==t?c:t+"_"+c,e._programList.basic[n+"_"+c]||(e._programList.basic[n+"_"+c]=new i(r,n,o,s,c.split("_")),e._programList.directionalShadow[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow").split("_")),e._programList.directionalShadow_fog[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_fog").split("_")),e._programList.directionalShadow_fog_skin[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_fog_skin").split("_")),e._programList.directionalShadow_fog_skin_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_fog_skin_sprite3D").split("_")),e._programList.directionalShadow_fog_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_fog_sprite3D").split("_")),e._programList.directionalShadow_skin[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_skin").split("_")),e._programList.directionalShadow_skin_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_skin_sprite3D").split("_")),e._programList.directionalShadow_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_directionalShadow_sprite3D").split("_")),e._programList.fog[n+"_"+c]=new i(r,n,o,s,(c+"_fog").split("_")),e._programList.fog_skin[n+"_"+c]=new i(r,n,o,s,(c+"_fog_skin").split("_")),e._programList.fog_skin_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_fog_skin_sprite3D").split("_")),e._programList.fog_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_fog_sprite3D").split("_")),e._programList.skin[n+"_"+c]=new i(r,n,o,s,(c+"_skin").split("_")),e._programList.skin_sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_skin_sprite3D").split("_")),e._programList.sprite3D[n+"_"+c]=new i(r,n,o,s,(c+"_sprite3D").split("_")),a(e,c,r,n,o,s,d.concat().slice(f+1)))},function(e,t,r,i,s,d){d||(d=[]),t._datas.RedProgramGroup||(t._datas.RedProgramGroup={}),t._datas.RedProgramGroup[r]?e._programList=t._datas.RedProgramGroup[r]:(e._programList={basic:{}},n(e._programList,r,t,i,s,o),a(e,"",t,r,i,s,d),e._programList.basic[r]=RedProgram.makeProgram(t,r,i,s),t._datas.RedProgramGroup[r]=e._programList),e.program=e._programList.basic[r]}),_searchProgram:function(i,n){if(r=[],n)for(e=n.length;e--;)this[t=n[e]]&&r.push(t);r.length?(r.sort(),r=i+"_"+r.join("_")):r=i,this.program=this._programList.basic[r]},checkUniformAndProperty:function(){var e,t,r;return function(){for(this.program._prepareProgramYn&&(this.program=this.program._makePrepareProgram(),this.program._prepareProgramYn=!1),t=this.program.uniformLocation,e=t.length;e--;)r=t[e],!r.location||r.materialPropertyName in this||RedGLUtil.throwFunc(this.program.key+"- ",r.materialPropertyName,"속성이 정의 되지않았습니다.")}}()},Object.freeze(RedBaseMaterial)}(),RedTextureOptionChecker={check:function(e,t,r){t&&(t.min&&t.min!=r.LINEAR&&t.min!=r.NEAREST&&t.min!=r.NEAREST_MIPMAP_NEAREST&&t.min!=r.LINEAR_MIPMAP_NEAREST&&t.min!=r.NEAREST_MIPMAP_LINEAR&&t.min!=r.LINEAR_MIPMAP_LINEAR&&RedGLUtil.throwFunc(e+": min 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.min),t.mag&&t.mag!=r.LINEAR&&t.mag!=r.NEAREST&&RedGLUtil.throwFunc(e+" : mag 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.mag),t.wrap_s&&t.wrap_s!=r.REPEAT&&t.wrap_s!=r.CLAMP_TO_EDGE&&t.wrap_s!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_s 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_s),t.wrap_t&&t.wrap_t!=r.REPEAT&&t.wrap_t!=r.CLAMP_TO_EDGE&&t.wrap_t!=r.MIRRORED_REPEAT&&RedGLUtil.throwFunc(e+" : wrap_t 텍스쳐 옵션에서 사용할수 없는값 입력됨.","입력값 : "+t.wrap_t))}},Object.freeze(RedTextureOptionChecker),function(){var e,t,r;t=function(e,t,r,i){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.min?i.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.mag?i.mag:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrap_s?i.wrap_s:e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrap_t?i.wrap_t:e.REPEAT),e.glExtension.EXT_texture_filter_anisotropic&&i.anisotropic&&e.texParameterf(e.TEXTURE_2D,e.glExtension.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.anisotropic);try{e.generateMipmap(e.TEXTURE_2D)}catch(e){}e.bindTexture(e.TEXTURE_2D,null)},e=function(e,i,n,a,o,s){var d,f,c,u;o||(o={}),a instanceof HTMLCanvasElement?t(e,n,a,o):(u=function(e){e.removeEventListener("error",f),e.removeEventListener("load",c)},f=function(){u(this),s&&s.call(i,!1)},c=function(){u(this);var i,a,d=this;if(d instanceof HTMLImageElement&&(!RedGLUtil.isPowerOf2(d.width)||!RedGLUtil.isPowerOf2(d.height))){var f=document.createElement("canvas"),c=f.getContext("2d");i=RedGLUtil.nextHighestPowerOfTwo(d.width),a=RedGLUtil.nextHighestPowerOfTwo(d.height),i>r&&(i=r),a>r&&(a=r),f.width=i,f.height=a,c.drawImage(d,0,0,i,a),d=f}t(e,n,d,o),s&&s.call(this,!0)},(d=new Image).crossOrigin="anonymous",d.src=a,d.addEventListener("error",f),d.addEventListener("load",c))},(RedBitmapTexture=function(t,i,n,a){var o;if(!(this instanceof RedBitmapTexture))return new RedBitmapTexture(t,i,n,a);t instanceof RedGL||RedGLUtil.throwFunc("RedBitmapTexture : RedGL Instance만 허용.",t),o=t.gl,r=t.detect.texture.MAX_TEXTURE_SIZE,this.webglTexture=o.createTexture(),this._load=function(t){RedTextureOptionChecker.check("RedBitmapTexture",n,o),t&&this.setEmptyTexture(o,this.webglTexture),this._src&&e(o,this,this.webglTexture,this._src,this._option,this._callback)},this._option=n,this.callback=a,this.src=i,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseTexture,Object.defineProperty(RedBitmapTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLCanvasElement||RedGLUtil.throwFunc("RedBitmapTexture : src는 문자열 or Canvas Element만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),Object.defineProperty(RedBitmapTexture.prototype,"option",{get:function(){return this._option},set:function(e){this._option=e,this._load(!1)}}),Object.freeze(RedBitmapTexture)}(),function(){var e,t;t=function(e,t,r){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null)},e=function(e,r,i,n,a){var o,s,d,f;d=function(e){e.removeEventListener("error",o),e.removeEventListener("canplaythrough",s)},o=function(){d(this),a&&a.call(r,!1)},s=function(){d(this),this.play(),r._videoDom.loaded=!0,t(e,i,this),a&&a.call(r,!0)},n instanceof HTMLVideoElement?f=n:(f=document.createElement("video")).src=n,f.loop=1,f.muted=!0,f.setAttribute("autoplay",""),f.style.cssText="position:absolute;top:0px;left:0px;z-index:200",r._videoDom=f,r._videoDom.loaded=!1,f.addEventListener("error",o),f.addEventListener("canplaythrough",s)},(RedVideoTexture=function(t,r,i){var n;if(!(this instanceof RedVideoTexture))return new RedVideoTexture(t,r,i);t instanceof RedGL||RedGLUtil.throwFunc("RedVideoTexture : RedGL Instance만 허용.",t),n=t.gl,this.webglTexture=n.createTexture(),this._UUID=RedGL.makeUUID(),this._load=function(t){t&&this.setEmptyTexture(n,this.webglTexture),this._src&&e(n,this,this.webglTexture,this._src,this._callback)},this.callback=i,this.src=r}).prototype=new RedBaseTexture,Object.defineProperty(RedVideoTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLVideoElement||RedGLUtil.throwFunc("RedVideoTexture : src는 문자열 or HTMLVideoElement만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),Object.freeze(RedVideoTexture)}(),(RedDDSTexture=function(e,t,r,i){var n;if(!(this instanceof RedDDSTexture))return new RedDDSTexture(e,t,r,i);e instanceof RedGL||RedGLUtil.throwFunc("RedDDSTexture : RedGL Instance만 허용.",e),(n=e.gl).glExtension.WEBGL_compressed_texture_s3tc||RedGLUtil.throwFunc("RedDDSTexture : WEBGL_compressed_texture_s3tc확장을 지원하지않는 하드웨어입니다."),this.webglTexture=n.createTexture(),this._load=function(e){RedTextureOptionChecker.check("RedDDSTexture",r,n),e&&this.setEmptyTexture(n,this.webglTexture),this._src&&this.loadDDSTexture(n,n.glExtension.WEBGL_compressed_texture_s3tc,this._src,this._callback)},this.callback=i,this.src=t,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseTexture,Object.defineProperty(RedDDSTexture.prototype,"src",{get:function(){return this._src},set:function(e){!e||"string"==typeof e||e instanceof HTMLCanvasElement||RedGLUtil.throwFunc("RedDDSTexture : src는 문자열 or Canvas Element만 허용.","입력값 : "+e),this._src=e,this._load(!0)}}),function(e){"use strict";function t(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r=t("DXT1"),i=t("DXT3"),n=t("DXT5"),a=e.uploadDDSLevels=function(e,t,a,o){var s,d,f,c,u,l,h,R,m,p=new Int32Array(a,0,31);if(542327876!=p[0])return 0;if(4&!p[20])return 0;switch(p[21]){case r:s=8,d=t.COMPRESSED_RGBA_S3TC_DXT1_EXT;break;case i:s=16,d=t.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case n:s=16,d=t.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}for(R=1,131072&p[2]&&!1!==o&&(R=Math.max(1,p[7])),f=p[4],c=p[3],l=p[1]+4,m=0;m<R;++m)u=Math.max(4,f)/4*Math.max(4,c)/4*s,h=new Uint8Array(a,l,u),e.compressedTexImage2D(e.TEXTURE_2D,m,d,f,c,0,h),l+=u,f*=.5,c*=.5;return R};e.loadDDSTexture=function(e,t,r,i,n){var o=this.webglTexture,s=new XMLHttpRequest;return s.open("GET",r,!0),s.responseType="arraybuffer",i||(i={}),s.onload=function(){e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,o);var r=a(e,t,this.response);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.min?i.min:r>1?e.LINEAR_MIPMAP_NEAREST:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.mag?i.mag:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),n&&n(!0)},s.onerror=function(){n&&n(!1)},s.send(null),o}}(RedDDSTexture.prototype),Object.freeze(RedDDSTexture),function(){var e;e=function(e,t,r,i,n,a){var o,s,d,f,c,u,l=[];for(n=n||{},d=function(e){e.removeEventListener("error",o),e.removeEventListener("load",s)},o=function(){d(this),0==u&&a.call(t,!1),u++},s=function(){if(6==++c){d(this),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,r);var i=l.length;for(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1);i--;)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l[i]);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,n.min?n.min:e.LINEAR_MIPMAP_NEAREST),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,n.mag?n.mag:e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,n.wrap_s?n.wrap_s:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,n.wrap_t?n.wrap_t:e.CLAMP_TO_EDGE);try{e.generateMipmap(e.TEXTURE_CUBE_MAP)}catch(e){}e.bindTexture(e.TEXTURE_CUBE_MAP,null),0==u&&a&&a.call(t,!0)}else d(this)},f=6,c=0,u=0;f--;){var h;(h=new Image).crossOrigin="anonymous",h.src=i[f],h.addEventListener("error",o),h.addEventListener("load",s),l[f]=h}},(RedBitmapCubeTexture=function(t,r,i,n){var a;if(!(this instanceof RedBitmapCubeTexture))return new RedBitmapCubeTexture(t,r,i,n);t instanceof RedGL||RedGLUtil.throwFunc("RedBitmapCubeTexture : RedGL Instance만 허용.","입력값 : "+t),a=t.gl,this.webglTexture=a.createTexture(),this._UUID=RedGL.makeUUID(),this._load=function(t){RedTextureOptionChecker.check("RedBitmapCubeTexture",i,a),t&&this.setEmptyTexture(a,this.webglTexture),this._srcList&&e(a,this,this.webglTexture,this._srcList,this._option,this._callback)},this._option=i,this.callback=n,this.srcList=r}).prototype=new RedBaseTexture,Object.defineProperty(RedBitmapCubeTexture.prototype,"srcList",{get:function(){return this._srcList},set:function(e){e instanceof Array||RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList는 배열만 허용.","입력값 : "+e),6==e.length||RedGLUtil.throwFunc("RedBitmapCubeTexture : srcList 길이는 6이어야함","입력값 : "+e),this._srcList=e,this._load(!0)}}),Object.defineProperty(RedBitmapCubeTexture.prototype,"option",{get:function(){return this._option},set:function(e){this._option=e,this._load(!1)}}),Object.freeze(RedBitmapCubeTexture)}(),function(){var e,t,r,i;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform vec4 u_color;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = u_color * u_color.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedColorMaterial=function(i,n,a){if(!(this instanceof RedColorMaterial))return new RedColorMaterial(i,n,a);i instanceof RedGL||RedGLUtil.throwFunc("RedColorMaterial : RedGL Instance만 허용.","입력값 : "+i),this.makeProgramList(this,i,"RedColorMaterialProgram",e,t),this._color=new Float32Array(4),this.alpha=void 0==a?1:a,this.color=n||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedColorMaterial.DEFINE_OBJECT_COLOR={get:function(){return this._colorHex},set:function(e){this._colorHex=e||"#ff2211",i=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._colorHex),this._color[0]=i[0],this._color[1]=i[1],this._color[2]=i[2],this._color[3]=this._alpha}},RedColorMaterial.DEFINE_OBJECT_ALPHA={min:0,max:1,callback:function(e){this._color[3]=this._alpha=e}},Object.defineProperty(RedColorMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),Object.freeze(RedColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
void main(void) {
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
//#define#skin#true# mat4 skinMat =
//#define#skin#true# aVertexWeight.x * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.x) ] * uInverseBindMatrixForJoint[int(aVertexJoint.x)]+
//#define#skin#true# aVertexWeight.y * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.y) ] * uInverseBindMatrixForJoint[int(aVertexJoint.y)]+
//#define#skin#true# aVertexWeight.z * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.z) ] * uInverseBindMatrixForJoint[int(aVertexJoint.z)]+
//#define#skin#true# aVertexWeight.w * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.w) ] * uInverseBindMatrixForJoint[int(aVertexJoint.w)];
//#define#skin#true# vVertexPositionEye4 =  uMMatrix *  skinMat* vec4(aVertexPosition, 1.0) ;
//#define#skin#false# vVertexPositionEye4 =  uMMatrix *  vec4(aVertexPosition, 1.0) ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_shininess;
uniform float u_specularPower;
uniform vec4 u_color;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = u_color;
// texelColor.rgb *= texelColor.a;
N = normalize(vVertexNormal);
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot( reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i]  * uPointLightColorList[i].a ;
}
}
}
vec4 finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedColorPhongMaterial=function(i,n,a){if(!(this instanceof RedColorPhongMaterial))return new RedColorPhongMaterial(i,n,a);i instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongMaterial : RedGL Instance만 허용.","입력값 : "+i),this.makeProgramList(this,i,"RedColorPhongMaterialProgram",e,t),this._color=new Float32Array(4),this.shininess=16,this.specularPower=1,this.alpha=void 0==a?1:a,this.color=n||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.defineProperty(RedColorPhongMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongMaterial","specularPower","number",{min:0}),Object.freeze(RedColorPhongMaterial)}(),function(){var e,t,r,i=["normalTexture","specularTexture","displacementTexture"];e=function(){
/* @preserve
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix* vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform vec4 u_color;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = u_color;
// texelColor.rgb *= texelColor.a;
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
float specularTextureValue = 1.0;
//#define#specularTexture# specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] * uPointLightColorList[i].a;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/};var n={callback:function(){this._searchProgram("RedColorPhongTextureMaterialProgram",i)}};(RedColorPhongTextureMaterial=function(n,a,o,s,d,f){if(!(this instanceof RedColorPhongTextureMaterial))return new RedColorPhongTextureMaterial(n,a,o,s,d,f);n instanceof RedGL||RedGLUtil.throwFunc("RedColorPhongTextureMaterial : RedGL Instance만 허용.","입력값 : "+n),this.makeProgramList(this,n,"RedColorPhongTextureMaterialProgram",e,t,i),this._color=new Float32Array(4),this.normalTexture=s,this.specularTexture=d,this.displacementTexture=f,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=void 0==o?1:o,this.color=a||"#ff0000",this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.defineProperty(RedColorPhongTextureMaterial.prototype,"color",RedColorMaterial.DEFINE_OBJECT_COLOR),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","alpha","number",RedColorMaterial.DEFINE_OBJECT_ALPHA),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedColorPhongTextureMaterial","displacementFlowSpeedY","number"),Object.freeze(RedColorPhongTextureMaterial)}(),function(){var e,t,r,i=["diffuseTexture","normalTexture","specularTexture","displacementTexture","emissiveTexture"];e=function(){
/* @preserve
varying vec4 vVertexPositionEye4;
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = (uNMatrix * vec4(aVertexNormal,1.0)).xyz;
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
}
*/},t=function(){
/* @preserve
precision mediump float;
//#define#diffuseTexture# uniform sampler2D u_diffuseTexture;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
uniform samplerCube u_environmentTexture;
//#define#emissiveTexture# uniform sampler2D u_emissiveTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform float u_reflectionPower;
uniform float u_alpha;
varying vec4 vVertexPositionEye4;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor= vec4(0.0,0.0,0.0,0.0);
vec4 emissiveColor;
vec4 reflectionColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = vec4(0.0,0.0,0.0,0.0);
//#define#diffuseTexture# texelColor = texture2D(u_diffuseTexture, vTexcoord);
//#define#diffuseTexture# texelColor.rgb *= texelColor.a;
//#define#diffuseTexture# if(texelColor.a ==0.0) discard;
//#define#emissiveTexture# emissiveColor = texture2D(u_emissiveTexture, vTexcoord);
//#define#emissiveTexture# emissiveColor.rgb *= texelColor.a;
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
vec3 R = reflect( vVertexPositionEye4.xyz-uCameraPosition, N);
reflectionColor = textureCube(u_environmentTexture, R);
texelColor = mix(texelColor,reflectionColor ,u_reflectionPower);
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
//#define#specularTexture#  specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i] * uPointLightColorList[i].a;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
//#define#emissiveTexture# finalColor.rgb += emissiveColor.rgb;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a * u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedEnvironmentMaterial=function(n,a,o,s,d,f,c){if(!(this instanceof RedEnvironmentMaterial))return new RedEnvironmentMaterial(n,a,o,s,d,f,c);n instanceof RedGL||RedGLUtil.throwFunc("RedEnvironmentMaterial : RedGL Instance만 허용.",n),o instanceof RedBitmapCubeTexture||RedGLUtil.throwFunc("RedEnvironmentMaterial : environmentTexture - RedBitmapCubeTexture Instance만 허용."),this.makeProgramList(this,n,"RedEnvironmentMaterialProgram",e,t,i),this.diffuseTexture=a,this.environmentTexture=o,this.normalTexture=s,this.specularTexture=d,this.displacementTexture=f,this.emissiveTexture=c,this.normalPower=1,this.shininess=8,this.specularPower=1,this.reflectionPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial;var n={callback:function(){this._searchProgram("RedEnvironmentMaterialProgram",i)}};RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","diffuseTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","environmentTexture","samplerCube",{essential:!0,callback:n.callback}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","emissiveTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","reflectionPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedEnvironmentMaterial","displacementFlowSpeedY","number"),Object.freeze(RedEnvironmentMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = aTexcoord;
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedBitmapMaterial=function(i,n){if(!(this instanceof RedBitmapMaterial))return new RedBitmapMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedBitmapMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"RedBitmapMaterialProgram",e,t),this.diffuseTexture=n,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedBitmapMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedParticleColorMaterial=function(i){if(!(this instanceof RedParticleColorMaterial))return new RedParticleColorMaterial(i);i instanceof RedGL||RedGLUtil.throwFunc("RedParticleColorMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"particleColorProgram",e,t),this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedParticleColorMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedParticleColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
gl_Position = uPMatrix * uCameraMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
vColor = aVertexColor;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alphaTest;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
finalColor.rgb += vColor.rgb * vColor.a;
finalColor.a *= vColor.a;
finalColor.a *= u_alpha;
if(finalColor.a < u_alphaTest) discard;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedParticleBitmapMaterial=function(i,n){if(!(this instanceof RedParticleBitmapMaterial))return new RedParticleBitmapMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedParticleBitmapMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"particleBitmapProgram",e,t),this.diffuseTexture=n,this.alpha=1,this.alphaTest=.01,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedParticleBitmapMaterial","alphaTest","number",{min:0,max:1}),Object.freeze(RedParticleBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_alpha;
varying vec4 vColor;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = vColor;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedPointColorMaterial=function(i){if(!(this instanceof RedPointColorMaterial))return new RedPointColorMaterial(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPointColorMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"pointColorProgram",e,t),this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPointColorMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedPointColorMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
gl_PointSize = aPointSize/gl_Position.w * uResolution.y;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alphaTest;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vec2(gl_PointCoord.x, - gl_PointCoord.y));
finalColor.rgb *= finalColor.a;
if(finalColor.a < u_alphaTest) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedPointBitmapMaterial=function(i,n){if(!(this instanceof RedPointBitmapMaterial))return new RedPointBitmapMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedPointBitmapMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"pointBitmapProgram",e,t),this.diffuseTexture=n,this.alpha=1,this.alphaTest=.1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","alphaTest","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedPointBitmapMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPointBitmapMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
uniform vec4 u_sheetRect;
void main(void) {
vTexcoord = aTexcoord;
vTexcoord = vec2(
vTexcoord.s * u_sheetRect.x + u_sheetRect.z,
vTexcoord.t * u_sheetRect.y - u_sheetRect.w
);
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a *= u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedSheetMaterial=function(i,n,a,o,s,d){if(!(this instanceof RedSheetMaterial))return new RedSheetMaterial(i,n,a,o,s,d);i instanceof RedGL||RedGLUtil.throwFunc("RedSheetMaterial : RedGL Instance만 허용.",i),a=a||60,o=o||1,s=s||1,d=d||1,this.makeProgramList(this,i,"RedSheetMaterialProgram",e,t),this.diffuseTexture=n,this._sheetRect=new Float32Array(4),this.alpha=1,this._perFrameTime=0,this._nextFrameTime=0,this._playYn=!0,this.segmentW=o,this.segmentH=s,this.totalFrame=d,this.frameRate=a,this.currentIndex=0,this.loop=!0,this._aniMap={},this.__RedSheetMaterialYn=!0,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedSheetMaterial.prototype.addAction=function(e,t){this._aniMap[e]=t},RedSheetMaterial.prototype.setAction=function(e){this.diffuseTexture=this._aniMap[e].texture,this.segmentW=this._aniMap[e].segmentW,this.segmentH=this._aniMap[e].segmentH,this.totalFrame=this._aniMap[e].totalFrame,this.frameRate=this._aniMap[e].frameRate,this.currentIndex=0,this._nextFrameTime=0},RedSheetMaterial.prototype.play=function(){this._playYn=!0},RedSheetMaterial.prototype.stop=function(){this._playYn=!1,this.currentIndex=0},RedSheetMaterial.prototype.pause=function(){this._playYn=!1},RedSheetMaterial.prototype.gotoAndStop=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!1,this.currentIndex=e},RedSheetMaterial.prototype.gotoAndPlay=function(e){e>this.totalFrame-1&&(e=this.totalFrame-1),e<0&&(e=0),this._playYn=!0,this.currentIndex=e,this._nextFrameTime=0},RedDefinePropertyInfo.definePrototype("RedSheetMaterial","diffuseTexture","sampler2D",{essential:!0}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","totalFrame","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","loop","boolean",!0),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","frameRate","number",{min:1,callback:function(){this._perFrameTime=1e3/this._frameRate}}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","segmentW","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","segmentH","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedSheetMaterial","alpha","number",{min:0,max:1}),Object.freeze(RedSheetMaterial)}(),function(){var e,t,r,i=["normalTexture","specularTexture","emissiveTexture","displacementTexture"];e=function(){
/* @preserve
//#define#displacementTexture# uniform sampler2D u_displacementTexture;
//#define#displacementTexture# uniform float u_displacementPower;
//#define#displacementTexture# uniform float u_displacementFlowSpeedX;
//#define#displacementTexture# uniform float u_displacementFlowSpeedY;
varying vec4 vVertexPositionEye4;
void main(void) {
vTexcoord = aTexcoord;
vVertexNormal = vec3(uNMatrix * vec4(aVertexNormal,1.0));
vVertexPositionEye4 = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#displacementTexture# vVertexPositionEye4.xyz += normalize(vVertexNormal) * texture2D(u_displacementTexture, vTexcoord + vec2(
//#define#displacementTexture#    u_displacementFlowSpeedX * (uTime/1000.0),
//#define#displacementTexture#    u_displacementFlowSpeedY * (uTime/1000.0)
//#define#displacementTexture# )).x * u_displacementPower ;
gl_PointSize = uPointSize;
gl_Position = uPMatrix * uCameraMatrix * vVertexPositionEye4;
//#define#directionalShadow#true# vResolution = uResolution;
//#define#directionalShadow#true# vShadowPos = cTexUnitConverter  *  uDirectionalShadowLightMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
//#define#normalTexture# uniform sampler2D u_normalTexture;
//#define#specularTexture# uniform sampler2D u_specularTexture;
//#define#emissiveTexture# uniform sampler2D u_emissiveTexture;
//#define#normalTexture# uniform float u_normalPower;
uniform float u_shininess;
uniform float u_specularPower;
uniform float u_alpha;
varying vec4 vVertexPositionEye4;
float cShadowAcneRemover = 0.0007;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
float decodeFloat (vec4 color) {
const vec4 cBitShift = vec4(
1.0 / (256.0 * 256.0 * 256.0),
1.0 / (256.0 * 256.0),
1.0 / 256.0,
1
);
return dot(color, cBitShift);
}
vec4 la;
vec4 ld;
vec4 ls;
vec4 texelColor;
vec4 emissiveColor;
vec4 specularLightColor= vec4(1.0, 1.0, 1.0, 1.0);
vec4 finalColor;
vec3 N;
vec3 L;
float lambertTerm;
float specular;
float specularTextureValue;
float distanceLength;
float attenuation;
void main(void) {
la = uAmbientLightColor * uAmbientLightColor.a;
ld = vec4(0.0, 0.0, 0.0, 1.0);
ls = vec4(0.0, 0.0, 0.0, 1.0);
texelColor = texture2D(u_diffuseTexture, vTexcoord);
texelColor.rgb *= texelColor.a;
if(texelColor.a ==0.0) discard;
//#define#emissiveTexture# emissiveColor = texture2D(u_emissiveTexture, vTexcoord);
//#define#emissiveTexture# emissiveColor.rgb *= texelColor.a;
///////////////////////////////////////////////////////////////////////////////////////
//#define#directionalShadow#true#	vec3 fragmentDepth = vShadowPos.xyz;
//#define#directionalShadow#true#    fragmentDepth.z -= cShadowAcneRemover;
//#define#directionalShadow#true#	float amountInLight = 0.0;
//#define#directionalShadow#true#	for (int x = -1; x <= 1; x++) {
//#define#directionalShadow#true#	    for (int y = -1; y <= 1; y++) {
//#define#directionalShadow#true#	        vec2 tUV = fragmentDepth.xy + vec2(float(x)/vResolution.x, float(y)/vResolution.y) ;
//#define#directionalShadow#true#            if(tUV.x<0.0) continue;
//#define#directionalShadow#true#            if(tUV.x>1.0) continue;
//#define#directionalShadow#true#            if(tUV.y<0.0) continue;
//#define#directionalShadow#true#            if(tUV.y>1.0) continue;
//#define#directionalShadow#true#	        float texelDepth = decodeFloat(texture2D(uDirectionalShadowTexture,tUV));
//#define#directionalShadow#true#	        if (fragmentDepth.z < texelDepth ) amountInLight += 0.5;
//#define#directionalShadow#true#	       // texelColor =  texture2D(uDirectionalShadowTexture,tUV);
//#define#directionalShadow#true#	    }
//#define#directionalShadow#true#	}
//#define#directionalShadow#true#	amountInLight /= 9.0;
//#define#directionalShadow#true#	texelColor.rgb *= (1.0-amountInLight);
///////////////////////////////////////////////////////////////////////////////////////
N = normalize(vVertexNormal);
//#define#normalTexture# vec4 normalColor = texture2D(u_normalTexture, vTexcoord);
//#define#normalTexture# if(normalColor.a != 0.0) N = normalize(2.0 * (N + normalColor.rgb * u_normalPower  - 0.5));
specularLightColor = vec4(1.0, 1.0, 1.0, 1.0);
specularTextureValue = 1.0;
//#define#specularTexture# specularTextureValue = texture2D(u_specularTexture, vTexcoord).r;
for(int i=0; i<cDIRETIONAL_MAX; i++){
if(i == uDirectionalLightNum) break;
L = normalize(-uDirectionalLightPositionList[i]);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uDirectionalLightColorList[i] * texelColor * lambertTerm * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uDirectionalLightIntensityList[i] * uDirectionalLightColorList[i].a;
}
}
for(int i=0;i<cPOINT_MAX;i++){
if(i== uPointLightNum) break;
L =  -uPointLightPositionList[i] + vVertexPositionEye4.xyz;
distanceLength = length(L);
if(uPointLightRadiusList[i]> distanceLength){
attenuation = 1.0 / (0.01 + 0.02 * distanceLength + 0.03 * distanceLength * distanceLength);
L = normalize(L);
lambertTerm = dot(N,-L);
if(lambertTerm > 0.0){
ld += uPointLightColorList[i] * texelColor * lambertTerm * attenuation * uPointLightIntensityList[i] * uPointLightColorList[i].a;
specular = pow( max(dot(reflect(L, N), -L), 0.0), u_shininess);
ls +=  specularLightColor * specular * u_specularPower * specularTextureValue * uPointLightIntensityList[i]* uPointLightColorList[i].a ;
}
}
}
finalColor = la * uAmbientIntensity + ld + ls;
//#define#emissiveTexture# finalColor.rgb += emissiveColor.rgb;
finalColor.rgb *= texelColor.a;
finalColor.a = texelColor.a * u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/};var n={callback:function(){this._searchProgram("RedStandardMaterialProgram",i)}};(RedStandardMaterial=function(n,a,o,s,d,f){if(!(this instanceof RedStandardMaterial))return new RedStandardMaterial(n,a,o,s,d,f);n instanceof RedGL||RedGLUtil.throwFunc("RedStandardMaterial : RedGL Instance만 허용.",n),this.makeProgramList(this,n,"RedStandardMaterialProgram",e,t,i),this.diffuseTexture=a,this.normalTexture=o,this.specularTexture=s,this.emissiveTexture=f,this.displacementTexture=d,this.normalPower=1,this.shininess=16,this.specularPower=1,this.displacementPower=0,this.displacementFlowSpeedX=0,this.displacementFlowSpeedY=0,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedStandardMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","diffuseTexture","sampler2D",{essential:!0,callback:n.callback}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","emissiveTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementTexture","sampler2D",n),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","normalPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","shininess","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","specularPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementPower","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedX","number"),RedDefinePropertyInfo.definePrototype("RedStandardMaterial","displacementFlowSpeedY","number"),Object.freeze(RedStandardMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
vTexcoord = aTexcoord;
gl_PointSize = uPointSize;
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_videoTexture;
uniform float u_alpha;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = texture2D(u_videoTexture, vTexcoord);
finalColor.rgb *= finalColor.a;
if(finalColor.a ==0.0) discard;
finalColor.a = u_alpha;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedVideoMaterial=function(i,n){if(!(this instanceof RedVideoMaterial))return new RedVideoMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedVideoMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"RedVideoMaterialProgram",e,t),this.videoTexture=n,this.alpha=1,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedVideoMaterial","alpha","number",{min:0,max:1}),RedDefinePropertyInfo.definePrototype("RedVideoMaterial","videoTexture","samplerVideo",{essential:!0}),Object.freeze(RedVideoMaterial)}(),(RedAmbientLight=function(e,t,r){if(!(this instanceof RedAmbientLight))return new RedAmbientLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedAmbientLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?.1:r,this.color=t||"#fff",this._UUID=RedGL.makeUUID()}).TYPE="RedAmbientLight",RedAmbientLight.prototype=new RedBaseLight,Object.defineProperty(RedAmbientLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedAmbientLight.TYPE}),Object.freeze(RedAmbientLight),(RedDirectionalLight=function(e,t,r){if(!(this instanceof RedDirectionalLight))return new RedDirectionalLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=-1,this.z=0,this._UUID=RedGL.makeUUID(),this.debug=!1,this._debugObject=RedSprite3D(e,RedBitmapMaterial(e,RedBitmapTexture(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozQjcyMEREMTUyMDYxMUU4OTRDNTgzQTBBMEY2MkFFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDODA1NTI0RjUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDODA1NTI0RTUyMDYxMUU4QkVBQTg3NjZCN0M1OUI2OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNmFjYmZjZi05YjBkLThlNGItODZiNy1kNWViYWNjZDg4OGMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I3MjBERDE1MjA2MTFFODk0QzU4M0EwQTBGNjJBRTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4vVcpuAAAHNUlEQVR42uxbeWyURRT/tiw9OAJYUekfeBCFNmqlkAgRtURQaTywWIhGSfDAAzmkggcoKopKRQXFKKZqNGmkqGAkGEQFhaQenGrAI3iUpKilaiPSytKt74XfF6evM/vN7n67+xn6kl/Sb3bmvTdvZt68eTMNtbe3O8cyhboM0GWALgN0LKkJpUv2lYQFBFbgYcI7aZF6bcf+ZmXI8L0IlYShhBLCbELPTCiSKQOcTRimfA8nFP/fDTCEMJrQw2bpEVqV71ZLXXpARmHQDDCZ8DnhI8IrFkZoI0SVb/77iEXnX4WMzyAzEAbIJSwk9Mb3RMKMFMzWmYQK/N0bMnODYAB2q42i7B5CkY+dZ153i7JGyM64Af4hVIk13cdjFoQsy1yaAZ6qz6iC7ED4gJWEjaLsRkKpoX53MX1zUaajUvBSaSNkBmoXuI/QonyHCXMIeZq6PxJ+Vb5/I/ykqZcHHmGljGXcG8RtcCfhRVFWpjgulfahEzvQjn1GvaZeBXio9AJhV1ADoUcITaJsmKHuKvxWgr91NFx8N0FG2gOhbpb1WMGbxXRd6SE/lg61wrneRPjdT51tDkOTELe3YvrVWPC9CnH+h4SPlfKLCKMQChco/oEN1UD4krAF7Vy6EO14uay2kH0N4XZCDmFJpwEQhyEvAwxF1OV66MOEd8G4znIkuJNTCNcjhO3jUb+ZsIfwOqLKFks5IzFQlxOyURYhnAvjJXQa7Cu2J2Y8gbCBsJhwskf7SzCizxJGWHTejSFGoM0W8IhFA6HLBuiWLbbbvsn4gJ2GKd8T29NWeGodHx6NdXByWQn6pxLwqDT8XgEd5hiO0zXog5HCHkr8QbiO8AMOHwPF78fDUZWL9cmeep6B527CNsK3hAMKn8HYFYo0HX2S0I8wXyRUag0y6nFwWuBl5bDFSPCiuR/WvItwg6bO+YoB7jR0fjthBXxIg0FWAdbwVIy+SvOwyzytyNTRyzDYnlSlxEYh6hunePCLsV75t82aNrx7PCiiv1h0IurfajC2K+t9ZSd5j7AIv1mnxBLNCXJK61KMEiuxCdvOds0U5o48lGCcsgDt5RIqwUGoFMbfAQMcjDcn6GdSlPfe5aJsKWFWksHaM8gFqDSN8HxC3FKUFM3CulXpa2xPydJi8FJpql+6+2WACwiDNCPX4APvBvBSaRBkBsYAY+AXXOItbo2PZ5Y14Kn6oDF+MA7HyPMVI5I6IrI2XPY9Yb9SfpZoX6c5FSZDTeA5OIZM3jnOgL7t4lDUhiN0i40BLkNkVYjGUc0pqxGxQS1m0QBR5xvHf5I8B0A268eJWL5d6q/RNwSD7EYaba2XAZZrIj5J/bA9rYbFszUj5jdJntnoWHfoMtjCT50iDZCpm6HAkG4GTMMSKFKmjzRaI6wewfdhUSc/BbpKnoehXwS6LMQSaNPo24bQuMrGAGuRkChWHIi6nrjNd0pYGxUOkWlICgwgee5X1nstQvDTYZB20ccInGCr7S7A3vLTOJT7inCFSE7k++gL8sFTypQG2Z+pOOADEYezQxrv4+iPF07uIGQGJhD6hLBXlM3C8TZZKtCcJ/ZCZmAMEMVZX6UzCXN94D0XvFRaodnv02qAXkhHLXL+u/6qRrCh0kybrIzHcXim5jhcjb9LocPVIhS3pmM+IRLPDCiE5TcrnXegQDn+ZuGzNW25I5zcvMXDLxSgzjpD52crHSx3Ot47joNu1U4cL0hsZkAIcfbkGCFyKpOiLj3qdEyK8uXL24a65qRonBkhjvmf42YGQQeQCXpL45QqkcxI1tFG4QiXaPzXBJxd+hvaciL3DudodjuhJXCOofN/I6zky8tVBo/MCvPN7vYEPXYUbcs0nXd/XwUdqqBTp/FGHxLeBf5EGOkSJyLfJIzFqPzs0X49nNV0RJbNFh1vRt3paLveo349dBmLmaieSyLoQ1I+QL0c5UTkGxad4PVZgmjNj8vRMfAbNlkmvhy9DUmdpC9H1ZliO41V59SKkTFtTe4Vdpvh9/NgxFyFt22qrZuWb4LboG3n+dDykkitTfTgG4v3JKfjW6LqOI7abekMhV2ar1Fwq6FuBZzcNkf/jEbX9jixFSZNfl6McP6gTgQn6xCmymQkxxP80us05XDDT2D3iXp5cLpl4qg+0kn0nVAKX4s/Jjp/BNuT7oED5+ZOEKHvqYa8RJXTMTOdB1m+kF8GmIQRdMR63WSoH3E6P5aOGOpuUg4/Lo2GzEAYIAc5xFyxly+L0abdssylZSKGyIXMnCAYIKQJRZ/QHI2TIeb1uCjr74f+fhiApy9fkvyFbw5Plzr+E88C90UIy3rAsX9AZaSwT8q9RviCcJJz9FXZIQu5WWIgvN71Mc8pyC384li+AEmXARwoZKtU1On8WNrm6fshp/Oj7EDsAvHSLhHkbMM5IO0UzpAB+Oj6FPJ4IRxaDmZCka5/nOwyQJcBjm0D/CvAAF/S81D+EWScAAAAAElFTkSuQmCC")))}).TYPE="RedDirectionalLight",RedDirectionalLight.prototype=new RedBaseLight,Object.defineProperty(RedDirectionalLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedDirectionalLight.TYPE}),Object.freeze(RedDirectionalLight),(RedPointLight=function(e,t,r){if(!(this instanceof RedPointLight))return new RedPointLight(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedPointLight : RedGL Instance만 허용.","입력값 : "+e),this._lightColor=new Float32Array(4),this.intensity=1,this.alpha=void 0==r?1:r,this.color=t||"#fff",this.x=0,this.y=0,this.z=0,this.radius=1,this.debug=!1,this._debugObject=RedMesh(e,RedSphere(e,1,16,16,16),RedColorMaterial(e)),this._debugObject.drawMode=e.gl.LINE_STRIP,this._UUID=RedGL.makeUUID()}).TYPE="RedPointLight",RedPointLight.prototype=new RedBaseLight,Object.defineProperty(RedPointLight.prototype,"TYPE",{configurable:!1,writable:!1,value:RedPointLight.TYPE}),RedDefinePropertyInfo.definePrototype("RedPointLight","radius","number",{min:0}),Object.freeze(RedPointLight),JsonModelLoader=function(e,t,r,i){if(!(this instanceof JsonModelLoader))return new JsonModelLoader(e,t,r,i);var n=new XMLHttpRequest;n.open("GET",r,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.onreadystatechange=function(){if(4==n.readyState){var r,a,o,s;for(a=[],o=0,s=(r=JSON.parse(n.responseText)).position.length/3;o<s;o++)a.push(r.position[3*o],r.position[3*o+1],r.position[3*o+2]),a.push(r.normal[3*o],r.normal[3*o+1],r.normal[3*o+2]),r.uvs?a.push(r.uvs[2*o],r.uvs[2*o+1]):a.push(0,0);i&&i(RedBuffer(e,t,RedBuffer.ARRAY_BUFFER,new Float32Array(a),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),RedBuffer(e,t,RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.index)))}},n.send()},Object.freeze(JsonModelLoader),function(){var e,t;t=function(){},RedMTLLoader=function(r,i,n,a){if(!(this instanceof RedMTLLoader))return new RedMTLLoader(r,i,n,a);var o=this,s=new XMLHttpRequest;s.open("GET",i+n,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),s.onreadystatechange=function(){if(4==s.readyState){var i;if(o.complete=!0,200==s.status)i=e(o,r,s.responseText),o.parseData=i;else o.parseData=new t;a&&a(o.parseData)}},s.addEventListener("error",function(e){}),s.send(),this.path=i,this.fileName=n,this.complete=!1,this.parseData=null},e=function(e,r,i){var n,a,o,s,d,f,c,u,l,h,R,m,p,_;for(var P in n={},o=/^(newmtl )/,s=/^(Ns )/,d=/^(Ka )/,f=/^(Kd )/,c=/^(Ks )/,u=/^(Ni )/,l=/^(d )/,h=/^(illum )/,R=/^(map_Kd )/,/^(map_Ks )/,m=/^(map_Ns )/,p=/^(map_bump )/,(i=i.replace(/^\#[\s\S]+?\n/g,"")).split("\n").forEach(function(t){var r;o.test(t)?(r=t.replace("newmtl ","").trim(),_={name:r},n[r]=_):d.test(t)?_.Ka=t.replace("Ka ","").split(" "):f.test(t)?_.Kd=t.replace("Kd ","").split(" "):c.test(t)?_.Ks=t.replace("Ks ","").split(" "):s.test(t)?_.Ns=+t.replace("Ns ",""):u.test(t)?_.Ni=+t.replace("Ni ",""):l.test(t)?_.d=+t.replace("d ",""):h.test(t)?(_.illum=+t.replace("illum ",""),_.illum):R.test(t)?_.map_Kd=e.path+t.replace("map_Kd ",""):m.test(t)?_.map_Ns=e.path+t.replace("map_Ns ",""):p.test(t)&&(_.map_bump=e.path+t.replace("map_bump ","").split(" ")[2])}),a=new t,n)a[P]=n[P];return a},Object.freeze(RedMTLLoader)}(),function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R;RedOBJLoader=function(t,r,i,n){if(!(this instanceof RedOBJLoader))return new RedOBJLoader(t,r,i,n);var a=this,o=new XMLHttpRequest;o.open("GET",r+i,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onreadystatechange=function(){4==o.readyState&&(a.result=e(a,t,o.responseText),a.modelParsingComplete=!0,a.resultMesh=void 0,n&&(a.mtlLoader?a.mtlLoader.complete&&n(a.result):n(a.result)))},o.send(),this.path=r,this.fileName=i,this.mtlLoader=null,this.modelParsingComplete=!1,this.callback=n,this.resultMesh=RedMesh(t),this.resultMesh.name="instanceOfRedOBJLoader_"+RedGL.makeUUID(),this.result=null},r=function(e,t,r){var i,n,a,o;for(i in o={},t){var s,d,f,c,u,l;if((a=t[i]).mesh,a.use&&a.resultInterleave.length)l=a.ableLight,(n=r.parseData[a.materialKey])&&(n.map_Kd?(o[n.map_Kd]?d=o[n.map_Kd]:(d=RedBitmapTexture(e,n.map_Kd),o[n.map_Kd]=d),s=l?RedStandardMaterial(e,d):RedBitmapMaterial(e,d)):n.Kd&&(f=255*n.Kd[0],c=255*n.Kd[1],u=255*n.Kd[2],s=l?RedColorPhongTextureMaterial(e,RedGLUtil.rgb2hex(f,c,u)):a.ableNormal?RedColorPhongMaterial(e,RedGLUtil.rgb2hex(f,c,u)):RedColorMaterial(e,RedGLUtil.rgb2hex(f,c,u))),s&&(n.map_Ns&&(o[n.map_Ns]?d=o[n.map_Ns]:(d=RedBitmapTexture(e,n.map_Ns),o[n.map_Ns]=d),s.specularTexture=d),n.map_bump&&(o[n.map_bump]?d=o[n.map_bump]:(d=RedBitmapTexture(e,n.map_bump),o[n.map_bump]=d),s.normalTexture=d),void 0!=n.Ns&&(s.shininess=n.Ns),a.mesh.material=s))}},t=function(e,r,i){for(var n in i){var a,o;if((a=i[n]).use){var s,d,f,c=[];a.resultPosition.length&&c.push(RedInterleaveInfo("aVertexPosition",3)),a.resultNormal.length&&c.push(RedInterleaveInfo("aVertexNormal",3)),a.resultUV.length&&c.push(RedInterleaveInfo("aTexcoord",2)),s=RedBuffer(e,n+"_interleave",RedBuffer.ARRAY_BUFFER,new Float32Array(a.resultInterleave.length?a.resultInterleave:a.resultPosition),c),a.index.length&&a.index.length&&(d=RedBuffer(e,n+"_index",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.index))),f=a.resultUV.length&&a.resultNormal.length?RedColorPhongTextureMaterial(e,"#00ff00"):a.resultNormal?RedColorPhongMaterial(e,"#00ff00"):RedColorMaterial(e,"#0000ff"),o=RedMesh(e,RedGeometry(s,d),f),a.ableUV=!!a.resultUV.length,a.ableNormal=!!a.resultNormal.length,a.ableLight=!!(a.ableUV&a.ableNormal)}else o=RedMesh(e);o.name=n,a.mesh=o,r.addChild(o),t(e,o,a.childrenInfo)}},h=/^(mtllib )/,R=/^(usemtl )/,n=/^o /,a=/^g /,o=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,s=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,d=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,f=/f\s+(([\d]{1,}[\s]?){3,})+/,c=/f\s+((([\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,u=/f\s+((([\d]{1,}\/[\d]{1,}\/[\d]{1,}[\s]?){3,})+)/,l=/f\s+((([\d]{1,}\/\/[\d]{1,}[\s]?){3,})+)/,i=function(e,t,i){var m,p,_,P,g,E,y,M,T,b;for(_={position:[],normal:[],uv:[],points:[],normalPoints:[],uvPoints:[]},p={},m={},y=i.length;y--;)if(n.test(i[y])){M=!0;break}return M||(b={name:T="objModel"+RedGL.makeUUID(),groupName:T,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[T]=P=b,m[T]=P,g=T),i.forEach(function(i){if(h.test(i))return E=RedMTLLoader(e,t.path,i.split(" ")[1],function(i){t.mtlLoader=i,t.modelParsingComplete&&t.callback&&(r(e,m,E),t.callback(t.result))}),void(t.mtlLoader=E);var y;if(R.test(i))M=i.split(" ").slice(1).join("").trim(),m[g].materialKey=M;else if(a.test(i))M=i.split(" ").slice(1).join("").trim(),p[g].use=!1,T={name:M,groupName:g,materialKey:M.replace(g+"_",""),index:[],position:P.position,resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},m[M]=P=T,p[g].childrenInfo[M]=P;else if(n.test(i)){var M,T;T={name:M=i.split(" ").slice(1).join("").trim(),groupName:M,materialKey:M,index:[],position:[],resultPosition:[],resultNormal:[],resultUV:[],resultInterleave:[],use:!0,childrenInfo:{}},p[M]=P=T,m[M]=P,g=M}if(o.test(i))y=i.split(" "),_.position.push(+y[1],+y[2],+y[3]),P.position.push(+y[1],+y[2],+y[3]),_.points[_.points.length]=[+y[1],+y[2],+y[3]];else if(s.test(i)){var b;b=i.split(" "),_.normal.push(+b[1],+b[2],+b[3]),_.normalPoints[_.normalPoints.length]=[+b[1],+b[2],+b[3]]}else if(d.test(i)){var v;v=i.split(" "),_.uv.push(+v[1],+v[2]),_.uvPoints[_.uvPoints.length]=[+v[1],+v[2]]}else if(l.test(i))(w=i.split(" ").slice(1,4)).forEach(function(e){var t,r,i;i=0,e=e.split("/"),D=+e[0]-1,L=+e[2]-1,t=_.points[D],r=_.normalPoints[L],_.position.length&&(i+=3),_.normal.length&&(i+=3),P.index.push(P.resultInterleave.length/i),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.normal.length&&(P.resultNormal.push(r[0],r[1],r[2]),P.resultInterleave.push(r[0],r[1],r[2]))});else if(u.test(i)){var L;if(4==(w=i.split(" ").slice(1,5)).length){var x=w[3];w[3]=w[0],w[4]=w[2],w[5]=x}w.forEach(function(e){var t,r,i,n;n=0,e=e.split("/"),D=+e[0]-1,U=+e[1]-1,L=+e[2]-1,t=_.points[D],i=_.uvPoints[U],r=_.normalPoints[L],_.position.length&&(n+=3),_.normal.length&&(n+=3),_.uv.length&&(n+=2),P.index.push(P.resultInterleave.length/n),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.normal.length&&(P.resultNormal.push(r[0],r[1],r[2]),P.resultInterleave.push(r[0],r[1],r[2])),_.uv.length&&(P.resultUV.push(i[0],i[1]),P.resultInterleave.push(i[0],i[1]))})}else if(c.test(i)){var w,U;(w=i.split(" ").slice(1,4)).forEach(function(e){var t,r,i;i=0,e=e.split("/"),D=+e[0]-1,U=+e[1]-1,t=_.points[D],r=_.uvPoints[U],_.position.length&&(i+=3),_.uv.length&&(i+=2),P.index.push(P.resultInterleave.length/i),_.position.length&&(P.resultPosition.push(t[0],t[1],t[2]),P.resultInterleave.push(t[0],t[1],t[2])),_.uv.length&&(P.resultUV.push(r[0],r[1]),P.resultInterleave.push(r[0],r[1]))})}else if(f.test(i)){var D;D=i.split(" "),P.resultInterleave=P.resultPosition=P.position,P.index.push(+D[1]-1,+D[2]-1,+D[3]-1),P.index.push(+D[1]-1,+D[3]-1,+D[4]-1)}}),{info:m,infoHierarchy:p}},e=function(e,r,n){n=n.replace(/^\#[\s\S]+?\n/g,"");var a=i(r,e,n.split("\n"));return t(r,e.resultMesh,a.infoHierarchy),new function(e){for(var t in e)this[t]=e[t]}({fileName:e.fileName,path:e.path,resultMesh:e.resultMesh,parseRawInfo:a.info,parseInfoHierarchy:a.infoHierarchy,parseInfoMaterial:e.mtlLoader})},Object.freeze(RedOBJLoader)}(),(RedAxis=function(e){if(!(this instanceof RedAxis))return new RedAxis(e);var t,r,i,n,a,o;e instanceof RedGL||RedGLUtil.throwFunc("RedAxis : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),i=RedBox(e),n=RedColorMaterial(e,"#ff0000"),a=RedColorMaterial(e,"#00ff00"),o=RedColorMaterial(e,"#0000ff"),t=RedMesh(e,i,n),(r=RedMesh(e,i,n)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleX=10,t.x=5,r.x=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,i,a),(r=RedMesh(e,i,a)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleY=10,t.y=5,r.y=-5,t.children.push(r),this.children.push(t),t=RedMesh(e,i,o),(r=RedMesh(e,i,o)).scaleX=r.scaleY=r.scaleZ=.5,r.scaleZ=10,t.z=5,r.z=-5,t.children.push(r),this.children.push(t),this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedAxis),function(){var e,t,r,i,n,a;(RedGrid=function(e,t,r,i,n){if(!(this instanceof RedGrid))return new RedGrid(e,t,r,i,n);var a;e instanceof RedGL||RedGLUtil.throwFunc("RedGrid : RedGL Instance만 허용.",e),a=e.gl,RedBaseObject3D.build.call(this,a),this._redGL=e,this.size=t||100,this.divisions=r||100,this.color1=i||"#cccccc",this.color2=n||"#666666",this.geometry=this._makeGridGeometry(),this.material=RedGridMaterial(e),this.drawMode=a.LINES,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,RedGrid.prototype._makeGridGeometry=function(){if(this.color2){var o=[];for(e=this._divisions/2,t=this._size/this._divisions,r=this._size/2,i=0,n=-r;i<=this._divisions;i++,n+=t)a=i===e?RedGLUtil.hexToRGB_ZeroToOne(this.color1):RedGLUtil.hexToRGB_ZeroToOne(this.color2),o.push(-r,0,n,a[0],a[1],a[2],1,r,0,n,a[0],a[1],a[2],1,n,0,-r,a[0],a[1],a[2],1,n,0,r,a[0],a[1],a[2],1);return RedGeometry(RedBuffer(this._redGL,"gridInterleaveBuffer_"+this._size+"_"+this._divisions+"_"+this.color1+"_"+this.color2,RedBuffer.ARRAY_BUFFER,new Float32Array(o),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexColor",4)]))}},RedGrid.prototype._update=function(){this.geometry=this._makeGridGeometry()},RedDefinePropertyInfo.definePrototype("RedGrid","size","number",{min:1,callback:function(){this._update()}}),RedDefinePropertyInfo.definePrototype("RedGrid","divisions","number",{min:1,callback:function(){this._update()}}),Object.defineProperty(RedGrid.prototype,"color1",{get:function(){return this._color1},set:function(e){return RedGLUtil.regHex(e)||RedGLUtil.throwFunc("RedGrid : color1 hex 형식만 허용.",e),this._color1=e,this._update(),this._color1}}),Object.defineProperty(RedGrid.prototype,"color2",{get:function(){return this._color2},set:function(e){return RedGLUtil.regHex(e)||RedGLUtil.throwFunc("RedGrid : color2 hex 형식만 허용.",e),this._color2=e,this._update(),this._color2}}),Object.defineProperty(RedGrid.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedGridMaterial||RedGLUtil.throwFunc("RedGrid : RedGridMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedGrid)}(),(RedMesh=function(e,t,r){if(!(this instanceof RedMesh))return new RedMesh(e,t,r);e instanceof RedGL||RedGLUtil.throwFunc("RedMesh : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=t,this.material=r,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,Object.freeze(RedMesh),(RedLine=function(e,t){if(!(this instanceof RedLine))return new RedLine(e,t);var r;e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용.",e),(t=t||RedColorMaterial(e))instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용."),r=e.gl,RedBaseObject3D.build.call(this,r),this._interleaveData=[],this._indexData=[],this._UUID=RedGL.makeUUID(),this._interleaveBuffer=RedBuffer(e,"RedLine_InterleaveBuffer_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(this._interleaveData),[RedInterleaveInfo("aVertexPosition",3)]),this.geometry=RedGeometry(this._interleaveBuffer),this.material=t,this.drawMode=r.LINE_STRIP}).prototype=new RedBaseContainer,RedLine.prototype.addPoint=function(e,t,r){"number"==typeof e||RedGLUtil.throwFunc("RedLine : addPoint - x값은 숫자만 허용","입력값 : "+e),"number"==typeof t||RedGLUtil.throwFunc("RedLine : addPoint - y값은 숫자만 허용","입력값 : "+t),"number"==typeof r||RedGLUtil.throwFunc("RedLine : addPoint - z값은 숫자만 허용","입력값 : "+r),this._interleaveData.push(e,t,r),this._upload()},RedLine.prototype.removeAllPoint=function(){this._interleaveData.length=0,this._upload()},RedLine.prototype._upload=function(){this._interleaveBuffer.upload(new Float32Array(this._interleaveData))},Object.defineProperty(RedLine.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedLine : geometry - 임의로 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedLine.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedColorMaterial||RedGLUtil.throwFunc("RedLine : RedColorMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedLine),(RedSkyBox=function(e,t){if(!(this instanceof RedSkyBox))return new RedSkyBox(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedSkyBox : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=RedBox(e),this.material=RedSkyBoxMaterial(e,RedBitmapCubeTexture(e,t)),this.cullFace=e.gl.FRONT,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseObject3D,Object.defineProperty(RedSkyBox.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedSkyBox : geometry - 임의로 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedSkyBox.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedSkyBoxMaterial||RedGLUtil.throwFunc("RedSkyBox : RedSkyBoxMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedSkyBox),(RedSprite3D=function(e,t){if(!(this instanceof RedSprite3D))return new RedSprite3D(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedSprite3D : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl),this.geometry=RedPlane(e,1,1,0),this.material=t,this.perspectiveScale=!0,this.sprite3DYn=!0,this.useCullFace=!1,this._UUID=RedGL.makeUUID()}).prototype=new RedBaseContainer,RedDefinePropertyInfo.definePrototype("RedSprite3D","perspectiveScale","boolean",!0),RedDefinePropertyInfo.definePrototype("RedSprite3D","sprite3DYn","boolean",!0),Object.defineProperty(RedSprite3D.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedColorMaterial||e instanceof RedBitmapMaterial||e instanceof RedSheetMaterial||e instanceof RedVideoMaterial||RedGLUtil.throwFunc("RedSprite3D : RedColorMaterial or RedBitmapMaterial or RedSheetMaterial Instance만 허용.","입력값 : "+e),this._material=e}}),Object.freeze(RedSprite3D),(RedPointUnit=function(e,t,r,i){if(!(this instanceof RedPointUnit))return new RedPointUnit(e,t,r,i);var n;t instanceof Array||RedGLUtil.throwFunc("RedLine : interleaveData - Array Instance만 허용.","입력값 :",e),e instanceof RedGL||RedGLUtil.throwFunc("RedLine : RedGL Instance만 허용.",e),n=e.gl,RedBaseObject3D.build.call(this,n),this._UUID=RedGL.makeUUID(),this.geometry=RedGeometry(RedBuffer(e,"RedPointUnit_"+this._UUID,RedBuffer.ARRAY_BUFFER,new Float32Array(t),r,e.gl.DYNAMIC_DRAW)),this.material=i,this.drawMode=n.POINTS,this.useDepthMask=!1}).prototype=new RedBaseContainer,RedPointUnit.prototype.update=function(e){this._geometry.interleaveBuffer.upload(new Float32Array(e))},Object.defineProperty(RedPointUnit.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedPointUnit : geometry - 임의 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedPointUnit.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedPointColorMaterial||e instanceof RedPointBitmapMaterial||RedGLUtil.throwFunc("RedPointUnit : material - RedPointColorMaterial Instance or RedPointBitmapMaterial Instance만 허용."),this._material=e}}),Object.freeze(RedPointUnit),(RedParticleUnit=function(e){this.startTime=null,this.age=0,this.lifeTime=2==e.length?Math.random()*(e[1]-e[0])+e[0]:e[0],this.initLifeTime=this.lifeTime,this._gravitySum=0}).prototype.addRule=function(e,t){this[e]={startCenter:null,start:2==t.start.length?Math.random()*(t.start[1]-t.start[0])+t.start[0]:t.start,end:2==t.end.length?Math.random()*(t.end[1]-t.end[0])+t.end[0]:t.end,ease:t.ease},this[e].gap=this[e].end-this[e].start},Object.freeze(RedParticleUnit),(RedParticleEmitter=function(e,t,r){if(!(this instanceof RedParticleEmitter))return new RedPointUnit(e,r);RedBaseObject3D.build.call(this,e.gl),this.list=[],this._interleaveData=[],this.info=t,this.geometry=RedGeometry(RedBuffer(e,"RedParticleEmitter_Buffer"+RedGL.makeUUID(),RedBuffer.ARRAY_BUFFER,new Float32Array(this._interleaveData),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aPointSize",1),RedInterleaveInfo("aVertexColor",4)],e.gl.DYNAMIC_DRAW)),this.material=r,this.drawMode=e.gl.POINTS,this.blendSrc=e.gl.SRC_ALPHA,this.blendDst=e.gl.ONE,this.useDepthMask=!1,this._UUID=RedGL.makeUUID()}).QuintIn=1,RedParticleEmitter.QuintOut=2,RedParticleEmitter.QuintInOut=3,RedParticleEmitter.BackIn=4,RedParticleEmitter.BackOut=5,RedParticleEmitter.BackInOut=6,RedParticleEmitter.CircIn=7,RedParticleEmitter.CircOut=8,RedParticleEmitter.CircInOut=9,RedParticleEmitter.CubicIn=10,RedParticleEmitter.CubicOut=11,RedParticleEmitter.CubicInOut=12,RedParticleEmitter.ExpoIn=13,RedParticleEmitter.ExpoOut=14,RedParticleEmitter.ExpoInOut=15,RedParticleEmitter.QuadIn=16,RedParticleEmitter.QuadOut=17,RedParticleEmitter.QuadInOut=18,RedParticleEmitter.QuartIn=19,RedParticleEmitter.QuartOut=20,RedParticleEmitter.QuartInOut=21,RedParticleEmitter.SineIn=22,RedParticleEmitter.SineOut=23,RedParticleEmitter.SineInOut=24,RedParticleEmitter.ElasticIn=25,RedParticleEmitter.ElasticOut=26,RedParticleEmitter.ElasticInOut=27,RedParticleEmitter.prototype=new RedBaseContainer,RedParticleEmitter.prototype.update=function(e){var t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E;if(t=Math.pow,r=Math.sin,i=Math.cos,n=Math.sqrt,s=.5*(a=Math.PI),o=2*a,d=this.list.length,R=(h=this.info).particle,d<h.max)for((f=h.emitCount)+d>h.max&&(f=h.max-d);f--;)m=this.list[d+f]=new RedParticleUnit(h.lifeTime),this._interleaveData.push(this.x,this.y,this.z),this._interleaveData.push(0),"random"==h.tint?this._interleaveData.push(Math.random(),Math.random(),Math.random(),1):this._interleaveData.push(h.tint[0],h.tint[1],h.tint[2],1),h.particle&&(R.movementX&&m.addRule("movementX",R.movementX),R.movementY&&m.addRule("movementY",R.movementY),R.movementZ&&m.addRule("movementZ",R.movementZ),R.scale&&m.addRule("scale",R.scale),R.alpha&&m.addRule("alpha",R.alpha));for(d=this.list.length;d--;)if((c=this.list[d]).startTime||(c.startTime=e,c.age=0),c.age=e-c.startTime,l=8*d,(u=c.age/c.lifeTime)<1)for(E=u,c.startCenter||(c.startCenter=[this.x,this.y,this.z]),f=(_="movementX,movementY,movementZ,scale,alpha".split(",")).length;f--;)E=u,(p=c[P=_[f]].ease)&&(1==p?E*=E*E*E*E:2==p?E=(E-=1)*E*E*E*E+1:3==p?E=(E*=2)<1?E*E*E*E*E*.5:.5*((E-=2)*E*E*E*E+2):4==p?E=E*E*(1.70158*E+E-1.70158):5==p?E=(E-=1)*E*(1.70158*E+E+1.70158)+1:6==p?E=(E*=2)<1?.5*E*E*(1.70158*E+E-1.70158):.5*(E-=2)*E*(1.70158*E+E+1.70158)+1:7==p?E=-1*(n(1-E*E)-1):8==p?E=n(1-(E-=1)*E):9==p?E=(E*=2)<1?-.5*(n(1-E*E)-1):.5*n(1-(E-=2)*E)+.5:10==p?E*=E*E:11==p?E=(E-=1)*E*E+1:12==p?E=(E*=2)<1?E*E*E*.5:.5*((E-=2)*E*E+2):13==p?E=0==E?0:t(2,10*(E-1)):14==p?E=1==E?1:1-t(2,-10*E):15==p?E=(E*=2)<1?0==E?0:.5*t(2,10*(E-1)):2==E?1:-.5*t(2,-10*(E-1))+1:16==p?E*=E:17==p?E*=2-E:18==p?E=(E*=2)<1?E*E*.5:.5*((2-(E-=1))*E+1):19==p?E*=E*E*E:20==p?E=1-(E-=1)*E*E*E:21==p?E=(E*=2)<1?E*E*E*E*.5:1-(E-=2)*E*E*E*.5:22==p?E=1-i(E*s):23==p?E=r(E*s):24==p?E=.5*(1-i(E*a)):25==p?E=0===E?0:1===E?1:-1*t(2,10*(E-=1))*r((E-.075)*o/.3):26==p?E=0===E?0:1===E?1:t(2,-10*E)*r((E-.075)*o/.3)+1:27==p&&(0===E||1===E||(E*=2),E=E<1?-.5*t(2,10*(E-=1))*r((E-.075)*o/.3):.5*t(2,-10*(E-=1))*r((E-.075)*o/.3)+1)),"movementX"==P&&(g=0),"movementY"==P&&(g=1),"movementZ"==P&&(g=2),"scale"==P&&(g=3),"alpha"==P&&(g=7),this._interleaveData[l+g]=g<3?c.startCenter[g]+c[P].start+c[P].gap*E:c[P].start+c[P].gap*E,h.gravity&&(c._gravitySum-=h.gravity),this._interleaveData[l+1]+=c._gravitySum;else this._interleaveData[l+0]=c.startCenter[0]=this.x,this._interleaveData[l+1]=c.startCenter[1]=this.y,this._interleaveData[l+2]=c.startCenter[2]=this.z,this._interleaveData[l+3]=c.scale.start,"random"==h.tint?(this._interleaveData[l+4]=Math.random(),this._interleaveData[l+5]=Math.random(),this._interleaveData[l+6]=Math.random()):(this._interleaveData[l+4]=h.tint[0],this._interleaveData[l+5]=h.tint[1],this._interleaveData[l+6]=h.tint[2]),this._interleaveData[l+7]=c.alpha.start,c._gravitySum=0,c.startTime=null,c.age=-1;this._geometry.interleaveBuffer.upload(new Float32Array(this._interleaveData))},Object.defineProperty(RedParticleUnit.prototype,"geometry",{get:function(){return this._geometry},set:function(e){this._geometry&&RedGLUtil.throwFunc("RedParticleUnit : geometry - 임의 설정을 허용하지 않음","입력값 : "+e),this._geometry=e}}),Object.defineProperty(RedParticleUnit.prototype,"material",{get:function(){return this._material},set:function(e){e instanceof RedParticleColorMaterial||e instanceof RedParticleBitmapMaterial||RedGLUtil.throwFunc("RedParticleEmitter : material - RedParticleColorMaterial Instance or RedParticleBitmapMaterial Instance만 허용."),this._material=e}}),Object.freeze(RedParticleEmitter),function(){var e,t,r;r=function(e,r,i,n,a,o,s,d,f,c,u,l){var h,R,m=d/u,p=f/l,_=d/2,P=f/2,g=c/2,E=u+1,y=l+1,M=0,T=[];for(R=0;R<y;R++){var b=R*p-P;for(h=0;h<E;h++){var v=h*m-_;T[i]=v*o,T[n]=b*s,T[a]=g,e.push(T.x,T.y,T.z),T[i]=0,T[n]=0,T[a]=c>0?1:-1,e.push(T.x,T.y,T.z),e.push(h/u,1-R/l),M+=1}}for(R=0;R<l;R++)for(h=0;h<u;h++){var L=t+h+E*R,x=t+h+E*(R+1),w=t+(h+1)+E*(R+1),U=t+(h+1)+E*R;r.push(L,x,U,x,w,U),6}t+=M},e=function(e,i,n,a,o,s,d,f){var c=[],u=[];return t=0,r(c,u,"z","y","x",-1,-1,o,a,n,f,d),r(c,u,"z","y","x",1,-1,o,a,-n,f,d),r(c,u,"x","z","y",1,1,n,o,a,s,f),r(c,u,"x","z","y",1,-1,n,o,-a,s,f),r(c,u,"x","y","z",1,-1,n,a,o,s,d),r(c,u,"x","y","z",-1,-1,n,a,-o,s,d),{interleaveData:c,indexData:u,type:i,interleaveBuffer:RedBuffer(e,i+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(c),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,i+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(u))}},(RedBox=function(t,r,i,n,a,o,s){return this instanceof RedBox?(t instanceof RedGL||RedGLUtil.throwFunc("RedBox : RedGL Instance만 허용.",t),d="RedBox_"+(r=r||1)+"_"+(i=i||1)+"_"+(n=n||1)+"_"+(a=a||1)+"_"+(o=o||1)+"_"+(s=s||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[d]?t._datas.Primitives[d]:(t._datas.Primitives[d]=this,f=e(t,d,r,i,n,a,o,s),this.interleaveBuffer=f.interleaveBuffer,this.indexBuffer=f.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedBox(t,r,i,n,a,o,s);var d,f}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedBox)}(),function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p;e=function(e,_,P,g,E,y){t=P/2,r=g/2,i=Math.floor(E)||1,n=Math.floor(y)||1,a=i+1,o=n+1,s=P/i,d=g/n;var M=[],T=[];for(c=0;c<o;c++)for(l=c*d-r,f=0;f<a;f++)u=f*s-t,M.push(u,-l,0,0,0,1,f/i,1-c/n);for(c=0;c<n;c++)for(f=0;f<i;f++)h=f+a*c,R=f+a*(c+1),m=f+1+a*(c+1),p=f+1+a*c,T.push(h,R,p,R,m,p);return{interleaveData:M,indexData:T,type:_,interleaveBuffer:RedBuffer(e,_+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(M),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,_+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint32Array(T))}},(RedPlane=function(t,r,i,n,a){return this instanceof RedPlane?(t instanceof RedGL||RedGLUtil.throwFunc("RedPlane : RedGL Instance만 허용.",t),o="RedPlane_"+(r=r||1)+"_"+(i=i||1)+"_"+(n=n||1)+"_"+(a=a||1),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[o]?t._datas.Primitives[o]:(t._datas.Primitives[o]=this,s=e(t,o,r,i,n,a),this.interleaveBuffer=s.interleaveBuffer,this.indexBuffer=s.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedPlane(t,r,i,n,a);var o,s}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedPlane)}(),function(){var e,t,r,i,n,a,o,s,d,f,c,u;f=[],c=new Float32Array([0,0,0]),u=new Float32Array([0,0,0]),e=function(e,l,h,R,m,p,_,P,g){t=P+g,n=0,f.length=0,c[0]=0,c[1]=0,c[2]=0,u[0]=0,u[1]=0,u[2]=0;var E=[],y=[];for(i=0;i<=m;i++){var M=[],T=i/m;for(r=0;r<=R;r++){var b=r/R;c.x=-h*Math.cos(p+b*_)*Math.sin(P+T*g),c.y=h*Math.cos(P+T*g),c.z=h*Math.sin(p+b*_)*Math.sin(P+T*g),E.push(c.x,c.y,c.z),u[0]=c.x,u[1]=c.y,u[2]=c.z,vec3.normalize(u,u),E.push(u[0],u[1],u[2]),E.push(b,1-T),M.push(n++)}f.push(M)}for(i=0;i<m;i++)for(r=0;r<R;r++)a=f[i][r+1],o=f[i][r],s=f[i+1][r],d=f[i+1][r+1],(0!==i||P>0)&&y.push(a,o,d),(i!==m-1||t<Math.PI)&&y.push(o,s,d);return{interleaveData:E,indexData:y,type:l,interleaveBuffer:RedBuffer(e,l+"_interleaveBuffer",RedBuffer.ARRAY_BUFFER,new Float32Array(E),[RedInterleaveInfo("aVertexPosition",3),RedInterleaveInfo("aVertexNormal",3),RedInterleaveInfo("aTexcoord",2)]),indexBuffer:RedBuffer(e,l+"_indexBuffer",RedBuffer.ELEMENT_ARRAY_BUFFER,new Uint16Array(y))}},(RedSphere=function(t,r,i,n,a,o,s,d){return this instanceof RedSphere?(t instanceof RedGL||RedGLUtil.throwFunc("RedPrimitive : RedGL Instance만 허용.",t),f="RedSphere_"+(r=r||1)+"_"+(i=Math.max(3,Math.floor(i)||8))+"_"+(n=Math.max(2,Math.floor(n)||6))+"_"+(a=void 0!==a?a:0)+"_"+(o=void 0!==o?o:2*Math.PI)+"_"+(s=void 0!==s?s:0)+"_"+(d=void 0!==d?d:Math.PI),t._datas.Primitives||(t._datas.Primitives={}),t._datas.Primitives[f]?t._datas.Primitives[f]:(t._datas.Primitives[f]=this,c=e(t,f,r,i,n,a,o,s,d),this.interleaveBuffer=c.interleaveBuffer,this.indexBuffer=c.indexBuffer,void(this._UUID=RedGL.makeUUID()))):new RedSphere(t,r,i,n,a,o,s,d);var f,c}).prototype=Object.create(RedGeometry.prototype),Object.freeze(RedSphere)}(),function(){var e,t,r,i,n,a,o,s,d,f,c;r=2,e=function(e,t,r,i){if(n=e.createProgram(),e.attachShader(n,r.webglShader),e.attachShader(n,i.webglShader),r.parseData.uniform)for(s in a=r.parseData.uniform.map,o=i.parseData.uniform.map,a)o[s]&&RedGLUtil.throwFunc("vertexShader와 fragmentShader에 중복된 유니폼 선언이 존재함.","중복선언 : "+s);if(r.parseData.const)for(s in a=r.parseData.const.map,o=i.parseData.const.map,a)o[s]&&RedGLUtil.throwFunc("vertexShader와 fragmentShader에 중복된 상수 선언이 존재함.","중복선언 : "+s);return e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||RedGLUtil.throwFunc("RedProgram : 프로그램을 초기화 할 수 없습니다.",e.getProgramInfoLog(n)),n.key=t,n.vShaderKey=r.key,n.vShaderOriginSource=r.originSource,n.fShaderKey=i.key,n.fShaderOriginKey=r.originSource,n},c={},d=function(){},f=function(){},t=function(e,t,n){var a,o,s,u;performance.now();if(n.parseData.attribute)for(a=(s=n.parseData.attribute.list).length;a--;)o=s[a],(p=new d)._UUID=RedGL.makeUUID(),p.location=t.getAttribLocation(e.webglProgram,o.name),-1==p.location?(p.msg="쉐이더 main 함수에서 사용되고 있지 않음",p.use=!1):p.use=!0,p.attributeType=o.attributeType,p.name=o.name,p.enabled=!1,u=e.attributeLocation.length,-1!=p.location&&(e.attributeLocation[u]=p),e.attributeLocation[p.name]=p;if(n.parseData.uniform)for(a=(s=n.parseData.uniform.list).length;a--;){var l,h,R,m,p;switch(o=s[a],(p=new f)._UUID=RedGL.makeUUID(),p.uniformType=o.uniformType,l=o.arrayNum,R=1e5,o.uniformType){case"sampler2D":h="sampler2D",R=0,m="uniform1i",p.samplerIndex=r,++r==i&&(r=2);break;case"samplerCube":h="samplerCube",R=1,m="uniform1i",p.samplerIndex=r,++r==i&&(r=2);break;case"float":h="float",R=l?12:11,m=l?"uniform1fv":"uniform1f";break;case"int":h="int",R=l?12:11,m=l?"uniform1iv":"uniform1i";break;case"bool":h="bool",R=l?12:11,m=l?"uniform1iv":"uniform1i";break;case"vec4":h="vec",R=12,m="uniform4fv";break;case"vec3":h="vec",R=12,m="uniform3fv";break;case"vec2":h="vec",R=12,m="uniform2fv";break;case"ivec4":h="vec",R=12,m="uniform4iv";break;case"ivec3":h="vec",R=12,m="uniform3iv";break;case"ivec2":h="vec",R=12,m="uniform2iv";break;case"bvec4":h="vec",R=12,m="uniform4iv";break;case"bvec3":h="vec",R=12,m="uniform3iv";break;case"bvec2":h="vec",R=12,m="uniform2iv";break;case"mat4":h="mat",R=13,m="uniformMatrix4fv";break;case"mat3":h="mat",R=13,m="uniformMatrix3fv";break;case"mat2":h="mat",R=13,m="uniformMatrix2fv"}p.location=t.getUniformLocation(e.webglProgram,o.name),p.renderType=h,p.renderMethod=m,p.renderTypeIndex=R,p.name=o.name,c[o.name]||(c[o.name]=o.name.charAt(1).toLowerCase()+o.name.substr(2)),p.materialPropertyName=c[o.name],p.arrayNum=o.arrayNum,p.location?p.use=!0:(p.msg="쉐이더 main 함수에서 사용되고 있지 않음",p.use=!1),o.systemUniformYn?(u=e.systemUniformLocation.length,p.use&&(e.systemUniformLocation[u]=p),e.systemUniformLocation[o.name]=p):(u=e.uniformLocation.length,p.use&&(e.uniformLocation[u]=p),e.uniformLocation[o.name]=p)}performance.now()},(RedProgram=function(r,n,a,o){var s,d,f;return this instanceof RedProgram?(r instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용.","입력값 : "+r),"string"==typeof n||RedGLUtil.throwFunc("RedProgram : key - 문자열만 허용.","입력값 : "+n),s=r.gl,r._datas.RedProgram||(r._datas.RedProgram={},r._datas.RedProgramList=[]),RedProgram.hasKey(r,n)?r._datas.RedProgram[n]:(d=a?RedShader(r,n+"_VS",RedShader.VERTEX,a):null,f=o?RedShader(r,n+"_FS",RedShader.FRAGMENT,o):null,d&&f?r._datas.RedProgram[n]=this:RedGLUtil.throwFunc("RedProgram : 신규 생성시 vertexShader, fragmentShader 모두 입력해야함."),r._datas.RedProgramList.push(this),this.key=n,this.webglProgram=e(s,n,d,f),this.attributeLocation=[],this.uniformLocation=[],this.systemUniformLocation=[],s.useProgram(this.webglProgram),i=r.detect.texture.MAX_COMBINED_TEXTURE_IMAGE_UNITS,t(this,s,d),t(this,s,f),void(this._UUID=RedGL.makeUUID()))):new RedProgram(r,n,a,o)}).prototype={},RedProgram.hasKey=function(e,t){return e instanceof RedGL||RedGLUtil.throwFunc("RedProgram : RedGL Instance만 허용.","입력값 : "+e),e._datas.RedProgram||(e._datas.RedProgram={},e._datas.RedProgramList=[]),!!e._datas.RedProgram[t]},RedProgram.makeProgram=function(e,t,r,i,n){var a;t.indexOf("_")>-1&&RedGLUtil.throwFunc("RedProgram : 프로그램이름에 _ 는 허용하지 않음.","입력값 : "+t),r="string"==typeof r?r:RedGLUtil.getStrFromComment(r.toString()),i="string"==typeof i?i:RedGLUtil.getStrFromComment(i.toString());var o=!1,s=!1,d=!1,f=!1;if(n){n.sort(),t+="_"+n.join("_");for(var c=n.length;c--;)"fog"==n[c]&&(o=!0),"sprite3D"==n[c]&&(s=!0),"directionalShadow"==n[c]&&(d=!0),"skin"==n[c]&&(f=!0),"fog"!=n[c]&&"sprite3D"!=n[c]&&"directionalShadow"!=n[c]&&"skin"!=n[c]&&(a=new RegExp("//#define#"+n[c]+"#","gi"),r=r.replace(a,""),i=i.replace(a,""))}return a=new RegExp("//#define#fog#"+(o?"true":"false")+"#","gi"),r=r.replace(a,""),i=i.replace(a,""),a=new RegExp("//#define#sprite3D#"+(s?"true":"false")+"#","gi"),r=r.replace(a,""),i=i.replace(a,""),a=new RegExp("//#define#directionalShadow#"+(d?"true":"false")+"#","gi"),r=r.replace(a,""),i=i.replace(a,""),a=new RegExp("//#define#skin#"+(f?"true":"false")+"#","gi"),r=r.replace(a,""),i=i.replace(a,""),RedProgram(e,t,r,i)},Object.freeze(RedProgram)}(),(RedSystemShaderCode={}).init=function(){(RedSystemShaderCode={vShareSource:["attribute vec3 aVertexPosition","attribute vec3 aVertexNormal","attribute vec4 aVertexColor","attribute vec4 aVertexWeight","attribute vec4 aVertexJoint","varying vec3 vVertexNormal","attribute float aPointSize","uniform float uPointSize","attribute vec2 aTexcoord","attribute vec2 aTexcoord1","varying vec2 vTexcoord","varying vec2 vTexcoord1","uniform mat4 uJointMatrix[100]","uniform mat4 uInverseBindMatrixForJoint[100]","uniform mat4 uGlobalTransformOfNodeThatTheMeshIsAttachedTo","uniform float uTime","varying float vTime","uniform vec2 uResolution","varying vec2 vResolution","uniform mat4 uMMatrix","uniform mat4 uNMatrix","uniform mat4 uPMatrix","uniform mat4 uCameraMatrix","uniform bool u_PerspectiveScale","uniform mat4 uDirectionalShadowLightMatrix","varying highp vec4 vShadowPos","const mat4 cTexUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0)"],fShareSource:["varying vec3 vVertexNormal","varying vec2 vTexcoord","varying vec2 vTexcoord1","varying float vTime","varying vec2 vResolution","uniform vec3 uCameraPosition","uniform float u_FogDistance","uniform float u_FogDensity","uniform vec4 uFogColor","const int cDIRETIONAL_MAX = 3","uniform vec3 uDirectionalLightPositionList[3]","uniform vec4 uDirectionalLightColorList[3]","uniform float uDirectionalLightIntensityList[3]","uniform int uDirectionalLightNum","const int cPOINT_MAX = 5","uniform vec3 uPointLightPositionList[5]","uniform vec4 uPointLightColorList[5]","uniform float uPointLightRadiusList[5]","uniform float uPointLightIntensityList[5]","uniform int uPointLightNum","uniform vec4 uAmbientLightColor","uniform float uAmbientIntensity","uniform sampler2D uDirectionalShadowTexture","varying highp vec4 vShadowPos"],systemUniform:{}}).MAX_DIRECTIONAL_LIGHT=3,RedSystemShaderCode.MAX_POINT_LIGHT=5,[RedSystemShaderCode.vShareSource,RedSystemShaderCode.fShareSource].forEach(function(e){e.forEach(function(e){"uniform"==(e=e.split(" "))[0]&&(RedSystemShaderCode.systemUniform[e[2]]=1)})}),Object.freeze(RedSystemShaderCode)},function(){var e,t,r,i,n,a,o,s,d,f;e=function(e,t,r){switch(r){case RedShader.VERTEX:return(n=e.createShader(e.VERTEX_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),n.key=t,n.type=r,n;case RedShader.FRAGMENT:return(n=e.createShader(e.FRAGMENT_SHADER))||(e.isContextLost()?RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - WebGL 컨텍스트가 손실"):RedGLUtil.throwFunc("RedShader : 쉐이더를 생성실패! - GPU메모리가 부족일 가능성이 큼")),n.key=t,n.type=r,n;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용")}},t=function(e,t,r,i){e.shaderSource(r,i.lastSource),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||RedGLUtil.throwFunc("RedShader : 쉐이더 컴파일에 실패하였습니다.\n",e.getShaderInfoLog(r))},i=function(e,t){var r;switch(e){case RedShader.VERTEX:r=RedSystemShaderCode.vShareSource.concat();break;case RedShader.FRAGMENT:r=RedSystemShaderCode.fShareSource.concat();break;default:RedGLUtil.throwFunc("RedShader : 쉐이더 타입을 확인하세요. RedShader.VERTEX or RedShader.FRAGMENT 만 허용")}for(a=t.length;a--;)o=(o=t[a]).replace(";",""),-1==r.indexOf(o)?r.push(o):RedGLUtil.throwFunc("RedShader : ","\n1. 중복 선언 이거나","\n2. RedSystemShaderCode에 정의된 선언\n","입력값 : "+o);return r},r=function(e,t){return t=(t=t.replace(/\s+$/,"")).replace(/  /g,"").trim(),s={etc:""},d=t.match(/attribute[\s\S]+?\;|uniform[\s\S]+?\;|varying[\s\S]+?\;|const[\s\S]+?\;|precision[\s\S]+?\;/g),(d=i(e,d=d||[])).sort(),d.forEach(function(e){var r,i,n,a,o,d,f,c,u;if(e=e.trim(),t=t.replace(e+";",""),("highp"==(r=e.split(" "))[1]||"mediump"==r[1]||"lowp"==r[1])&&(u=r[1],r.splice(1,1),r.push(u),c=u),r[2])switch(i=r[0],a=r[1],n=r[2].replace(";","").split("["),d=(d=e.split("="))[1]?d[1].trim().replace(";",""):null,o=n.length>1?+n[1].split("]")[0]:0,n=n[0],i){case"precision":break;case"attribute":"a"!=n.charAt(0)&&RedGLUtil.throwFunc("RedShader : attribute의 첫글자는 a로 시작해야합니다.",n),n.charAt(1)!=n.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : attribute의 두번째 글자는 대문자 시작해야합니다.",n);break;case"uniform":"u"!=n.charAt(0)&&RedGLUtil.throwFunc("RedShader : uniform의 첫글자는 u로 시작해야합니다.",n),n.charAt(1)!=n.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : uniform의 두번째 글자는 대문자 시작해야합니다.",n);break;case"varying":"v"!=n.charAt(0)&&RedGLUtil.throwFunc("RedShader : varying의 첫글자는 v로 시작해야합니다.",n),n.charAt(1)!=n.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : varying의 두번째 글자는 대문자 시작해야합니다.",n);break;case"const":"c"!=n.charAt(0)&&RedGLUtil.throwFunc("RedShader : const의 첫글자는 c로 시작해야합니다.",n),n.charAt(1)!=n.charAt(1).toUpperCase()&&RedGLUtil.throwFunc("RedShader : const의 두번째 글자는 대문자 시작해야합니다.",n);break;default:RedGLUtil.throwFunc("RedShader : 체크되지 못하는값인데 뭐냐",n)}else RedGLUtil.throwFunc("RedShader : 체크되지 못하는값인데 뭐냐",r);s[i]||(s[i]={},s[i].list=[],s[i].map={},s[i].source=""),f={name:n,arrayNum:o,value:d,precision:c,systemUniformYn:!!RedSystemShaderCode.systemUniform[o?n+"["+o+"]":n]},"uniform"==i&&(f.uniformType=a),"attribute"==i&&(f.attributeType=a),"varying"==i&&(f.varyingType=a),s[i].list.push(f),s[i].map[n]=e,s[i].source+=e+";\n"}),t=(t+="\n").trim(),s.etc=t+"\n",f="",s.precision&&(f+=s.precision.source+"\n//const\n"),s.const&&(f+=s.const.source+"\n//attribute\n"),s.attribute&&(f+=s.attribute.source+"\n//uniform\n"),s.uniform&&(f+=s.uniform.source+"\n//varying\n"),s.varying&&(f+=s.varying.source+"\n//etc\n"),s.etc&&(f+=s.etc),s.lastSource=f,e!=RedShader.FRAGMENT||s.precision||RedGLUtil.throwFunc("RedShader : FRAGMENT Shader는 precision를 반드시 선언해야함"),s},(RedShader=function(i,n,a,o){var s;if(!(this instanceof RedShader))return new RedShader(i,n,a,o);if(i instanceof RedGL||RedGLUtil.throwFunc("RedShader : RedGL Instance만 허용.","입력값 : "+i),"string"==typeof n||RedGLUtil.throwFunc("RedShader : key - 문자열만 허용.","입력값 : "+n),a!=RedShader.VERTEX&&a!=RedShader.FRAGMENT&&RedGLUtil.throwFunc("RedShader : type - RedShader.VERTEX or RedShader.FRAGMENT 만 허용.","입력값 : "+a),i._datas.RedShader||(i._datas.RedShader={},i._datas.RedShader[RedShader.VERTEX]={},i._datas.RedShader[RedShader.FRAGMENT]={}),o)"string"==typeof o||RedGLUtil.throwFunc("RedShader : source - 문자열만 허용."),RedShader.hasKey(i,n,a)?RedGLUtil.throwFunc("RedShader : key - 이미 정의된 키로 생성을 시도.","\n키 :",n,"\n타입 :"+a):i._datas.RedShader[a][n]=this;else{if(RedShader.hasKey(i,n,a))return i._datas.RedShader[a][n];RedGLUtil.throwFunc("RedShader : "+a+" 타입에 존재하지 않는 key를 검색하려고합니다.","입력값 : "+n)}s=i.gl,this.webglShader=e(s,n,a),this.parseData=r(a,o),this.originSource=o,t(s,0,this.webglShader,this.parseData),this.key=n,this.type=a,this._UUID=RedGL.makeUUID(),Object.freeze(this)}).hasKey=function(e,t,r){return!!e._datas.RedShader[r][t]},RedShader.FRAGMENT="fragmentShader",RedShader.VERTEX="vertexShader",Object.freeze(RedShader)}(),function(){var e,t,r,i;(RedRenderer=function(){if(!(this instanceof RedRenderer))return new RedRenderer;this.world=null,this._tickKey=null,this._callback=null,this._UUID=RedGL.makeUUID(),this.renderInfo={},this.cacheState=[],this.cacheInfo={cacheUniformInfo:[],cacheAttrInfo:[],cacheSamplerIndex:[],cacheTexture:[],cacheSystemUniformInfo:[]},this.renderDebuger=RedRenderDebuger(),this.worldRect=[],this._glInitialized=!1}).prototype={start:(e=function(i){t.worldRender(r,i),t._callback&&t._callback(i),t._tickKey=requestAnimationFrame(e)},function(i,n){i instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),i.world instanceof RedWorld||RedGLUtil.throwFunc("RedWorld Instance만 허용"),(t=this).world=i.world,r=i,t._callback=n,t._tickKey=requestAnimationFrame(e)}),render:function(e,t){e instanceof RedGL||RedGLUtil.throwFunc("RedGL Instance만 허용"),this.worldRender(e,t),this.world=e.world},stop:function(){cancelAnimationFrame(this._tickKey)}};var n,a,o,s,d=[];RedRenderer.prototype.worldRender=function(){var e,t,r,n,a,o,s;return o=[],r=function(t){for(s=t.length;s--;)"number"==typeof t[s]?t[s]=t[s]:t[s]=s<2?e[s+2]*parseFloat(t[s])/100:e[s]*parseFloat(t[s])/100;return t},n=function(e,t,r){i=RedSystemUniformUpdater.update(e,this,t,r,i,o)},a=function(e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.SCISSOR_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DITHER),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0)},function(i,s){var f,c,u,l,h,R,m,p,_;for(f=i.gl,(e=(t=this).worldRect)[0]=0,e[1]=0,e[2]=f.drawingBufferWidth,e[3]=f.drawingBufferHeight,f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.scissor(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),d.length=0,t._glInitialized||(a(f),t._glInitialized=!0),t.renderInfo={},t.cacheInfo.cacheAttrInfo.length=0,i.gl.activeTexture(i.gl.TEXTURE0),i.gl.bindTexture(i.gl.TEXTURE_2D,i._datas.emptyTexture["2d"].webglTexture),i.gl.activeTexture(i.gl.TEXTURE0+1),i.gl.bindTexture(i.gl.TEXTURE_CUBE_MAP,i._datas.emptyTexture["3d"].webglTexture),R=0,m=t.world._viewList.length;R<m;R++)(_=(p=t.world._viewList[R])._viewRect)[0]=p._x,_[1]=p._y,_[2]=p._width,_[3]=p._height,h=p.camera,c=p.scene,r(_),t.renderInfo[p.key]||(t.renderInfo[p.key]={}),(u=t.renderInfo[p.key]).orthographicYn=h instanceof RedBaseController?h.camera.orthographicYn:h.orthographicYn,u.x=p._x,u.y=p._y,u.width=p._width,u.height=p._height,u.viewRectX=_[0],u.viewRectY=_[1],u.viewRectWidth=_[2],u.viewRectHeight=_[3],u.key=p.key,u.call=0,u.triangleNum=0,u.viewRenderTime=0,u.postEffectRenderTime=0,f.viewport(_[0],e[3]-_[3]-_[1],_[2],_[3]),f.scissor(_[0],e[3]-_[3]-_[1],_[2],_[3]),c._useBackgroundColor?(c._useFog?f.clearColor(c._fogR,c._fogG,c._fogB,1):f.clearColor(c._r,c._g,c._b,1),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)):(f.clearColor(0,0,0,1),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT)),h instanceof RedBaseController&&(h.update(),h=h.camera),h.autoUpdateMatrix&&h.update(),l=h.perspectiveMTX,mat4.identity(l),h.orthographicYn?(mat4.ortho(l,-.5,.5,-.5,.5,-h.farClipping,h.farClipping),mat4.translate(l,l,[-.5,.5,0]),mat4.scale(l,l,[1/_[2],-1/_[3],1]),mat4.identity(h.matrix),f.disable(f.CULL_FACE),t.cacheState.useCullFace=!1):(mat4.perspective(l,h.fov*Math.PI/180,_[2]/_[3],h.nearClipping,h.farClipping),f.enable(f.CULL_FACE),t.cacheState.useCullFace=!0),!t.cacheState.useDepthMask&&f.depthMask(t.cacheState.useDepthMask=!0),c.shadowManager._directionalShadow&&(n.apply(t,[i,s,p]),f.enable(f.BLEND),f.blendFunc(f.ONE,f.ONE),t.cacheState.useBlendMode=!0,t.cacheState.blendSrc=f.ONE,t.cacheState.blendDst=f.ONE,c.shadowManager.render(i,t,p,s,u),f.enable(f.BLEND),f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA),t.cacheState.useBlendMode=!0,t.cacheState.blendSrc=f.SRC_ALPHA,t.cacheState.blendDst=f.ONE_MINUS_SRC_ALPHA),p.postEffectManager.postEffectList.length&&(p.postEffectManager.bind(f),f.viewport(0,0,p.postEffectManager.frameBuffer.width,p.postEffectManager.frameBuffer.height),f.scissor(0,0,p.postEffectManager.frameBuffer.width,p.postEffectManager.frameBuffer.height)),n.apply(t,[i,s,p]),c.skyBox&&(c.skyBox.x=h.x,c.skyBox.y=h.y,c.skyBox.z=h.z,c.skyBox.scaleX=c.skyBox.scaleY=c.skyBox.scaleZ=.6*h.farClipping,t.sceneRender(i,c,h,h.orthographicYn,[c.skyBox],s,u)),c.grid&&t.sceneRender(i,c,h,h.orthographicYn,[c.grid],s,u),t.sceneRender(i,c,h,h.orthographicYn,c.children,s,u),d.length&&t.sceneRender(i,c,h,h.orthographicYn,d,s,u,null,!0),c.axis&&t.sceneRender(i,c,h,h.orthographicYn,c.axis.children,s,u),o.length&&t.sceneRender(i,c,h,h.orthographicYn,o,s,u),u.viewRenderTime=performance.now(),p.postEffectManager.postEffectList.length&&p.postEffectManager.render(i,f,t,p,s,u),u.postEffectRenderTime=performance.now()-u.viewRenderTime,u.viewRenderTime-=s;this.renderDebuger.visible&&this.renderDebuger.update(i,t.renderInfo)}}(),RedRenderer.prototype.sceneRender=(n=function(e,t,r,f,c,u,l,h,R,m,p,_){var P,g,E,y,M,T,b,v,L,x,w,U,D,I,B,A,S,G,F,C,O,k,N,X,Y,j,z,V,Z,H,W,q,J,Q,K,$,ee,te,re,ie,ne,ae,oe,se,de,fe,ce,ue,le,he,Re,me,pe,_e,Pe,ge,Ee,ye,Me,Te,be,ve,Le,xe,we,Ue,De,Ie,Be,Ae,Se,Ge,Fe,Ce,Oe,ke,Ne,Xe,Ye,je,ze,Ve,Ze,He,We,qe,Je,Qe,Ke,$e,et,tt,rt,it,nt,at,ot,st,dt,ft,ct,ut,lt,ht,Rt,mt,pt,_t,Pt,gt,Et,yt,Mt,Tt,bt,vt,Lt,xt=e.gl,wt=h.cacheAttrInfo,Ut=h.cacheUniformInfo,Dt=h.cacheSamplerIndex,It=h.cacheTexture,Bt=c?-1:1;E=Math.PI/180,mt=3.141592653589793,pt=6.283185307179586,_t=1.27323954,Pt=.405284735,gt=1.5707963267948966,P=r.length;var At=r.length-1;for(H=t._useFog;P--;){if(l.call++,k=(y=r[At-P]).matrix,N=y.normalMatrix,M=y._geometry,j=y._sprite3DYn,Z=y.skinInfo,y.useLOD)for(var St in Et=f.x-y.x,yt=f.y-y.y,Mt=f.z-y.z,Tt=Math.abs(Math.sqrt(Et*Et+yt*yt+Mt*Mt)),b=y._lodLevels)(z=b[St]).distance<Tt&&(y._geometry=z.geometry,y._material=z.material);if(M){if(V=(T=p||y._material)._RedDirectionalShadowYn,T.__RedSheetMaterialYn){if(T._nextFrameTime||(T._nextFrameTime=T._perFrameTime+u),T._playYn&&T._nextFrameTime<u){var Gt=parseInt((u-T._nextFrameTime)/T._perFrameTime);Gt=Gt||1,T._nextFrameTime=T._perFrameTime+u,T.currentIndex+=Gt,T.currentIndex>=T.totalFrame&&(T._loop?(T._playYn=!0,T.currentIndex=0):(T._playYn=!1,T.currentIndex=T.totalFrame-1))}T._sheetRect[0]=1/T._segmentW,T._sheetRect[1]=1/T._segmentH,T._sheetRect[2]=T.currentIndex%T._segmentW/T._segmentW,T._sheetRect[3]=Math.floor(T.currentIndex/T._segmentH)/T._segmentH}for(bt=t.shadowManager._directionalShadow,(W=T.program)._prepareProgramYn&&(W=T.program=W._makePrepareProgram()),q=null,J=null,Lt=W.key,(vt=T._programList)&&(bt?q=H&&j?"directionalShadow_fog_sprite3D":Z?"directionalShadow_skin":j?"directionalShadow_sprite3D":H?"directionalShadow_fog":"directionalShadow":H&&j?q="fog_sprite3D":Z?q="skin":j?q="sprite3D":H&&(q="fog")),q&&((J=vt[q][Lt])._prepareProgramYn&&(J=vt[q][Lt]=J._makePrepareProgram()),W=J),i!=W._UUID&&xt.useProgram(W.webglProgram),i=W._UUID,v=W.attributeLocation,U=W.uniformLocation,D=W.systemUniformLocation,S=M.interleaveBuffer,G=M.indexBuffer,X=S._UUID,g=v.length,x=S.interleaveDefineInfoList,o!=X&&xt.bindBuffer(xt.ARRAY_BUFFER,S.webglBuffer),o=X;g--;)w=x[(L=v[g]).name],A=L.location,w&&wt[A]!=w._UUID&&(!L.enabled&&xt.enableVertexAttribArray(A),L.enabled=1,xt.vertexAttribPointer(A,w.size,S.glArrayType,w.normalize,S.stride_BYTES_PER_ELEMENT,w.offset_BYTES_PER_ELEMENT),wt[A]=w._UUID);for(g=U.length;g--;)B=(I=U[g]).location,X=I._UUID,O=I.renderTypeIndex,C=I.renderType,F=T[I.materialPropertyName],"sampler2D"==C||"samplerCube"==C?(Y=I.samplerIndex,F?It[Y]!=F._UUID&&(s!=Y&&xt.activeTexture(xt.TEXTURE0+(s=Y)),F._videoDom?(xt.bindTexture(xt.TEXTURE_2D,F.webglTexture),F._videoDom.loaded&&xt.texImage2D(xt.TEXTURE_2D,0,xt.RGBA,xt.RGBA,xt.UNSIGNED_BYTE,F._videoDom)):xt.bindTexture("sampler2D"==C?xt.TEXTURE_2D:xt.TEXTURE_CUBE_MAP,F.webglTexture),Dt[X]!=Y&&xt.uniform1i(B,Dt[X]=Y),It[Y]=F._UUID):"sampler2D"==C?0!=It[Y]&&(0!=Dt[X]&&xt.uniform1i(B,Dt[X]=0),It[Y]=0,s=0):1!=It[Y]&&(1!=Dt[X]&&xt.uniform1i(B,Dt[X]=1),It[Y]=1,s=1)):(void 0==F&&RedGLUtil.throwFunc("RedRenderer : Material에 ",I.materialPropertyName,"이 정의 되지않았습니다."),O<13?Ut[X]!=F&&xt[I.renderMethod](B,(Ut[X]=12==O?null:F,F)):13==O?xt[I.renderMethod](B,!1,F):RedGLUtil.throwFunc("RedRenderer : 처리할수없는 타입입니다.","tRenderType -",C))}if(y.autoUpdateMatrix&&(k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,Q=k,Fe=y.x,Ce=y.y,Oe=y.z,Q[12]=Q[0]*Fe+Q[4]*Ce+Q[8]*Oe+Q[12],Q[13]=Q[1]*Fe+Q[5]*Ce+Q[9]*Oe+Q[13],Q[14]=Q[2]*Fe+Q[6]*Ce+Q[10]*Oe+Q[14],Q[15]=Q[3]*Fe+Q[7]*Ce+Q[11]*Oe+Q[15],j?ne=ae=oe=0:(ne=y.rotationX*E,ae=y.rotationY*E,oe=y.rotationZ*E),(Rt=ne%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),K=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,(Rt=(ne+gt)%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),te=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,(Rt=ae%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),$=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,(Rt=(ae+gt)%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),re=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,(Rt=oe%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),ee=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,(Rt=(oe+gt)%pt)<-mt?Rt+=pt:Rt>mt&&(Rt-=pt),ie=(Rt=Rt<0?_t*Rt+Pt*Rt*Rt:_t*Rt-Pt*Rt*Rt)<0?.225*(Rt*-Rt-Rt)+Rt:.225*(Rt*Rt-Rt)+Rt,se=Q[0],de=Q[1],fe=Q[2],ue=Q[4],le=Q[5],he=Q[6],me=Q[8],pe=Q[9],_e=Q[10],xe=re*ie,we=K*$*ie-te*ee,Ue=te*$*ie+K*ee,De=re*ee,Ie=K*$*ee+te*ie,Be=te*$*ee-K*ie,Ae=-$,Se=K*re,Ge=te*re,Q[0]=se*xe+ue*we+me*Ue,Q[1]=de*xe+le*we+pe*Ue,Q[2]=fe*xe+he*we+_e*Ue,Q[4]=se*De+ue*Ie+me*Be,Q[5]=de*De+le*Ie+pe*Be,Q[6]=fe*De+he*Ie+_e*Be,Q[8]=se*Ae+ue*Se+me*Ge,Q[9]=de*Ae+le*Se+pe*Ge,Q[10]=fe*Ae+he*Se+_e*Ge,Fe=y.scaleX,Ce=y.scaleY*Bt,Oe=y.scaleZ,Q[0]=Q[0]*Fe,Q[1]=Q[1]*Fe,Q[2]=Q[2]*Fe,Q[3]=Q[3]*Fe,Q[4]=Q[4]*Ce,Q[5]=Q[5]*Ce,Q[6]=Q[6]*Ce,Q[7]=Q[7]*Ce,Q[8]=Q[8]*Oe,Q[9]=Q[9]*Oe,Q[10]=Q[10]*Oe,Q[11]=Q[11]*Oe,Q[12]=Q[12],Q[13]=Q[13],Q[14]=Q[14],Q[15]=Q[15],y.localMatrix[0]=Q[0],y.localMatrix[1]=Q[1],y.localMatrix[2]=Q[2],y.localMatrix[3]=Q[3],y.localMatrix[4]=Q[4],y.localMatrix[5]=Q[5],y.localMatrix[6]=Q[6],y.localMatrix[7]=Q[7],y.localMatrix[8]=Q[8],y.localMatrix[9]=Q[9],y.localMatrix[10]=Q[10],y.localMatrix[11]=Q[11],y.localMatrix[12]=Q[12],y.localMatrix[13]=Q[13],y.localMatrix[14]=Q[14],y.localMatrix[15]=Q[15],m&&(se=m[0],de=m[1],fe=m[2],ce=m[3],ue=m[4],le=m[5],he=m[6],Re=m[7],me=m[8],pe=m[9],_e=m[10],Pe=m[11],ge=m[12],Ee=m[13],ye=m[14],Me=m[15],Te=k[0],be=k[1],ve=k[2],Le=k[3],k[0]=Te*se+be*ue+ve*me+Le*ge,k[1]=Te*de+be*le+ve*pe+Le*Ee,k[2]=Te*fe+be*he+ve*_e+Le*ye,k[3]=Te*ce+be*Re+ve*Pe+Le*Me,Te=k[4],be=k[5],ve=k[6],Le=k[7],k[4]=Te*se+be*ue+ve*me+Le*ge,k[5]=Te*de+be*le+ve*pe+Le*Ee,k[6]=Te*fe+be*he+ve*_e+Le*ye,k[7]=Te*ce+be*Re+ve*Pe+Le*Me,Te=k[8],be=k[9],ve=k[10],Le=k[11],k[8]=Te*se+be*ue+ve*me+Le*ge,k[9]=Te*de+be*le+ve*pe+Le*Ee,k[10]=Te*fe+be*he+ve*_e+Le*ye,k[11]=Te*ce+be*Re+ve*Pe+Le*Me,Te=k[12],be=k[13],ve=k[14],Le=k[15],k[12]=Te*se+be*ue+ve*me+Le*ge,k[13]=Te*de+be*le+ve*pe+Le*Ee,k[14]=Te*fe+be*he+ve*_e+Le*ye,k[15]=Te*ce+be*Re+ve*Pe+Le*Me)),M&&xt.uniformMatrix4fv(D.uMMatrix.location,!1,k),Z){var Ft=[],Ct=Z.joints,Ot=0,kt=Ct.length,Nt=[y.matrix[0],y.matrix[1],y.matrix[2],y.matrix[3],y.matrix[4],y.matrix[5],y.matrix[6],y.matrix[7],y.matrix[8],y.matrix[9],y.matrix[10],y.matrix[11],y.matrix[12],y.matrix[13],y.matrix[14],y.matrix[15]],Xt=Nt,Yt=Nt[0],jt=Nt[1],zt=Nt[2],Vt=Nt[3],Zt=Nt[4],Ht=Nt[5],Wt=Nt[6],qt=Nt[7],Jt=Nt[8],Qt=Nt[9],Kt=Nt[10],$t=Nt[11],er=Nt[12],tr=Nt[13],rr=Nt[14],ir=Nt[15],nr=Qt*rr*qt-tr*Kt*qt+tr*Wt*$t-Ht*rr*$t-Qt*Wt*ir+Ht*Kt*ir,ar=er*Kt*qt-Jt*rr*qt-er*Wt*$t+Zt*rr*$t+Jt*Wt*ir-Zt*Kt*ir,or=Jt*tr*qt-er*Qt*qt+er*Ht*$t-Zt*tr*$t-Jt*Ht*ir+Zt*Qt*ir,sr=er*Qt*Wt-Jt*tr*Wt-er*Ht*Kt+Zt*tr*Kt+Jt*Ht*rr-Zt*Qt*rr,dr=Yt*nr+jt*ar+zt*or+Vt*sr;if(0===dr)return mat4.identity(Nt);var fr=1/dr;for(Xt[0]=nr*fr,Xt[1]=(tr*Kt*Vt-Qt*rr*Vt-tr*zt*$t+jt*rr*$t+Qt*zt*ir-jt*Kt*ir)*fr,Xt[2]=(Ht*rr*Vt-tr*Wt*Vt+tr*zt*qt-jt*rr*qt-Ht*zt*ir+jt*Wt*ir)*fr,Xt[3]=(Qt*Wt*Vt-Ht*Kt*Vt-Qt*zt*qt+jt*Kt*qt+Ht*zt*$t-jt*Wt*$t)*fr,Xt[4]=ar*fr,Xt[5]=(Jt*rr*Vt-er*Kt*Vt+er*zt*$t-Yt*rr*$t-Jt*zt*ir+Yt*Kt*ir)*fr,Xt[6]=(er*Wt*Vt-Zt*rr*Vt-er*zt*qt+Yt*rr*qt+Zt*zt*ir-Yt*Wt*ir)*fr,Xt[7]=(Zt*Kt*Vt-Jt*Wt*Vt+Jt*zt*qt-Yt*Kt*qt-Zt*zt*$t+Yt*Wt*$t)*fr,Xt[8]=or*fr,Xt[9]=(er*Qt*Vt-Jt*tr*Vt-er*jt*$t+Yt*tr*$t+Jt*jt*ir-Yt*Qt*ir)*fr,Xt[10]=(Zt*tr*Vt-er*Ht*Vt+er*jt*qt-Yt*tr*qt-Zt*jt*ir+Yt*Ht*ir)*fr,Xt[11]=(Jt*Ht*Vt-Zt*Qt*Vt-Jt*jt*qt+Yt*Qt*qt+Zt*jt*$t-Yt*Ht*$t)*fr,Xt[12]=sr*fr,Xt[13]=(Jt*tr*zt-er*Qt*zt+er*jt*Kt-Yt*tr*Kt-Jt*jt*rr+Yt*Qt*rr)*fr,Xt[14]=(er*Ht*zt-Zt*tr*zt-er*jt*Wt+Yt*tr*Wt+Zt*jt*rr-Yt*Ht*rr)*fr,Xt[15]=(Zt*Qt*zt-Jt*Ht*zt+Jt*jt*Wt-Yt*Qt*Wt-Zt*jt*Kt+Yt*Ht*Kt)*fr;Ot<kt;Ot++)Ft[16*Ot+0]=Ct[Ot].matrix[0],Ft[16*Ot+1]=Ct[Ot].matrix[1],Ft[16*Ot+2]=Ct[Ot].matrix[2],Ft[16*Ot+3]=Ct[Ot].matrix[3],Ft[16*Ot+4]=Ct[Ot].matrix[4],Ft[16*Ot+5]=Ct[Ot].matrix[5],Ft[16*Ot+6]=Ct[Ot].matrix[6],Ft[16*Ot+7]=Ct[Ot].matrix[7],Ft[16*Ot+8]=Ct[Ot].matrix[8],Ft[16*Ot+9]=Ct[Ot].matrix[9],Ft[16*Ot+10]=Ct[Ot].matrix[10],Ft[16*Ot+11]=Ct[Ot].matrix[11],Ft[16*Ot+12]=Ct[Ot].matrix[12],Ft[16*Ot+13]=Ct[Ot].matrix[13],Ft[16*Ot+14]=Ct[Ot].matrix[14],Ft[16*Ot+15]=Ct[Ot].matrix[15];xt.uniformMatrix4fv(D.uGlobalTransformOfNodeThatTheMeshIsAttachedTo.location,!1,Nt),xt.uniformMatrix4fv(D.uJointMatrix.location,!1,Ft),xt.uniformMatrix4fv(D.uInverseBindMatrixForJoint.location,!1,Z.inverseBindMatrices)}if(M&&D&&D.uNMatrix.location&&(ke=k[0],Ne=k[1],Xe=k[2],Ye=k[3],je=k[4],ze=k[5],Ve=k[6],Ze=k[7],He=k[8],We=k[9],qe=k[10],Je=k[11],Ke=k[12],$e=k[13],et=k[14],ht=1/(ht=(Qe=ke*ze-Ne*je)*(lt=qe*(tt=k[15])-Je*et)-(rt=ke*Ve-Xe*je)*(ut=We*tt-Je*$e)+(it=ke*Ze-Ye*je)*(ct=We*et-qe*$e)+(nt=Ne*Ve-Xe*ze)*(ft=He*tt-Je*Ke)-(at=Ne*Ze-Ye*ze)*(dt=He*et-qe*Ke)+(ot=Xe*Ze-Ye*Ve)*(st=He*$e-We*Ke)),N[0]=(ze*lt-Ve*ut+Ze*ct)*ht,N[1]=(-Ne*lt+Xe*ut-Ye*ct)*ht,N[2]=($e*ot-et*at+tt*nt)*ht,N[3]=(-We*ot+qe*at-Je*nt)*ht,N[4]=(-je*lt+Ve*ft-Ze*dt)*ht,N[5]=(ke*lt-Xe*ft+Ye*dt)*ht,N[6]=(-Ke*ot+et*it-tt*rt)*ht,N[7]=(He*ot-qe*it+Je*rt)*ht,N[8]=(je*ut-ze*ft+Ze*st)*ht,N[9]=(-ke*ut+Ne*ft-Ye*st)*ht,N[10]=(Ke*at-$e*it+tt*Qe)*ht,N[11]=(-He*at+We*it-Je*Qe)*ht,N[12]=(-je*ct+ze*dt-Ve*st)*ht,N[13]=(ke*ct-Ne*dt+Xe*st)*ht,N[14]=(-Ke*nt+$e*rt-et*Qe)*ht,N[15]=(He*nt-We*rt+qe*Qe)*ht,de=N[1],fe=N[2],ce=N[3],he=N[6],Re=N[7],Pe=N[11],N[1]=N[4],N[2]=N[8],N[3]=N[12],N[4]=de,N[6]=N[9],N[7]=N[13],N[8]=fe,N[9]=he,N[11]=N[14],N[12]=ce,N[13]=Re,N[14]=Pe,xt.uniformMatrix4fv(D.uNMatrix.location,!1,N)),M){if(R.useCullFace!=y.useCullFace&&((R.useCullFace=y.useCullFace)?xt.enable(xt.CULL_FACE):xt.disable(xt.CULL_FACE)),R.useCullFace&&R.cullFace!=y.cullFace&&xt.cullFace(R.cullFace=y.cullFace),R.useDepthMask!=y.useDepthMask&&xt.depthMask(R.useDepthMask=y.useDepthMask),R.useDepthTest!=y.useDepthTest&&((R.useDepthTest=y.useDepthTest)?xt.enable(xt.DEPTH_TEST):xt.disable(xt.DEPTH_TEST)),R.useDepthTest&&R.depthTestFunc!=y.depthTestFunc&&xt.depthFunc(R.depthTestFunc=y.depthTestFunc),D.uPointSize.use&&R.pointSize!=y.pointSize&&xt.uniform1f(D.uPointSize.location,R.pointSize=y.pointSize),D.u_PerspectiveScale.location&&(X=D.u_PerspectiveScale._UUID,F=y._perspectiveScale,Ut[X]!=F&&(xt[D.u_PerspectiveScale.renderMethod](D.u_PerspectiveScale.location,F),Ut[X]=F)),V||(R.useBlendMode!=y.useBlendMode&&((R.useBlendMode=y.useBlendMode)?xt.enable(xt.BLEND):xt.disable(xt.BLEND)),R.blendSrc==y.blendSrc&&R.blendDst==y.blendDst||(xt.blendFunc(y.blendSrc,y.blendDst),R.blendSrc=y.blendSrc,R.blendDst=y.blendDst)),_)y.autoUpdateMatrix=y._renderAutoUpdateMatrix;else if(y.useTransparentSort){d.push(y),y._renderAutoUpdateMatrix=y.autoUpdateMatrix,y.autoUpdateMatrix=!1;continue}G?(a!=G._UUID&&xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,G.webglBuffer),xt.drawElements(y.drawMode,G.pointNum,G.glArrayType,0),a=G._UUID,l.triangleNum+=G.triangleNum):(xt.drawArrays(y.drawMode,0,S.pointNum),l.triangleNum+=S.triangleNum)}y.children.length&&n(e,t,y.children,f,c,u,l,h,R,k,p,_)}},function(e,t,r,i,d,f,c,u,l){this.cacheInfo.cacheTexture.length=0,a=null,o=null,s=null,n(e,t,d,r,i,f,c,this.cacheInfo,this.cacheState,void 0,u,l)}),Object.freeze(RedRenderer)}(),(RedRenderDebuger=function(){if(!(this instanceof RedRenderDebuger))return new RedRenderDebuger;if(!this.renderResult){this.renderResult=document.createElement("div"),this._contentBox=document.createElement("div"),this._etcBox=document.createElement("div"),this.renderResult.appendChild(this._contentBox),this.renderResult.appendChild(this._etcBox),this.renderResult.style.cssText="position:absolute;bottom:0px;left:0px;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;background:rgba(0,0,0,0.75);padding:3px;width:300px",this._etcBox.style.cssText="position:relative;color:#fff;font:11px Lucida Grande,sans-serif;font-size:11px;padding:3px;margin-top:10px;";var e=document.createElement("a");e.style.padding="5px",e.style.borderRadius="2px",e.style.background="rgba(91, 82, 170,0.8)",e.style.color="#fff",e.style.textDecoration="none",e.style.display="block",e.setAttribute("href","https://redcamel.github.io/RedGL2/redDoc/index.html"),e.innerHTML="API document",this._etcBox.appendChild(e),(e=document.createElement("a")).style.padding="5px",e.style.borderRadius="2px",e.style.background="rgba(91, 82, 170,0.8)",e.style.color="#fff",e.style.textDecoration="none",e.style.display="block",e.style.marginTop="2px",e.setAttribute("href","https://github.com/redcamel/RedGL2"),e.innerHTML="GITHUB",this._etcBox.appendChild(e)}this._visible=!1}).prototype={update:function(e,t){this._contentBox.innerHTML="";var r="",i=0,n=0;for(var a in t)r+='<div style="padding:5px"><div><b style="color:rgb(242, 169, 113)">RedView : key - '+t[a].key+'</b></div> orthographicYn - <b style="color:rgb(191, 82, 170)">'+t[a].orthographicYn+'</b> <br>call - <b style="color:rgb(191, 82, 170)">'+t[a].call+'</b> <br>triangleNum - <b style="color:rgb(191, 82, 170)">'+t[a].triangleNum+'</b> <br> width - <b style="color:rgb(191, 82, 170)">'+t[a].width+'</b> / height - <b style="color:rgb(191, 82, 170)">'+t[a].height+'</b> <br> viewRectWidth - <b style="color:rgb(191, 82, 170)">'+t[a].viewRectWidth+'</b> / viewRectHeight - <b style="color:rgb(191, 82, 170)">'+t[a].viewRectHeight+'</b> <br> x - <b style="color:rgb(191, 82, 170)">'+t[a].x+'</b> / y - <b style="color:rgb(191, 82, 170)">'+t[a].y+'</b><div>renderTime</div><div style="padding:5px 7px 7px 7px;background:rgba(0,0,0, 0.5);"><div>viewRenderTime - <b style="color:rgb(191, 82, 170)">'+t[a].viewRenderTime.toFixed(2)+'ms</b></div><div>baseRenderTime - <b style="color:rgb(191, 82, 170)">'+(t[a].viewRenderTime-t[a].postEffectRenderTime).toFixed(2)+'ms</b></div><div>postEffectRenderTime - <b style="color:rgb(191, 82, 170)">'+t[a].postEffectRenderTime.toFixed(2)+"ms</b></div></div></div>",i+=t[a].viewRenderTime,n+=t[a].postEffectRenderTime;r+='<div style="padding:0px 5px">',r+='<div>renderScale : <span style="padding:3px;background:#000">'+e.renderScale+"</span></div>",r+='<div>totalRenderTime : <span style="padding:3px;background:#000">'+i.toFixed(2)+"ms</span></div>",r+='<div>baseRenderTime : <span style="padding:3px;background:#000">'+(i-n).toFixed(2)+"ms</span></div>",r+='<div>postEffectRenderTime : <span style="padding:3px;background:#000">'+n.toFixed(2)+"ms</span></div>",r+="</div>",this._contentBox.innerHTML=r}},Object.defineProperty(RedRenderDebuger.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._visible?document.body.appendChild(this.renderResult):this.renderResult.parentNode&&document.body.removeChild(this.renderResult)}}),Object.freeze(RedRenderDebuger),function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E,y,M,T,b,v,L,x,w,U,D,I,B,A,S,G,F;RedSystemUniformUpdater={update:(F=0,M={uTime:{cacheData:null,data:0},uResolution:{cacheData:null,data:new Float32Array([0,0])},u_FogDensity:{cacheData:null,data:0},uFogColor:{cacheData:null,data:new Float32Array([0,0,0,0])},u_FogDistance:{cacheData:null,data:0},uCameraMatrix:{cacheData:null,data:null},uCameraPosition:{cacheData:null,data:new Float32Array([0,0,0])},uPMatrix:{cacheData:null,data:null},uAmbientLightColor:{cacheData:null,data:new Float32Array([0,0,0,0])},uAmbientIntensity:{cacheData:null,data:1},uDirectionalLightPositionList:{cacheData:null,data:[]},uDirectionalLightColorList:{cacheData:null,data:[]},uDirectionalLightIntensityList:{cacheData:null,data:[]},uDirectionalLightNum:{cacheData:null,data:0},uPointLightPositionList:{cacheData:null,data:[]},uPointLightColorList:{cacheData:null,data:[]},uPointLightIntensityList:{cacheData:null,data:[]},uPointLightRadiusList:{cacheData:null,data:[]},uPointLightNum:{cacheData:null,data:0}},x=new Float32Array(3),b=new Float32Array(16),L=new Float32Array(16),d=new Float32Array(9),f=new Float32Array(12),c=new Float32Array(3),u=new Float32Array(15),l=new Float32Array(20),h=new Float32Array(5),R=new Float32Array(5),g=new Float32Array(3),function(C,O,k,N,X,Y){for(e=C.gl,I=N.scene,B=(B=N.camera)instanceof RedBaseController?B.camera:B,A=N._viewRect,D=O.cacheInfo.cacheSystemUniformInfo,U=null,T={},Y.length=0,S=F!=C._datas.RedProgramList.length,F=0,(G=M.uTime).cacheData!=k&&(T.uTime=G.data=k,G.cacheData=k),s=JSON.stringify(A),((G=M.uResolution).cacheData!=s||S)&&(G.data[0]=A[2],G.data[1]=A[3],T.uResolution=G.data,G.cacheData=s),s=I._fogDensity,((G=M.u_FogDensity).cacheData!=s||S)&&(T.u_FogDensity=G.data=s,G.cacheData=s),s=I._fogR+"_"+I._fogG+"_"+I._fogB+"_1",((G=M.uFogColor).cacheData!=s||S)&&(G.data[0]=I._fogR,G.data[1]=I._fogG,G.data[2]=I._fogB,G.data[3]=1,T.uFogColor=G.data,G.cacheData=s),s=I._fogDistance,((G=M.u_FogDistance).cacheData!=s||S)&&(T.u_FogDistance=G.data=s,G.cacheData=s),s=JSON.stringify(B.matrix),((G=M.uCameraMatrix).cacheData!=s||S)&&(T.uCameraMatrix=G.data=B.matrix,G.cacheData=s),s=B.camera?[B.camera.x,B.camera.y,B.camera.z]:[B.x,B.y,B.z],(G.cacheData!=s.join(",")||S)&&(G=M.uCameraPosition,T.uCameraPosition=G.data=s,G.cacheData=s.join(",")),s=JSON.stringify(B.perspectiveMTX),((G=M.uPMatrix).cacheData!=s||S)&&(T.uPMatrix=G.data=B.perspectiveMTX,G.cacheData=s),(_=I._lightInfo[RedAmbientLight.TYPE])&&(s=JSON.stringify(_._lightColor),((G=M.uAmbientLightColor).cacheData!=s||S)&&(T.uAmbientLightColor=G.data=_._lightColor,G.cacheData=s),s=_._intensity,((G=M.uAmbientIntensity).cacheData!=s||S)&&(T.uAmbientIntensity=G.data=_._intensity,G.cacheData=s)),m=I._lightInfo[RedDirectionalLight.TYPE],E=m.length;E--;)_=m[E],g[0]=_.x,g[1]=_.y,g[2]=_.z,_.debug&&((P=_._debugObject).x=g[0],P.y=g[1],P.z=g[2],P._material._color=_._lightColor,Y.push(P)),vec3.normalize(g,g),d[0+3*E]=g[0],d[1+3*E]=g[1],d[2+3*E]=g[2],f[0+4*E]=_._lightColor[0],f[1+4*E]=_._lightColor[1],f[2+4*E]=_._lightColor[2],f[3+4*E]=_._lightColor[3],c[E]=_._intensity;for(s=JSON.stringify(d),((G=M.uDirectionalLightPositionList).cacheData!=s||S)&&(T.uDirectionalLightPositionList=G.data=d,G.cacheData=s),s=JSON.stringify(f),((G=M.uDirectionalLightColorList).cacheData!=s||S)&&(T.uDirectionalLightColorList=G.data=f,G.cacheData=s),s=JSON.stringify(c),((G=M.uDirectionalLightIntensityList).cacheData!=s||S)&&(T.uDirectionalLightIntensityList=G.data=c,G.cacheData=s),s=m.length,((G=M.uDirectionalLightNum).cacheData!=s||S)&&(T.uDirectionalLightNum=G.data=s,G.cacheData=s),m=I._lightInfo[RedPointLight.TYPE],E=m.length;E--;)_=m[E],g[0]=_.x,g[1]=_.y,g[2]=_.z,_.debug&&((P=_._debugObject).x=g[0],P.y=g[1],P.z=g[2],P.scaleX=P.scaleY=P.scaleZ=_._radius,P._material._color=_._lightColor,Y.push(P)),u[0+3*E]=g[0],u[1+3*E]=g[1],u[2+3*E]=g[2],l[0+4*E]=_._lightColor[0],l[1+4*E]=_._lightColor[1],l[2+4*E]=_._lightColor[2],l[3+4*E]=_._lightColor[3],h[E]=_._intensity,R[E]=_._radius;for(s=JSON.stringify(u),((G=M.uPointLightPositionList).cacheData!=s||S)&&(T.uPointLightPositionList=G.data=u,G.cacheData=s),s=JSON.stringify(l),((G=M.uPointLightColorList).cacheData!=s||S)&&(T.uPointLightColorList=G.data=l,G.cacheData=s),s=JSON.stringify(h),((G=M.uPointLightIntensityList).cacheData!=s||S)&&(T.uPointLightIntensityList=G.data=h,G.cacheData=s),s=JSON.stringify(R),((G=M.uPointLightRadiusList).cacheData!=s||S)&&(T.uPointLightRadiusList=G.data=R,G.cacheData=s),s=m.length,((G=M.uPointLightNum).cacheData!=s||S)&&(T.uPointLightNum=G.data=s,G.cacheData=s),I.shadowManager._directionalShadow&&(b[1]=b[2]=b[3]=b[4]=b[6]=b[7]=b[8]=b[9]=b[11]=b[12]=b[13]=b[14]=0,b[0]=b[5]=b[10]=b[15]=1,v=I.shadowManager._directionalShadow.size,p=I.shadowManager._directionalShadow._light,mat4.ortho(L,-v,v,-v,v,-v,v),x[0]=0,x[1]=0,x[2]=0,p&&(x[0]=-p.x,x[1]=-p.y,x[2]=-p.z,vec3.normalize(x,x),mat4.lookAt(b,x,[0,0,0],[0,1,0]),mat4.multiply(b,L,b))),E=C._datas.RedProgramList.length;E--;)for(y in F++,t=C._datas.RedProgramList[E],e.useProgram(t.webglProgram),X=t._UUID,r=t.systemUniformLocation,i=r.uDirectionalShadowLightMatrix,n=i.location,a=i._UUID,n&&I.shadowManager._directionalShadow&&(p=I.shadowManager._directionalShadow._light)&&(s=JSON.stringify(b),D[a]!=s&&(e.uniformMatrix4fv(n,!1,b),D[a]=s)),(i=r.uDirectionalShadowTexture)&&(n=i.location)&&(a=i._UUID,o=I.shadowManager._directionalShadow?I.shadowManager.directionalShadow.frameBuffer.texture:C._datas.emptyTexture["2d"],(w=i.samplerIndex)!=U&&(e.activeTexture(e.TEXTURE0+w),e.bindTexture(e.TEXTURE_2D,o.webglTexture),e[i.renderMethod](n,w)),U=w),T)i=r[y],(n=i.location)&&(a=i._UUID,o=T[y],"mat"==i.renderType?e[i.renderMethod](n,!1,o):e[i.renderMethod](n,o),D[a]=null);return X})},Object.freeze(RedSystemUniformUpdater)}(),function(){var e;e={},(RedView=function(t,r,i,n){if(e[t]){if(!i&&!n)return e[t];RedGLUtil.throwFunc("RedView : "+t,"는 이미 생성된 RedView key입니다.","입력값 : "+t)}if(r instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용.",r),!(this instanceof RedView))return new RedView(t,r,i,n);"string"==typeof t||RedGLUtil.throwFunc("RedView : key : 문자열만 허용","입력값 : "+t),i||n||RedGLUtil.throwFunc("RedView : 존재하지 않는 key입니다.","입력값 : "+t),!i||i instanceof RedScene||RedGLUtil.throwFunc("RedView : RedScene Instance만 허용","입력값 : "+i),n?!n||n instanceof RedCamera||n instanceof RedBaseController||RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용"):RedGLUtil.throwFunc("RedView : RedCamera or XXController Instance만 허용","입력값 : "+n),this.key=t,this.scene=i,this.postEffectManager=RedPostEffectManager(r),this.camera=n,this._width="100%",this._height="100%",this._x=0,this._y=0,this._viewRect=[0,0,0,0],e[t]=this}).prototype={setSize:function(e,t){void 0==e&&RedGLUtil.throwFunc("RedView setSize : width가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedView setSize : height가 입력되지 않았습니다."),"number"==typeof e?this._width=e<0?0:e:e.indexOf("%")>-1&&+e.replace("%","")>=0?this._width=e:RedGLUtil.throwFunc("RedView setSize : width는 0이상의 숫자나 %만 허용.",e),"number"==typeof t?this._height=t<0?0:t:t.indexOf("%")>-1&&+t.replace("%","")>=0?this._height=t:RedGLUtil.throwFunc("RedView setSize : height는 0이상의 숫자나 %만 허용.",t)},setLocation:function(e,t){void 0==e&&RedGLUtil.throwFunc("RedView setLocation : x가 입력되지 않았습니다."),void 0==t&&RedGLUtil.throwFunc("RedView setLocation : y가 입력되지 않았습니다."),"number"==typeof e?this._x=e<0?0:e:e.indexOf("%")>-1&&+e.replace("%","")>=0?this._x=e:RedGLUtil.throwFunc("RedView setLocation : x는 0이상의 숫자나 %만 허용.",e),"number"==typeof t?this._y=t<0?0:t:t.indexOf("%")>-1&&+t.replace("%","")>=0?this._y=t:RedGLUtil.throwFunc("RedView setLocation : y는 0이상의 숫자나 %만 허용.",t)}},Object.freeze(RedView)}(),function(){var e,t;(RedWorld=function(){if(!(this instanceof RedWorld))return new RedWorld;this._viewList=[],this._viewMap={},this._UUID=RedGL.makeUUID()}).prototype={addView:function(e){e instanceof RedView||RedGLUtil.throwFunc("RedWorld :addView Instance만 허용함.","입력값 : "+e),this._viewMap[e.key]=e,this._viewList.push(e)},getView:function(e){return"string"==typeof e||RedGLUtil.throwFunc("RedWorld :getView 문자열만 허용함.","입력값 : "+e),this._viewMap[e]},delView:function(r){"string"==typeof r||RedGLUtil.throwFunc("RedWorld :delView 문자열만 허용함.","입력값 : "+r),(e=this._viewMap[r])&&(t=this._viewList.indexOf(e),this._viewList.splice(t,1),delete this._viewMap[r])},hasView:function(e){return"string"==typeof e||RedGLUtil.throwFunc("RedWorld :hasView 문자열만 허용함.","입력값 : "+e),!!this._viewMap[e]},getViewList:function(){return this._viewList.concat()}},Object.freeze(RedWorld)}(),function(){RedScene=function(e,t){if(!(this instanceof RedScene))return new RedScene(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedScene : RedGL Instance만 허용.",e),this.backgroundColor=t||"#000000",this.useBackgroundColor=!0,this.useFog=!1,this.fogDensity=.5,this.fogDistance=25,this.fogColor="#ffffff",this.children=[],this.shadowManager=RedShadowManager(e),this._lightInfo={RedAmbientLight:null,RedDirectionalLight:[],RedPointLight:[]},this._UUID=RedGL.makeUUID()};var e,t,r={addLight:function(e){switch(e.TYPE){case RedAmbientLight.TYPE:this._lightInfo[e.TYPE]=e;break;case RedDirectionalLight.TYPE:this._lightInfo[e.TYPE].length==RedSystemShaderCode.MAX_DIRECTIONAL_LIGHT&&RedGLUtil.throwFunc("RedScene : RedDirectionalLight "+RedSystemShaderCode.MAX_DIRECTIONAL_LIGHT+"개 까지 허용."),this._lightInfo[e.TYPE].push(e);break;case RedPointLight.TYPE:this._lightInfo[e.TYPE].length==RedSystemShaderCode.MAX_POINT_LIGHT&&RedGLUtil.throwFunc("RedScene : RedPointLight "+RedSystemShaderCode.MAX_POINT_LIGHT+"개 까지 허용."),this._lightInfo[e.TYPE].push(e);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 인스턴스만 가능")}},removeLight:function(t){switch(t.TYPE){case RedAmbientLight.TYPE:this._lightInfo[t.TYPE]==t&&(this._lightInfo[t.TYPE]=null);break;case RedDirectionalLight.TYPE:case RedPointLight.TYPE:(e=this._lightInfo[t.TYPE].indexOf(t))>-1&&this._lightInfo[t.TYPE].splice(e,1);break;default:RedGLUtil.throwFunc("RedScene : RedBaseLight 인스턴스만 가능")}}};for(var i in RedScene.prototype=new RedBaseContainer,r)RedScene.prototype[i]=r[i];RedDefinePropertyInfo.definePrototype("RedScene","backgroundColor","hex",{callback:function(){t=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._backgroundColor),this._r=t[0],this._g=t[1],this._b=t[2]}}),RedDefinePropertyInfo.definePrototype("RedScene","useBackgroundColor","boolean",!0),RedDefinePropertyInfo.definePrototype("RedScene","useFog","boolean",!0),RedDefinePropertyInfo.definePrototype("RedScene","fogDensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedScene","fogDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedScene","fogColor","hex",{callback:function(){var e;return function(){e=RedGLUtil.hexToRGB_ZeroToOne.call(this,this._fogColor),this._fogR=e[0],this._fogG=e[1],this._fogB=e[2]}}()}),Object.defineProperty(RedScene.prototype,"skyBox",{get:function(){return this._skyBoxMesh},set:function(e){return!e||e instanceof RedSkyBox||RedGLUtil.throwFunc("RedScene : RedSkyBox Instance만 허용."),this._skyBoxMesh=e,this._skyBoxMesh}}),Object.defineProperty(RedScene.prototype,"grid",{get:function(){return this._gridMesh},set:function(e){return!e||e instanceof RedGrid||RedGLUtil.throwFunc("RedScene : RedGrid Instance만 허용."),this._gridMesh=e,this._gridMesh}}),Object.defineProperty(RedScene.prototype,"axis",{get:function(){return this._axisMesh},set:function(e){return!e||e instanceof RedAxis||RedGLUtil.throwFunc("RedScene : RedAxis Instance만 허용."),this._axisMesh=e,this._axisMesh}}),Object.freeze(RedScene)}(),function(){var e,t;(RedCamera=function(){if(!(this instanceof RedCamera))return new RedCamera;this.x=this.y=this.z=0,this.targetX=this.targetY=this.targetZ=0,this.fov=60,this.nearClipping=1,this.farClipping=1e5,this.orthographicYn=!1,this.matrix=mat4.create(),this.perspectiveMTX=mat4.create(),this.autoUpdateMatrix=!0,this._UUID=RedGL.makeUUID()}).prototype.update=function(){this.lookAt(this.targetX,this.targetY,this.targetZ)},RedCamera.prototype.lookAt=(e=new Float32Array([0,1,0]),t=[],function(r,i,n){t[0]=this.targetX=r,t[1]=this.targetY=i,t[2]=this.targetZ=n,mat4.identity(this.matrix),mat4.lookAt(this.matrix,[this.x,this.y,this.z],t,e)}),Object.freeze(RedCamera)}(),(RedBasicController=function(e){if(!(this instanceof RedBasicController))return new RedBasicController(e);this.keyBuffer={},this.keyNameMapper={moveForward:"w",moveBack:"s",moveLeft:"a",moveRight:"d",moveUp:"t",moveDown:"g",turnLeft:"q",turnRight:"e",turnUp:"r",turnDown:"f"},this.speed=1,this.delay=.1,this.speedRotation=1,this.delayRotation=.1,this.maxAcceleration=3,this.camera=RedCamera(),this._desirePosition=[0,0,0],this._desirePan=0,this._desireTilt=0,this._targetObject=RedMesh(e),function(t){var r,i,n,a,o,s,d,f,c;s=0,d=0,f=0,c=0,r=function(e){t.keyBuffer[e.key]=1},i=function(e){t.keyBuffer[e.key]=0},n=function(t){s=t.x,d=t.y,e._canvas.addEventListener("mousemove",a),window.addEventListener("mouseup",o)},a=function(e){f=e.x-s,c=e.y-d,s=e.x,d=e.y,t._desirePan-=f*t._speedRotation*.1,t._desireTilt-=c*t._speedRotation*.1},o=function(){e._canvas.removeEventListener("mousemove",a),window.removeEventListener("mouseup",o)},window.addEventListener("keydown",r),window.addEventListener("keyup",i),e._canvas.addEventListener("mousedown",n)}(this)}).prototype=new RedBaseController,RedDefinePropertyInfo.definePrototype("RedBasicController","speed","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","delay","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","speedRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","delayRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedBasicController","maxAcceleration","number",{min:0}),Object.defineProperty(RedBasicController.prototype,"x",{get:function(){return this._targetObject.x},set:function(e){this._targetObject.x=e,this._desirePosition[0]=e}}),Object.defineProperty(RedBasicController.prototype,"y",{get:function(){return this._targetObject.y},set:function(e){this._targetObject.y=e,this._desirePosition[1]=e}}),Object.defineProperty(RedBasicController.prototype,"z",{get:function(){return this._targetObject.z},set:function(e){this._targetObject.z=e,this._desirePosition[2]=e}}),Object.defineProperty(RedBasicController.prototype,"tilt",{get:function(){return this._desireTilt},set:function(e){this._targetObject.rotationX=e,this._desireTilt=e}}),Object.defineProperty(RedBasicController.prototype,"pan",{get:function(){return this._desirePan},set:function(e){this._targetObject.rotationY=e,this._desirePan=e}}),RedBasicController.prototype.update=function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p,_;return new Float32Array([0,1,0]),u=mat4.create(),f=mat4.create(),c=mat4.create(),l=vec3.create(),R=0,function(){e=0,t=0,i=!1,n=!1,a=this._speed,o=this._speedRotation,s=this._delay,d=this._delayRotation,h=this.camera,_=this._desirePosition,m=this.keyBuffer,p=this.keyNameMapper,l[0]=0,l[1]=0,l[2]=0,m[p.turnLeft]&&(n=!0,e=o),m[p.turnRight]&&(n=!0,e=-o),m[p.turnUp]&&(n=!0,t=o),m[p.turnDown]&&(n=!0,t=-o),m[p.moveForward]&&(i=!0,l[2]=-R*a),m[p.moveBack]&&(i=!0,l[2]=R*a),m[p.moveLeft]&&(i=!0,l[0]=-R*a),m[p.moveRight]&&(i=!0,l[0]=R*a),m[p.moveUp]&&(i=!0,l[1]=R*a),m[p.moveDown]&&(i=!0,l[1]=-R*a),n||i?(R+=.1)>this._maxAcceleration&&(R=this._maxAcceleration):(R+=-.1)<0&&(R=0),r=this._targetObject,n&&(this._desirePan+=e,this._desireTilt+=t),r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,(i||n)&&(f=r.matrix,mat4.identity(u),mat4.rotateY(u,u,r.rotationY*Math.PI/180),mat4.rotateX(u,u,r.rotationX*Math.PI/180),mat4.translate(u,u,l),mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.multiply(f,f,u),_[0]=f[12],_[1]=f[13],_[2]=f[14]),r.x+=(_[0]-r.x)*s,r.y+=(_[1]-r.y)*s,r.z+=(_[2]-r.z)*s,r.rotationY+=(this._desirePan-r.rotationY)*d,r.rotationX+=(this._desireTilt-r.rotationX)*d,f=r.matrix,mat4.identity(f),mat4.translate(f,f,[r.x,r.y,r.z]),mat4.rotateY(f,f,r.rotationY*Math.PI/180),mat4.rotateX(f,f,r.rotationX*Math.PI/180),c=mat4.clone(f),mat4.translate(c,c,[0,0,.01]),h.x=c[12],h.y=c[13],h.z=c[14],h.lookAt(r.x,r.y,r.z)}}(),Object.freeze(RedBasicController),function(){var e,t,r,i;(RedObitController=function(e){if(!(this instanceof RedObitController))return new RedObitController(e);this.centerX=0,this.centerY=0,this.centerZ=0,this.distance=15,this.speedDistance=2,this.delayDistance=.1,this.speedRotation=3,this.delayRotation=.1,this.tilt=0,this.minTilt=-90,this.maxTilt=90,this.pan=0,this.camera=RedCamera(),this._currentPan=0,this._currentTilt=0,this._currentDistance=0,function(t){var r,i,n,a,o,s,d,f;o=0,s=0,d=0,f=0,r=function(t){o=t.x,s=t.y,e._canvas.addEventListener("mousemove",i),window.addEventListener("mouseup",n)},i=function(e){d=e.x-o,f=e.y-s,o=e.x,s=e.y,t._pan-=d*t._speedRotation*.1,t._tilt-=f*t._speedRotation*.1},n=function(){e._canvas.removeEventListener("mousemove",i),window.removeEventListener("mouseup",n)},a=function(e){t.distance+=e.deltaY/100*t._speedDistance},e._canvas.addEventListener("mousedown",r),e._canvas.addEventListener("wheel",a)}(this)}).prototype=new RedBaseController,RedDefinePropertyInfo.definePrototype("RedObitController","centerX","number"),RedDefinePropertyInfo.definePrototype("RedObitController","centerY","number"),RedDefinePropertyInfo.definePrototype("RedObitController","centerZ","number"),RedDefinePropertyInfo.definePrototype("RedObitController","distance","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedObitController","speedDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","delayDistance","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","speedRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","delayRotation","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedObitController","pan","number"),RedDefinePropertyInfo.definePrototype("RedObitController","tilt","number"),RedDefinePropertyInfo.definePrototype("RedObitController","maxTilt","number",{max:90}),RedDefinePropertyInfo.definePrototype("RedObitController","minTilt","number",{max:-90}),RedObitController.prototype.update=(i=Math.PI/180,function(){this._tilt<this._minTilt&&(this._tilt=this._minTilt),this._tilt>this._maxTilt&&(this._tilt=this._maxTilt),e=this._delayRotation,t=this.camera,r=t.matrix,this._currentPan+=(this._pan-this._currentPan)*e,this._currentTilt+=(this._tilt-this._currentTilt)*e,this._currentDistance+=(this._distance-this._currentDistance)*this._delayDistance,mat4.identity(r),mat4.rotateY(r,r,this._currentPan*i),mat4.rotateX(r,r,this._currentTilt*i),mat4.translate(r,r,[0,0,this._currentDistance]),t.x=r[12],t.y=r[13],t.z=r[14],t.lookAt(this._centerX,this._centerY,this._centerZ)}),Object.freeze(RedObitController)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec4 vColor;
void main(void) {
vColor = aVertexColor;
gl_Position = uPMatrix * uCameraMatrix* uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
if(1.0 - fog < 0.0) discard;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
varying vec4 vColor;
void main(void) {
vec4 finalColor = vColor;
finalColor.rgb *= vColor.a;
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedGridMaterial=function(i){if(!(this instanceof RedGridMaterial))return new RedGridMaterial(i);this.makeProgramList(this,i,"RedGridMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.freeze(RedGridMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
varying vec3 vReflectionCubeCoord;
void main(void) {
vReflectionCubeCoord = (uMMatrix *vec4(aVertexPosition, 0.0)).xyz;
gl_Position = uPMatrix * uCameraMatrix * uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform samplerCube u_skyBoxTexture;
varying vec3 vReflectionCubeCoord;
float fogFactor(float perspectiveFar, float density){
float flog_cord = gl_FragCoord.z / gl_FragCoord.w / perspectiveFar;
float fog = flog_cord * density;
return clamp(1.0 - fog, 0.0,  1.0);
}
vec4 fog(float fogFactor, vec4 fogColor, vec4 currentColor) {
return mix(fogColor, currentColor, fogFactor);
}
void main(void) {
vec4 finalColor = textureCube(u_skyBoxTexture, vReflectionCubeCoord);
//#define#fog#false# gl_FragColor = finalColor;
//#define#fog#true# gl_FragColor = fog( fogFactor(u_FogDistance, u_FogDensity), uFogColor, finalColor);
}
*/},(RedSkyBoxMaterial=function(i,n){if(!(this instanceof RedSkyBoxMaterial))return new RedSkyBoxMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedSkyBoxMaterial : RedGL Instance만 허용.",i),this.makeProgramList(this,i,"RedSkyBoxMaterialProgram",e,t),this.skyBoxTexture=n,this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedSkyBoxMaterial","skyBoxTexture","samplerCube",{essential:!0}),Object.freeze(RedSkyBoxMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
//#define#skin#true# mat4 skinMat =
//#define#skin#true# aVertexWeight.x * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.x) ] * uInverseBindMatrixForJoint[int(aVertexJoint.x)]+
//#define#skin#true# aVertexWeight.y * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.y) ] * uInverseBindMatrixForJoint[int(aVertexJoint.y)]+
//#define#skin#true# aVertexWeight.z * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.z) ] * uInverseBindMatrixForJoint[int(aVertexJoint.z)]+
//#define#skin#true# aVertexWeight.w * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.w) ] * uInverseBindMatrixForJoint[int(aVertexJoint.w)];
//#define#skin#true# gl_Position =  uDirectionalShadowLightMatrix *  uMMatrix * skinMat * vec4(aVertexPosition, 1.0);
//#define#skin#false# gl_Position =  uDirectionalShadowLightMatrix *  uMMatrix * vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
vec4 encodeFloat (float depth) {
const vec4 cBitShift = vec4(
256 * 256 * 256,
256 * 256,
256,
1.0
);
const vec4 cBitMask = vec4(
0,
1.0 / 256.0,
1.0 / 256.0,
1.0 / 256.0
);
vec4 comp = fract(depth * cBitShift);
comp -= comp.xxyz * cBitMask;
return comp;
}
void main(void) {
gl_FragColor = encodeFloat(gl_FragCoord.z);
}
*/},(RedDirectionalShadowMaterial=function(i){if(!(this instanceof RedDirectionalShadowMaterial))return new RedDirectionalShadowMaterial(i);i instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadowMaterial : RedGL Instance만 허용.",i),this._RedDirectionalShadowYn=!0,this.makeProgramList(this,i,"RedDirectionalShadowMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,Object.freeze(RedDirectionalShadowMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
gl_FragColor = texture2D(u_diffuseTexture, vTexcoord);
}
*/},(RedPostEffectMaterial=function(i,n){if(!(this instanceof RedPostEffectMaterial))return new RedPostEffectMaterial(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectMaterial : RedGL Instance만 허용.",i),this.diffuseTexture=n,this.program=RedProgram.makeProgram(i,"RedPostEffectMaterialProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBaseMaterial,RedDefinePropertyInfo.definePrototype("RedPostEffectMaterial","diffuseTexture","sampler2D",{essential:!0}),Object.freeze(RedPostEffectMaterial)}(),function(){var e;(RedDirectionalShadow=function(e,t){if(!(this instanceof RedDirectionalShadow))return new RedDirectionalShadow(e,t);e instanceof RedGL||RedGLUtil.throwFunc("RedDirectionalShadow : RedGL Instance만 허용.",e),this._directionalShadowMaterial=RedDirectionalShadowMaterial(e),this.frameBuffer=RedFrameBuffer(e),this.light=t,this.width=2048,this.height=2048,this.size=20,this._UUID=RedGL.makeUUID(),this._castingList=[]}).prototype.addCasting=function(e,t){e instanceof RedBaseObject3D||RedGLUtil.throwFunc("addCasting","RedBaseObject3D Instance만 가능","입력값 : "+e),this._castingList.push(e);var r=this;t&&e.children.forEach(function(e){r.addCasting(e,t)})},RedDirectionalShadow.prototype.removeCasting=function(t,r){-1==(e=this._castingList.indexOf(t))?RedGLUtil.throwFunc("removeCasting","존재하지 않는 대상을 삭제하려고 함"):this._castingList.splice(e,1);var i=this;r&&target.children.forEach(function(e){i.removeCasting(e,r)})},Object.defineProperty(RedDirectionalShadow.prototype,"light",{get:function(){return this._light},set:function(e){e&&e instanceof RedDirectionalLight||RedGLUtil.throwFunc("RedDirectionalShadow - light : RedDirectionalLight Instance만 허용.",e),this._light=e}}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","width","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","height","number",{min:1}),RedDefinePropertyInfo.definePrototype("RedDirectionalShadow","size","number",{min:1}),Object.freeze(RedDirectionalShadow)}(),function(){var e,t,r,i,n,a;(RedShadowManager=function(e){if(!(this instanceof RedShadowManager))return new RedShadowManager(e);e instanceof RedGL||RedGLUtil.throwFunc("RedShadowManager : RedGL Instance만 허용.",e),this._UUID=RedGL.makeUUID()}).prototype={render:function(o,s,d,f,c){(i=this._directionalShadow)&&(e=o.gl,r=s.worldRect,t=d._viewRect,n=i.width,a=i.height,i.frameBuffer.width=n,i.frameBuffer.height=a,i.frameBuffer.bind(o.gl),e.viewport(0,0,n,a),e.scissor(0,0,n,a),s.sceneRender(o,d.scene,d.camera,d.camera.orthographicYn,i._castingList,f,c,i._directionalShadowMaterial),i.frameBuffer.unbind(o.gl),e.viewport(t[0],r[3]-t[3]-t[1],t[2],t[3]),e.scissor(t[0],r[3]-t[3]-t[1],t[2],t[3]))}},Object.defineProperty(RedShadowManager.prototype,"directionalShadow",{get:function(){return this._directionalShadow},set:function(e){!e||e instanceof RedDirectionalShadow||RedGLUtil.throwFunc("RedShadowManager - directionalShadow : RedDirectionalShadow Instance만 허용.",e),this._directionalShadow=e}}),Object.freeze(RedShadowManager)}(),function(){var e,t,r,i;t=function(t,r,i){var n;n=t._svg.querySelector("td").style,t["_"+r]=i,Object.defineProperty(t,r,{get:function(){return t["_"+r]},set:function(i){t["_"+r]=i,n[r]="number"==typeof i?i+="px":i,e(t)}}),t[r]=i},e=function(e){e._height=+e._height,e._svg.setAttribute("width",e._svg.viewBox.baseVal.width=e._width),e._svg.setAttribute("height",e._svg.viewBox.baseVal.height=e._height),e._svg.querySelector("foreignObject").setAttribute("height",e._height),e._svg.querySelector("table").style.height=e._height+"px",e._img.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e._svg.outerHTML)},(RedText=function(e,r,i){if(!(this instanceof RedText))return new RedText(e,r,i);e instanceof RedGL||RedGLUtil.throwFunc("RedText : RedGL Instance만 허용.",e),RedBaseObject3D.build.call(this,e.gl);var n=this;this._cvs=document.createElement("canvas"),this._ctx=this._cvs.getContext("2d"),this._cvs.width=2,this._cvs.height=2,this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._svg.style="position:absolute;top:0px;left:0px;text-align:center;z-index:10",this._svg.innerHTML='<foreignObject  width="100%" style="position:absolute;top:0;left:0">   <table xmlns="http://www.w3.org/1999/xhtml" style="position:table;top:0;left:0;width:100%;table-layout:fixed">       <tr xmlns="http://www.w3.org/1999/xhtml">       <td xmlns="http://www.w3.org/1999/xhtml"  > </td>       </tr>   </table></foreignObject>',this._img=new Image,r=r||256,i=i||256,r>e.detect.texture.MAX_TEXTURE_SIZE&&(r=e.detect.texture.MAX_TEXTURE_SIZE),i>e.detect.texture.MAX_TEXTURE_SIZE&&(i=e.detect.texture.MAX_TEXTURE_SIZE),this.width=r,this.height=i,t(this,"padding",0),t(this,"background",""),t(this,"color","#000"),t(this,"fontFamily","Arial"),t(this,"fontSize",16),t(this,"fontWeight","normal"),t(this,"fontStyle","normal"),t(this,"lineHeight",24),t(this,"letterSpacing",0),t(this,"wordBreak","break-all"),t(this,"verticalAlign","middle"),t(this,"textAlign","center"),this.geometry=RedPlane(e,1,1,0),this.material=RedBitmapMaterial(e,RedBitmapTexture(e,this._cvs)),this.blendSrc=e.gl.ONE,this.blendDst=e.gl.ONE_MINUS_SRC_ALPHA,this.useCullFace=!1,this.perspectiveScale=!1,this.sprite3DYn=!1,this._img.onload=function(){var t,r;t=n._width,r=n._height,n._cvs.width=t,n._cvs.height=r,n._ctx.clearRect(0,0,t,r),n.scaleX=n._width/e.gl.drawingBufferWidth,n.scaleY=n._height/e.gl.drawingBufferWidth,n._ctx.drawImage(n._img,0,0,t,r),n.material.diffuseTexture.src=n._cvs},this._UUID=RedGL.makeUUID()}).prototype=new RedBaseObject3D,RedDefinePropertyInfo.definePrototype("RedText","perspectiveScale","boolean",!0),RedDefinePropertyInfo.definePrototype("RedText","sprite3DYn","boolean",!0),RedDefinePropertyInfo.definePrototype("RedText","width","number",{min:2,callback:function(t){this._width=t,e(this)}}),RedDefinePropertyInfo.definePrototype("RedText","height","number",{min:2,callback:function(t){this._height=t,e(this)}}),Object.defineProperty(RedText.prototype,"text",{get:function(){return this._text},set:function(t){r=this._svg,i=r.querySelector("foreignObject td"),this._text=t.replace(/\<br\>/gi,"<div/>"),i.innerHTML=this._text,e(this)}}),Object.freeze(RedText)}(),function(){var e,t,r,i,n,a,o,s,d,f,c,u,l,h,R,m,p,_,P,g,E,y,M,T,b,v,L,x;(RedPostEffectManager=function(e){if(!(this instanceof RedPostEffectManager))return new RedPostEffectManager(e);e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffectManager : RedGL Instance만 허용.",e),Object.defineProperty(this,"frameBuffer",{value:RedFrameBuffer(e)}),Object.defineProperty(this,"finalMaterial",{value:RedPostEffectMaterial(e,this.frameBuffer.texture)}),Object.defineProperty(this,"postEffectList",{value:[]}),Object.defineProperty(this,"children",{value:[RedMesh(e,RedPlane(e),this.finalMaterial)]}),this._UUID=RedGL.makeUUID()}).prototype={addEffect:function(e){e instanceof RedBasePostEffect||RedGLUtil.throwFunc("RedPostEffectManager : addEffect - RedBasePostEffect Instance만 허용.","입력값 : "+e),this.postEffectList.push(e)},removeEffect:function(e){-1!=(x=this.postEffectList.indexOf(e))&&this.postEffectList.splice(x,1)},removeAllEffect:function(){this.postEffectList.length=0},bind:function(e){this.frameBuffer.bind(e)},unbind:function(e){this.frameBuffer.unbind(e)},render:(p=mat4.create(),m=new Float32Array(2),d=function(t,r,i,n,a){e._material=i,c=e._material.program,t.useProgram(c.webglProgram),l=c.systemUniformLocation,(u=l.uPMatrix)&&(h=u.location,R=u._UUID,h&&(mat4.ortho(p,-.5,.5,-.5,.5,-r.farClipping,r.farClipping),mat4.scale(p,p,[1,-1,1]),_=JSON.stringify(p),f[R]!=_&&(t.uniformMatrix4fv(h,!1,p),f[R]=_))),(u=l.uResolution)&&(h=u.location,R=u._UUID,h&&(m[0]=n,m[1]=a,_=JSON.stringify(m),f[R]!=_&&(t.uniform2fv(h,m),f[R]=_)))},i=function(e,t,r,i){P=r.frameBuffer.width=i[2],g=r.frameBuffer.height=i[3],n==P&&a==g||(e.viewport(0,0,P,g),e.scissor(0,0,P,g)),d(e,t,r,P,g),n=P,a=g},s=function(e,t,d,f,c,u,l){var h,R,m,p,_,P,g,E,y,M;if(m=e.gl,y=f.scene,M=f._viewRect,t._process&&t._process.length)for(h=r,p=0,_=t._process.length;p<_;p++)s(e,t._process[p],d,f,c,u,l);if((R=t._subFrameBufferList)&&R.length)for(P=0,g=R.length;P<g;P++)if((E=R[P]).frameBuffer.width=M[2],E.frameBuffer.height=M[3],E.frameBuffer.bind(m),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),c.sceneRender(e,y,o,o.orthographicYn,y.children,u,l,E.renderMaterial,!0,!0),E.frameBuffer.unbind(m),n=E.frameBuffer.width,a=E.frameBuffer.height,E._process&&E._process.length)for(p=0,_=E._process.length;p<_;p++)s(e,E._process[p],d,y,c,u,l);t.frameBuffer&&(i(m,o,t,M),t.bind(m),t.updateTexture(r,h),c.sceneRender(e,y,o,!0,d,u,l,null,!0,!0),t.unbind(m),r=t.frameBuffer.texture)},y=[],function(i,c,u,l,h,R){for(E=this,n=null,a=null,b=l.scene,o=l.camera instanceof RedBaseController?l.camera.camera:l.camera,v=l._viewRect,L=u.worldRect,f=u.cacheInfo.cacheSystemUniformInfo,E.unbind(c),e=E.children[0],r=t=E.frameBuffer.texture,E.frameBuffer.width=v[2],E.frameBuffer.height=v[3],y.length=0,M=0,T=E.postEffectList.length;M<T;M++)y[M]=E.postEffectList[M];for(E.antialiasing&&y.push(E.antialiasing),M=0,T=y.length;M<T;M++)s(i,y[M],E.children,l,u,h,R);r!=t&&(E.finalMaterial.diffuseTexture=r,c.viewport(v[0],L[3]-v[3]-v[1],v[2],v[3]),c.scissor(v[0],L[3]-v[3]-v[1],v[2],v[3]),d(c,o,E.finalMaterial,v[2],v[3],!0),u.sceneRender(i,b,o,!0,E.children,h,R,null,!0)),E.finalMaterial.diffuseTexture=E.frameBuffer.texture})},Object.defineProperty(RedPostEffectManager.prototype,"antialiasing",{get:function(){return this._antialiasing},set:function(e){e&&(e instanceof RedPostEffect_FXAA||RedGLUtil.throwFunc("RedPostEffectManager : antialiasing - RedPostEffect_FXAA Instance만 허용.","입력값 : "+e)),this._antialiasing=e}}),Object.freeze(RedPostEffectManager)}(),(RedBasePostEffect=function(){}).prototype=new RedBaseMaterial,RedBasePostEffect.prototype.bind=RedPostEffectManager.prototype.bind,RedBasePostEffect.prototype.unbind=RedPostEffectManager.prototype.unbind,RedBasePostEffect.prototype.updateTexture=function(){RedGLUtil.throwFunc("RedBasePostEffect - updateTexture : 반드시 재정의해야함")},RedBasePostEffect.prototype._process=[],RedBasePostEffect.prototype._subFrameBufferList=[],Object.freeze(RedBasePostEffect),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_blurTexture;
uniform float u_exposure;
uniform float u_bloomStrength;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
vec4 thresholdColor = finalColor;
vec4 blurColor = texture2D(u_blurTexture, vTexcoord);
finalColor.rgb = (finalColor.rgb  + blurColor.rgb * u_bloomStrength) * u_exposure;
gl_FragColor = finalColor ;
}
*/},(RedPostEffect_Bloom=function(i){if(!(this instanceof RedPostEffect_Bloom))return new RedPostEffect_Bloom(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Bloom : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.blurTexture=null,this.exposure=1,this.bloomStrength=1.2,this._process=[RedPostEffect_BloomThreshold(i),RedPostEffect_BlurX(i),RedPostEffect_BlurY(i)],this.blur=20,this.threshold=75,this.program=RedProgram.makeProgram(i,"RedPostEffectBloomProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Bloom.prototype.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","blurTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","exposure","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","bloomStrength","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","threshold","number",{min:0,callback:function(e){this._process[0].threshold=e,this._threshold=this._process[0].threshold}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Bloom","blur","number",{min:0,callback:function(e){this._process[1].size=e,this._process[2].size=e}}),Object.freeze(RedPostEffect_Bloom)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D u_diffuseTexture;
uniform float u_threshold_value;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b < u_threshold_value)  finalColor.r = finalColor.g = finalColor.b = 0.0;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BloomThreshold=function(i){if(!(this instanceof RedPostEffect_BloomThreshold))return new RedPostEffect_BloomThreshold(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BloomThreshold : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.threshold=128,this.program=RedProgram.makeProgram(i,"RedPostEffectBloomThresholdProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BloomThreshold.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BloomThreshold","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BloomThreshold","threshold","number",{min:0,max:255,callback:function(e){this._threshold_value=e/255}}),Object.freeze(RedPostEffect_BloomThreshold)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec2 px = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;
finalColor += texture2D(u_diffuseTexture, vTexcoord                             )*0.159576912161;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;
finalColor += texture2D(u_diffuseTexture, vTexcoord + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Blur=function(i){if(!(this instanceof RedPostEffect_Blur))return new RedPostEffect_Blur(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Blur : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.program=RedProgram.makeProgram(i,"RedPostEffectBlurProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Blur.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Blur","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Blur)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(u_size/vResolution.x,0.0);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =  finalColor ;
}
*/},(RedPostEffect_BlurX=function(i){if(!(this instanceof RedPostEffect_BlurX))return new RedPostEffect_BlurX(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurX : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(i,"RedPostEffectBlurXProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BlurX.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurX","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurX","size","number",{min:0}),Object.freeze(RedPostEffect_BlurX)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main() {
vec4 finalColor = vec4(0.0);
vec2 delta;
float total = 0.0;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
delta = vec2(0.0, u_size/vResolution.y);
for (float t = -10.0; t <= 10.0; t++) {
float percent = (t + offset - 0.5) / 10.0;
float weight = 1.0 - abs(percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + delta * percent);
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
finalColor = finalColor / total;
finalColor.rgb /= finalColor.a + 0.00001;
gl_FragColor =   finalColor ;
}
*/},(RedPostEffect_BlurY=function(i){if(!(this instanceof RedPostEffect_BlurY))return new RedPostEffect_BlurY(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BlurY : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.size=50,this.program=RedProgram.makeProgram(i,"RedPostEffectBlurYProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BlurY.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurY","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BlurY","size","number",{min:0}),Object.freeze(RedPostEffect_BlurY)}(),(RedPostEffect_GaussianBlur=function(e){if(!(this instanceof RedPostEffect_GaussianBlur))return new RedPostEffect_GaussianBlur(e);e instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_GaussianBlur : RedGL Instance만 허용.",e),this._UUID=RedGL.makeUUID(),this._process=[RedPostEffect_BlurX(e),RedPostEffect_BlurY(e)],this.radius=1}).prototype=new RedBasePostEffect,RedPostEffect_GaussianBlur.prototype.updateTexture=function(){},RedDefinePropertyInfo.definePrototype("RedPostEffect_GaussianBlur","radius","number",{min:.1,max:255,callback:function(e){this._process[0].size=e,this._process[1].size=e}}),Object.freeze(RedPostEffect_GaussianBlur),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_centerX;
uniform float u_centerY;
uniform float u_amount_value;
float random(vec3 scale, float seed) {
return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}
void main(void) {
vec4 finalColor = vec4(0.0);
vec2 center = vec2(u_centerX+0.5,-u_centerY+0.5);
vec2 toCenter = center - vTexcoord ;
float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
float total = 0.0;
for (float t = 0.0; t <= 30.0; t++) {
float percent = (t + offset) / 30.0;
float weight = 3.0 * (percent - percent * percent);
vec4 sample = texture2D(u_diffuseTexture, vTexcoord + toCenter * percent * u_amount_value );
sample.rgb *= sample.a;
finalColor += sample * weight;
total += weight;
}
gl_FragColor = finalColor / total;
gl_FragColor.rgb /= gl_FragColor.a + 0.00001;
}
*/},(RedPostEffect_ZoomBlur=function(i){if(!(this instanceof RedPostEffect_ZoomBlur))return new RedPostEffect_ZoomBlur(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_ZoomBlur : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.amount=38,this.program=RedProgram.makeProgram(i,"RedPostEffectZoomBlurProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_ZoomBlur.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","centerY","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_ZoomBlur","amount","number",{min:1,max:100,callback:function(e){this._amount_value=e/100}}),Object.freeze(RedPostEffect_ZoomBlur)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_brightness_value;
uniform float u_contrast_value;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
if (u_contrast_value > 0.0) finalColor.rgb = (finalColor.rgb - 0.5) / (1.0 - u_contrast_value) + 0.5;
else finalColor.rgb = (finalColor.rgb - 0.5) * (1.0 + u_contrast_value) + 0.5;
finalColor.rgb += u_brightness_value;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_BrightnessContrast=function(i){if(!(this instanceof RedPostEffect_BrightnessContrast))return new RedPostEffect_BrightnessContrast(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_BrightnessContrast : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.brightness=0,this.contrast=0,this.program=RedProgram.makeProgram(i,"RedPostEffectBrightnessContrastProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_BrightnessContrast.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","brightness","number",{min:-150,max:150,callback:function(e){this._brightness_value=e/255}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_BrightnessContrast","contrast","number",{min:-50,max:100,callback:function(e){this._contrast_value=e/255}}),Object.freeze(RedPostEffect_BrightnessContrast)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision highp float;
uniform sampler2D u_diffuseTexture;
uniform float u_threshold_value;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
float v;
if(0.2126 * finalColor.r + 0.7152 * finalColor.g + 0.0722 * finalColor.b >= u_threshold_value) v = 1.0;
else v = 0.0;
finalColor.r = finalColor.g = finalColor.b = v;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Threshold=function(i){if(!(this instanceof RedPostEffect_Threshold))return new RedPostEffect_Threshold(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Threshold : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.threshold=128,this.program=RedProgram.makeProgram(i,"RedPostEffectThresholdProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Threshold.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Threshold","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Threshold","threshold","number",{min:1,max:255,callback:function(e){this._threshold_value=e/255}}),Object.freeze(RedPostEffect_Threshold)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
finalColor.r = 1.0 - finalColor.r;
finalColor.g = 1.0 - finalColor.g;
finalColor.b = 1.0 - finalColor.b;
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Invert=function(i){if(!(this instanceof RedPostEffect_Invert))return new RedPostEffect_Invert(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Invert : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.program=RedProgram.makeProgram(i,"RedPostEffectInvertProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Invert.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Invert","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Invert)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
highp float gray = (finalColor.r  + finalColor.g + finalColor.b)/3.0;
gl_FragColor = vec4( gray, gray, gray, 1.0);
}
*/},(RedPostEffect_Gray=function(i){if(!(this instanceof RedPostEffect_Gray))return new RedPostEffect_Gray(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Gray : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.program=RedProgram.makeProgram(i,"RedPostEffectGrayProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Gray.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Gray","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_Gray)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_hue_value;
uniform float u_saturation_value;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
float angle = u_hue_value * 3.1415926535897932384626433832795;
float s = sin(angle), c = cos(angle);
vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;
float len = length(finalColor.rgb);
finalColor.rgb = vec3(
dot(finalColor.rgb, weights.xyz),
dot(finalColor.rgb, weights.zxy),
dot(finalColor.rgb, weights.yzx)
);
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
if (u_saturation_value > 0.0) finalColor.rgb += (average - finalColor.rgb) * (1.0 - 1.0 / (1.001 - u_saturation_value));
else finalColor.rgb += (average - finalColor.rgb) * (-u_saturation_value);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_HueSaturation=function(i){if(!(this instanceof RedPostEffect_HueSaturation))return new RedPostEffect_HueSaturation(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HueSaturation : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.hue=0,this.saturation=0,this.program=RedProgram.makeProgram(i,"RedPostEffectHueSaturationProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_HueSaturation.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","hue","number",{min:-180,max:180,callback:function(e){this._hue_value=e/180}}),RedDefinePropertyInfo.definePrototype("RedPostEffect_HueSaturation","saturation","number",{min:-100,max:100,callback:function(e){this._saturation_value=e/100}}),Object.freeze(RedPostEffect_HueSaturation)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_centerX;
uniform float u_centerY;
uniform float u_angle;
uniform float u_radius;
uniform bool u_grayMode;
float pattern(float angle) {
angle = angle * 3.141592653589793/180.0;
float s = sin(angle), c = cos(angle);
vec2 tex = vTexcoord;
tex.x -= u_centerX + 0.5;
tex.y -= u_centerY + 0.5;
vec2 point = vec2(
c * tex.x - s * tex.y,
s * tex.x + c * tex.y
) * vResolution / u_radius;
return (sin(point.x) * sin(point.y)) * 4.0;
}
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
if(u_grayMode) {
float average = (finalColor.r + finalColor.g + finalColor.b) / 3.0;
gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern(u_angle)), finalColor.a);
}else{
vec3 cmy = 1.0 - finalColor.rgb;
float k = min(cmy.x, min(cmy.y, cmy.z));
cmy = (cmy - k) / (1.0 - k);
cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(u_angle + 0.26179), pattern(u_angle + 1.30899), pattern(u_angle)), 0.0, 1.0);
k = clamp(k * 10.0 - 5.0 + pattern(u_angle + 0.78539), 0.0, 1.0);
gl_FragColor = vec4(1.0 - cmy - k, finalColor.a);
}
}
*/},(RedPostEffect_HalfTone=function(i){if(!(this instanceof RedPostEffect_HalfTone))return new RedPostEffect_HalfTone(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_HalfTone : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.centerX=0,this.centerY=0,this.angle=0,this.radius=2,this.grayMode=!1,this.program=RedProgram.makeProgram(i,"RedPostEffectHalfToneProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_HalfTone.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerX","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","centerY","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","angle","number"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","grayMode","boolean"),RedDefinePropertyInfo.definePrototype("RedPostEffect_HalfTone","radius","number",{min:0}),Object.freeze(RedPostEffect_HalfTone)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_width;
uniform float u_height;
void main(void) {
vec4 finalColor;
float dx = 1.0/vResolution.x * u_width;
float dy = 1.0/vResolution.y * u_height;
vec2 coord = vec2(
dx * (floor(vTexcoord.x / dx) + 0.5),
dy * (floor(vTexcoord.y / dy) + 0.5)
);
finalColor = texture2D(u_diffuseTexture, coord);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Pixelize=function(i){if(!(this instanceof RedPostEffect_Pixelize))return new RedPostEffect_Pixelize(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Pixelize : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.width=5,this.height=5,this.program=RedProgram.makeProgram(i,"RedPostEffectPixelizeProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Pixelize.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","width","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Pixelize","height","number",{min:0}),Object.freeze(RedPostEffect_Pixelize)}(),function(){var e,t,r,i,n;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform mat3 u_kernel;
uniform float uKernelWeight;
void main(void) {
vec2 perPX = vec2(1.0/vResolution.x, 1.0/vResolution.y);
vec4 finalColor = vec4(0.0);
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0, -1.0)) * u_kernel[0][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0, -1.0)) * u_kernel[0][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0, -1.0)) * u_kernel[0][2] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0,  0.0)) * u_kernel[1][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0,  0.0)) * u_kernel[1][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0,  0.0)) * u_kernel[1][2] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2(-1.0,  1.0)) * u_kernel[2][0] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 0.0,  1.0)) * u_kernel[2][1] ;
finalColor += texture2D(u_diffuseTexture, vTexcoord + perPX * vec2( 1.0,  1.0)) * u_kernel[2][2] ;
highp float weight;
weight = uKernelWeight;
if (0.01 > weight) {
weight = 1.0;
}
gl_FragColor = vec4((finalColor / uKernelWeight).rgb, 1.0);
}
*/},(RedPostEffect_Convolution=function(i,n){if(!(this instanceof RedPostEffect_Convolution))return new RedPostEffect_Convolution(i,n);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Convolution : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.kernel=n,this.program=RedProgram.makeProgram(i,"RedPostEffectConvolutionProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Convolution.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Convolution","diffuseTexture","sampler2D"),Object.defineProperty(RedPostEffect_Convolution.prototype,"kernel",{get:function(){return this._kernel||(this._kernel=RedPostEffect_Convolution.NORMAL),this._kernel},set:function(e){this._kernel=e}}),Object.defineProperty(RedPostEffect_Convolution.prototype,"kernelWeight",{get:function(){for(n in i=0,this.kernel)i+=this.kernel[n];return i}}),RedPostEffect_Convolution.NORMAL=[0,0,0,0,1,0,0,0,0],RedPostEffect_Convolution.SHARPEN=[0,-1,0,-1,5,-1,0,-1,0],RedPostEffect_Convolution.BLUR=[1,1,1,1,1,1,1,1,1],RedPostEffect_Convolution.EDGE=[0,1,0,1,-4,1,0,1,0],RedPostEffect_Convolution.EMBOSS=[-2,-1,0,-1,1,1,0,1,2],Object.freeze(RedPostEffect_Convolution)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform sampler2D u_blurTexture;
uniform sampler2D u_depthTexture;
void main() {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord);
vec4 blurColor = texture2D(u_blurTexture, vTexcoord);
vec4 depthColor = texture2D(u_depthTexture, vTexcoord);
finalColor.rgb *= (depthColor.r);
blurColor.rgb *= (1.0-depthColor.r);
gl_FragColor =  (finalColor + blurColor) ;
}
*/},(RedPostEffect_DoF=function(i){if(!(this instanceof RedPostEffect_DoF))return new RedPostEffect_DoF(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_DoF : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.blurTexture=null,this.depthTexture=null,this._subFrameBufferList=[{frameBuffer:RedFrameBuffer(i),renderMaterial:RedPostEffect_DoF_DepthMaterial(i),process:[]}],this._process=[RedPostEffect_BlurX(i),RedPostEffect_BlurY(i)],this.focusLength=15,this.blur=10,this.program=RedProgram.makeProgram(i,"RedPostEffectDoFProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_DoF.prototype.updateTexture=function(e,t){this.diffuseTexture=t,this.blurTexture=e,this.depthTexture=this._subFrameBufferList[0].frameBuffer.texture},RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","blurTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","depthTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF","blur","number",{min:0,callback:function(e){this._process[0].size=e,this._process[1].size=e}}),Object.defineProperty(RedPostEffect_DoF.prototype,"focusLength",{get:function(){return this._subFrameBufferList[0].renderMaterial.focusLength},set:function(e){this._subFrameBufferList[0].renderMaterial.focusLength=e}}),Object.freeze(RedPostEffect_DoF)}(),function(){var e,t,r;e=function(){
/* @preserve
mat4 calSprite3D(mat4 cameraMTX, mat4 mvMatrix){
mat4 cacheScale = mat4(
mvMatrix[0][0], 0.0, 0.0, 0.0,
0.0, mvMatrix[1][1], 0.0, 0.0,
0.0, 0.0, 1.0, mvMatrix[2][2],
0.0, 0.0, 0.0, 1.0
);
mat4 tMTX = cameraMTX * mvMatrix;
tMTX[0][0] = 1.0, tMTX[0][1] = 0.0, tMTX[0][2] = 0.0,
tMTX[1][0] = 0.0, tMTX[1][1] = 1.0, tMTX[1][2] = 0.0,
tMTX[2][0] = 0.0, tMTX[2][1] = 0.0, tMTX[2][2] = 1.0;
return tMTX * cacheScale;
}
void main(void) {
gl_PointSize = uPointSize;
vec4 tPosition;
//#define#skin#true# mat4 skinMat =
//#define#skin#true# aVertexWeight.x * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.x) ] * uInverseBindMatrixForJoint[int(aVertexJoint.x)]+
//#define#skin#true# aVertexWeight.y * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.y) ] * uInverseBindMatrixForJoint[int(aVertexJoint.y)]+
//#define#skin#true# aVertexWeight.z * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.z) ] * uInverseBindMatrixForJoint[int(aVertexJoint.z)]+
//#define#skin#true# aVertexWeight.w * uGlobalTransformOfNodeThatTheMeshIsAttachedTo * uJointMatrix[ int(aVertexJoint.w) ] * uInverseBindMatrixForJoint[int(aVertexJoint.w)];
//#define#skin#true# tPosition = uMMatrix * skinMat * vec4(aVertexPosition, 1.0);
//#define#skin#false# tPosition = uMMatrix * vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# gl_Position = uPMatrix * calSprite3D(uCameraMatrix , uMMatrix) *  vec4(aVertexPosition, 1.0);
//#define#sprite3D#true# if(!u_PerspectiveScale){
//#define#sprite3D#true#   gl_Position /= gl_Position.w;
//#define#sprite3D#true#   gl_Position.xy += aVertexPosition.xy * vec2(uMMatrix[0][0],uMMatrix[1][1] * uResolution.x/uResolution.y);
//#define#sprite3D#true# }
//#define#sprite3D#false# gl_Position = uPMatrix * uCameraMatrix * tPosition;
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform float u_focusLength;
void main(void) {
float depth = 1.0 - gl_FragCoord.z / gl_FragCoord.w / u_focusLength;
gl_FragColor = vec4(depth, depth, depth, 1.0);
}
*/},(RedPostEffect_DoF_DepthMaterial=function(i){if(!(this instanceof RedPostEffect_DoF_DepthMaterial))return new RedPostEffect_DoF_DepthMaterial(i);this.focusLength=15,this.makeProgramList(this,i,"RedPostEffectDoFdepthProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedDefinePropertyInfo.definePrototype("RedPostEffect_DoF_DepthMaterial","focusLength","number",{min:0}),Object.freeze(RedPostEffect_DoF_DepthMaterial)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vTime = uTime;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform bool u_grayMode;
uniform sampler2D u_diffuseTexture;
uniform float u_noiseIntensity; // noise effect intensity value (0 = no effect, 1 = full effect)
uniform float u_scanlineIntensity; // scanlines effect intensity value (0 = no effect, 1 = full effect)
uniform float u_scanlineCount; // scanlines effect count value (0 = no effect, 4096 = full effect)
void main() {
// sample the source
vec4 diffuseColor = texture2D( u_diffuseTexture, vTexcoord );
// make some noise
float x = vTexcoord.x * vTexcoord.y * vTime;
x = mod( x, 13.0 ) * mod( x, 123.0 );
float dx = mod( x, 0.01 );
// add noise
vec3 finalColor = diffuseColor.rgb + diffuseColor.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );
// get us a sine and cosine
vec2 sc = vec2( sin( vTexcoord.y * u_scanlineCount ), cos( vTexcoord.y * u_scanlineCount ) );
// add scanlines
finalColor += diffuseColor.rgb * vec3( sc.x, sc.y, sc.x ) * u_scanlineIntensity;
// interpolate between source and result by intensity
finalColor = diffuseColor.rgb + clamp( u_noiseIntensity, 0.0, 1.0 ) * ( finalColor - diffuseColor.rgb );
// convert to grayscale if desired
if( u_grayMode ) finalColor = vec3( finalColor.r * 0.3 + finalColor.g * 0.59 + finalColor.b * 0.11 );
gl_FragColor =  vec4( finalColor, diffuseColor.a );
}
*/},(RedPostEffect_Film=function(i){if(!(this instanceof RedPostEffect_Film))return new RedPostEffect_Film(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Film : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.grayMode=!1,this.scanlineIntensity=.5,this.noiseIntensity=.5,this.scanlineCount=2048,this.program=RedProgram.makeProgram(i,"RedPostEffectFilmProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Film.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","grayMode","boolean"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","noiseIntensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Film","scanlineCount","number",{min:0}),Object.freeze(RedPostEffect_Film)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
uniform float u_size;
uniform float u_intensity;
void main(void) {
vec4 finalColor = texture2D(u_diffuseTexture, vTexcoord );
float dist = distance(vTexcoord, vec2(0.5, 0.5));
finalColor.rgb *= smoothstep(0.8, u_size * 0.799, dist * (u_intensity + u_size));
gl_FragColor = finalColor;
}
*/},(RedPostEffect_Vignetting=function(i){if(!(this instanceof RedPostEffect_Vignetting))return new RedPostEffect_Vignetting(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_Vignetting : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.size=.1,this.intensity=.85,this.program=RedProgram.makeProgram(i,"RedPostEffectVignettingProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_Vignetting.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","diffuseTexture","sampler2D"),RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","intensity","number",{min:0}),RedDefinePropertyInfo.definePrototype("RedPostEffect_Vignetting","size","number",{min:0}),Object.freeze(RedPostEffect_Vignetting)}(),function(){var e,t,r;e=function(){
/* @preserve
void main(void) {
vTexcoord = aTexcoord;
vResolution = uResolution;
gl_Position = uPMatrix * uMMatrix *  vec4(aVertexPosition, 1.0);
}
*/},t=function(){
/* @preserve
precision mediump float;
uniform sampler2D u_diffuseTexture;
const float cFXAA_REDUCE_MIN = 1.0/ 128.0;
const float cFXAA_REDUCE_MUL = 1.0 / 8.0;
const float cFXAA_SPAN_MAX = 8.0;
void main() {
vec4 finalColor;
vec2 inverseVP = vec2(1.0 / vResolution.x, 1.0 / vResolution.y);
vec2 fragCoord = gl_FragCoord.xy;
vec3 rgbNW = texture2D(u_diffuseTexture, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;
vec3 rgbNE = texture2D(u_diffuseTexture, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;
vec3 rgbSW = texture2D(u_diffuseTexture, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;
vec3 rgbSE = texture2D(u_diffuseTexture, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;
vec3 rgbM  = texture2D(u_diffuseTexture, fragCoord  * inverseVP).xyz;
vec3 luma = vec3(0.299, 0.587, 0.114);
float lumaNW = dot(rgbNW, luma);
float lumaNE = dot(rgbNE, luma);
float lumaSW = dot(rgbSW, luma);
float lumaSE = dot(rgbSE, luma);
float lumaM  = dot(rgbM,  luma);
float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));
vec2 dir;
dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));
float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * cFXAA_REDUCE_MUL), cFXAA_REDUCE_MIN);
float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
dir = min(
vec2(cFXAA_SPAN_MAX, cFXAA_SPAN_MAX),
max( vec2(-cFXAA_SPAN_MAX, -cFXAA_SPAN_MAX), dir * rcpDirMin)
) * inverseVP;
vec3 rgbA = 0.5 * (
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz
);
vec3 rgbB = rgbA * 0.5 + 0.25 * (
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * -0.5).xyz +
texture2D(u_diffuseTexture, fragCoord * inverseVP + dir * 0.5).xyz
);
float lumaB = dot(rgbB, luma);
if ((lumaB < lumaMin) || (lumaB > lumaMax)) finalColor = vec4(rgbA, 1.0);
else finalColor = vec4(rgbB, 1.0);
gl_FragColor = finalColor;
}
*/},(RedPostEffect_FXAA=function(i){if(!(this instanceof RedPostEffect_FXAA))return new RedPostEffect_FXAA(i);i instanceof RedGL||RedGLUtil.throwFunc("RedPostEffect_FXAA : RedGL Instance만 허용.",i),this.frameBuffer=RedFrameBuffer(i),this.diffuseTexture=null,this.program=RedProgram.makeProgram(i,"RedPostEffectFXAAProgram",e,t),this._UUID=RedGL.makeUUID(),r||(this.checkUniformAndProperty(),r=!0)}).prototype=new RedBasePostEffect,RedPostEffect_FXAA.prototype.updateTexture=function(e){this.diffuseTexture=e},RedDefinePropertyInfo.definePrototype("RedPostEffect_FXAA","diffuseTexture","sampler2D"),Object.freeze(RedPostEffect_FXAA)}();console.log('RedGL Release. last update(2018-09-11 17:56:35)');